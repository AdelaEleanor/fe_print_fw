<template>
  <div class="demo-page">
    <header class="page-header">
      <h1>ğŸ“š PDF-LIB - ç°ä»£åŒ–PDFæ“ä½œåº“</h1>
      <router-link to="/" class="back-link">â† è¿”å›é¦–é¡µ</router-link>
    </header>

    <div class="content-grid">
      <aside class="info-panel">
        <h2>æŠ€æœ¯è¯¦æƒ…</h2>
        <div class="info-section">
          <h3>ğŸ“¦ ä¾èµ–</h3>
          <p><strong>pdf-lib</strong></p>
          <p>npm install pdf-lib</p>
        </div>

        <div class="info-section">
          <h3>ğŸ’¾ æ–‡ä»¶å¤§å°</h3>
          <p><strong>~200KB</strong> (å‹ç¼©å)</p>
          <p>ç°ä»£åŒ–ã€åŠŸèƒ½å…¨é¢</p>
        </div>

        <div class="info-section">
          <h3>ğŸŒ æµè§ˆå™¨æ”¯æŒ</h3>
          <div class="browser-badges">
            <span class="badge badge-success">Chrome âœ“</span>
            <span class="badge badge-success">Firefox âœ“</span>
            <span class="badge badge-success">Safari âœ“</span>
            <span class="badge badge-success">Edge âœ“</span>
            <span class="badge badge-error">IE11 âœ—</span>
          </div>
        </div>

        <div class="info-section">
          <h3>âš¡ æ€§èƒ½è¡¨ç°</h3>
          <p>åˆå§‹åŒ–: <strong>~50ms</strong></p>
          <p>åˆ›å»ºPDF: <strong>~100ms</strong></p>
          <p>ç¼–è¾‘PDF: <strong>~150ms</strong></p>
        </div>

        <div class="info-section">
          <h3>âœ… ä¼˜ç‚¹</h3>
          <ul>
            <li>ç°ä»£ES6+ API</li>
            <li>æ”¯æŒåˆ›å»ºå’Œç¼–è¾‘</li>
            <li>å¯å¡«å†™PDFè¡¨å•</li>
            <li>æ”¯æŒåµŒå…¥å­—ä½“</li>
            <li>æ— å¤–éƒ¨ä¾èµ–</li>
            <li>TypeScriptæ”¯æŒå¥½</li>
            <li>å¯æ“ä½œç°æœ‰PDF</li>
          </ul>
        </div>

        <div class="info-section">
          <h3>âŒ ç¼ºç‚¹</h3>
          <ul>
            <li>åŒ…ä½“ç§¯è¾ƒå¤§</li>
            <li>å­¦ä¹ æ›²çº¿é™¡å³­</li>
            <li>æ–‡æ¡£ç›¸å¯¹è¾ƒå°‘</li>
            <li>ä¸æ”¯æŒIE11</li>
          </ul>
        </div>

        <div class="info-section">
          <h3>ğŸ¯ é€‚ç”¨åœºæ™¯</h3>
          <ul>
            <li>PDFè¡¨å•å¡«å†™</li>
            <li>PDFåˆå¹¶æ‹†åˆ†</li>
            <li>PDFç¼–è¾‘ä¿®æ”¹</li>
            <li>æ·»åŠ æ°´å°ç­¾å</li>
            <li>æ–‡æ¡£åŠ å¯†ä¿æŠ¤</li>
            <li>å¤æ‚PDFæ“ä½œ</li>
          </ul>
        </div>
      </aside>

      <main class="demo-content">
        <div class="section">
          <h2>1. åˆ›å»ºåŸºç¡€PDF</h2>
          <button @click="createBasicPDF" class="btn btn-primary">ğŸ“„ åˆ›å»ºåŸºç¡€PDFæ–‡æ¡£</button>

          <div class="code-block">
            <h4>å®‰è£…</h4>
            <pre><code>npm install pdf-lib</code></pre>
          </div>

          <div class="code-block">
            <h4>åˆ›å»ºPDF</h4>
            <pre><code>import { PDFDocument, rgb } from 'pdf-lib';

const pdfDoc = await PDFDocument.create();
const page = pdfDoc.addPage([600, 400]);

page.drawText('Hello, PDF-LIB!', {
  x: 50,
  y: 350,
  size: 30,
  color: rgb(0, 0.53, 0.71),
});

const pdfBytes = await pdfDoc.save();
download(pdfBytes, 'basic.pdf');</code></pre>
          </div>
        </div>

        <div class="section">
          <h2>2. ä¿®æ”¹ç°æœ‰PDF</h2>
          <button @click="modifyExistingPDF" class="btn btn-success">âœï¸ ç¼–è¾‘PDFæ–‡æ¡£</button>

          <div class="code-block">
            <h4>åŠ è½½å¹¶ä¿®æ”¹PDF</h4>
            <pre><code>// å…ˆåˆ›å»ºä¸€ä¸ªPDFï¼Œç„¶åä¿®æ”¹å®ƒ
const existingPdfBytes = await createSamplePDF();

// åŠ è½½ç°æœ‰PDF
const pdfDoc = await PDFDocument.load(existingPdfBytes);

// Get first page
const pages = pdfDoc.getPages();
const firstPage = pages[0];

// Add text
firstPage.drawText('EDITED', {
  x: 50,
  y: 50,
  size: 20,
  color: rgb(0.95, 0.1, 0.1),
});

const modifiedPdfBytes = await pdfDoc.save();
download(modifiedPdfBytes, 'modified.pdf');</code></pre>
          </div>
        </div>

        <div class="section">
          <h2>3. åˆå¹¶å¤šä¸ªPDF</h2>
          <button @click="mergePDFs" class="btn btn-info">ğŸ”— åˆå¹¶PDFæ–‡æ¡£</button>

          <div class="code-block">
            <h4>PDFåˆå¹¶</h4>
            <pre><code>import { PDFDocument } from 'pdf-lib';

// åˆ›å»ºæ–°æ–‡æ¡£
const mergedPdf = await PDFDocument.create();

// åŠ è½½æºæ–‡æ¡£
const pdf1 = await PDFDocument.load(pdfBytes1);
const pdf2 = await PDFDocument.load(pdfBytes2);

// å¤åˆ¶é¡µé¢
const copiedPages1 = await mergedPdf.copyPages(pdf1, pdf1.getPageIndices());
const copiedPages2 = await mergedPdf.copyPages(pdf2, pdf2.getPageIndices());

// æ·»åŠ åˆ°æ–°æ–‡æ¡£
copiedPages1.forEach((page) =&gt; mergedPdf.addPage(page));
copiedPages2.forEach((page) =&gt; mergedPdf.addPage(page));

const mergedPdfBytes = await mergedPdf.save();
download(mergedPdfBytes, 'merged.pdf');</code></pre>
          </div>
        </div>

        <div class="section">
          <h2>4. åµŒå…¥å›¾ç‰‡</h2>
          <button @click="embedImages" class="btn btn-warning">ğŸ–¼ï¸ åµŒå…¥å›¾ç‰‡åˆ°PDF</button>

          <div class="code-block">
            <h4>å›¾ç‰‡åµŒå…¥</h4>
            <pre><code>import { PDFDocument } from 'pdf-lib';

const pdfDoc = await PDFDocument.create();
const page = pdfDoc.addPage([600, 800]);

// åµŒå…¥PNGå›¾ç‰‡
const pngImageBytes = await fetch('/image.png').then(res =&gt; res.arrayBuffer());
const pngImage = await pdfDoc.embedPng(pngImageBytes);

// åµŒå…¥JPGå›¾ç‰‡
const jpgImageBytes = await fetch('/photo.jpg').then(res =&gt; res.arrayBuffer());
const jpgImage = await pdfDoc.embedJpg(jpgImageBytes);

// ç»˜åˆ¶å›¾ç‰‡
page.drawImage(pngImage, {
  x: 50,
  y: 500,
  width: 200,
  height: 150,
});

page.drawImage(jpgImage, {
  x: 300,
  y: 500,
  width: 200,
  height: 150,
});</code></pre>
          </div>
        </div>

        <div class="section">
          <h2>5. æ·»åŠ æ°´å°</h2>
          <button @click="addWatermark" class="btn btn-secondary">ğŸ’§ æ·»åŠ æ–‡å­—æ°´å°</button>

          <div class="code-block">
            <h4>æ°´å°åŠŸèƒ½</h4>
            <pre><code>import { PDFDocument, rgb, degrees } from 'pdf-lib';

const pdfDoc = await PDFDocument.load(existingPdfBytes);
const pages = pdfDoc.getPages();

// ç»™æ¯ä¸€é¡µæ·»åŠ æ°´å°
pages.forEach((page) =&gt; {
  const { width, height } = page.getSize();

  page.drawText('æœºå¯†æ–‡ä»¶', {
    x: width / 2 - 100,
    y: height / 2,
    size: 80,
    color: rgb(0.95, 0.1, 0.1),
    opacity: 0.2,
    rotate: degrees(-45),
  });
});

const watermarkedPdf = await pdfDoc.save();
download(watermarkedPdf, 'watermarked.pdf');</code></pre>
          </div>
        </div>

        <div class="section">
          <h2>6. PDFè¡¨å•å¡«å†™</h2>
          <button @click="fillForm" class="btn btn-danger">ğŸ“ å¡«å†™PDFè¡¨å•</button>

          <div class="code-block">
            <h4>è¡¨å•æ“ä½œ</h4>
            <pre><code>import { PDFDocument } from 'pdf-lib';

// åŠ è½½åŒ…å«è¡¨å•çš„PDF
const pdfDoc = await PDFDocument.load(formPdfBytes);
const form = pdfDoc.getForm();

// è·å–è¡¨å•å­—æ®µ
const nameField = form.getTextField('name');
const emailField = form.getTextField('email');
const checkBox = form.getCheckBox('agree');

// å¡«å†™è¡¨å•
nameField.setText('å¼ ä¸‰');
emailField.setText('zhang@example.com');
checkBox.check();

// å¯é€‰ï¼šä½¿è¡¨å•ä¸å¯ç¼–è¾‘
form.flatten();

const filledPdfBytes = await pdfDoc.save();
download(filledPdfBytes, 'filled-form.pdf');</code></pre>
          </div>
        </div>

        <div class="section">
          <h2>7. å¤šé¡µå¤æ‚æ–‡æ¡£</h2>
          <button @click="createComplexDoc" class="btn btn-primary">ğŸ“‹ åˆ›å»ºå¤æ‚æ–‡æ¡£</button>

          <div class="code-block">
            <h4>å¤æ‚å¸ƒå±€</h4>
            <pre><code>import { PDFDocument, StandardFonts, rgb } from 'pdf-lib';

const pdfDoc = await PDFDocument.create();
const timesRomanFont = await pdfDoc.embedFont(StandardFonts.TimesRoman);
const helveticaFont = await pdfDoc.embedFont(StandardFonts.Helvetica);

// ç¬¬ä¸€é¡µ - å°é¢
const coverPage = pdfDoc.addPage([600, 800]);
coverPage.drawText('æŠ€æœ¯æŠ¥å‘Š', {
  x: 200,
  y: 400,
  size: 50,
  font: helveticaFont,
  color: rgb(0, 0.25, 0.5),
});

// ç¬¬äºŒé¡µ - å†…å®¹
const contentPage = pdfDoc.addPage([600, 800]);
contentPage.drawText('ç¬¬ä¸€ç« ï¼šæ¦‚è¿°', {
  x: 50,
  y: 750,
  size: 24,
  font: timesRomanFont,
  color: rgb(0, 0, 0),
});

contentPage.drawText('è¿™æ˜¯æ­£æ–‡å†…å®¹...', {
  x: 50,
  y: 700,
  size: 14,
  font: timesRomanFont,
  color: rgb(0.2, 0.2, 0.2),
  maxWidth: 500,
  lineHeight: 20,
});

const pdfBytes = await pdfDoc.save();
download(pdfBytes, 'complex-doc.pdf');</code></pre>
          </div>
        </div>

        <div class="comparison-section">
          <h2>ğŸ†š ä¸å…¶ä»–åº“å¯¹æ¯”</h2>
          <table class="comparison-table">
            <thead>
              <tr>
                <th>ç‰¹æ€§</th>
                <th>PDF-LIB</th>
                <th>jsPDF</th>
                <th>pdfmake</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>åˆ›å»ºPDF</td>
                <td class="success">âœ“ æ”¯æŒ</td>
                <td class="success">âœ“ æ”¯æŒ</td>
                <td class="success">âœ“ æ”¯æŒ</td>
              </tr>
              <tr>
                <td>ç¼–è¾‘ç°æœ‰PDF</td>
                <td class="success">âœ“ å¼ºå¤§</td>
                <td class="error">âœ— ä¸æ”¯æŒ</td>
                <td class="error">âœ— ä¸æ”¯æŒ</td>
              </tr>
              <tr>
                <td>PDFåˆå¹¶</td>
                <td class="success">âœ“ åŸç”Ÿæ”¯æŒ</td>
                <td class="error">âœ— ä¸æ”¯æŒ</td>
                <td class="error">âœ— ä¸æ”¯æŒ</td>
              </tr>
              <tr>
                <td>è¡¨å•å¡«å†™</td>
                <td class="success">âœ“ å®Œæ•´æ”¯æŒ</td>
                <td class="error">âœ— ä¸æ”¯æŒ</td>
                <td class="error">âœ— ä¸æ”¯æŒ</td>
              </tr>
              <tr>
                <td>APIè®¾è®¡</td>
                <td class="success">âœ“ ç°ä»£åŒ–</td>
                <td class="warning">â–³ ä¼ ç»Ÿ</td>
                <td class="success">âœ“ å£°æ˜å¼</td>
              </tr>
              <tr>
                <td>æ–‡ä»¶å¤§å°</td>
                <td class="warning">â–³ ~200KB</td>
                <td class="success">âœ“ ~150KB</td>
                <td class="error">âœ— ~650KB</td>
              </tr>
              <tr>
                <td>TypeScript</td>
                <td class="success">âœ“ åŸç”Ÿ</td>
                <td class="warning">â–³ ç¤¾åŒº</td>
                <td class="success">âœ“ åŸç”Ÿ</td>
              </tr>
              <tr>
                <td>å­¦ä¹ æ›²çº¿</td>
                <td class="warning">â–³ ä¸­ç­‰</td>
                <td class="warning">â–³ ä¸­ç­‰</td>
                <td class="success">âœ“ ç®€å•</td>
              </tr>
            </tbody>
          </table>
        </div>

        <div class="best-practices">
          <h2>ğŸ’¡ æœ€ä½³å®è·µ</h2>
          <div class="practice-grid">
            <div class="practice-card">
              <h3>ğŸ¯ é€‰æ‹©åˆé€‚åœºæ™¯</h3>
              <p>éœ€è¦ç¼–è¾‘ç°æœ‰PDFæ—¶é¦–é€‰PDF-LIBï¼Œåˆ›å»ºæ–°PDFå¯è€ƒè™‘jsPDFæˆ–pdfmake</p>
            </div>
            <div class="practice-card">
              <h3>âš¡ å¼‚æ­¥å¤„ç†</h3>
              <p>æ‰€æœ‰PDFæ“ä½œéƒ½æ˜¯å¼‚æ­¥çš„ï¼Œä½¿ç”¨async/awaitç¡®ä¿æ“ä½œå®Œæˆ</p>
            </div>
            <div class="practice-card">
              <h3>ğŸ“¦ æŒ‰éœ€åŠ è½½</h3>
              <p>åŒ…ä½“ç§¯è¾ƒå¤§ï¼Œå»ºè®®åŠ¨æ€å¯¼å…¥æˆ–ä»£ç åˆ†å‰²å‡å°‘åˆå§‹åŠ è½½</p>
            </div>
            <div class="practice-card">
              <h3>ğŸ”’ å®‰å…¨æ€§</h3>
              <p>å¤„ç†ç”¨æˆ·ä¸Šä¼ çš„PDFæ—¶æ³¨æ„å®‰å…¨éªŒè¯ï¼Œé¿å…æ¶æ„æ–‡ä»¶</p>
            </div>
          </div>
        </div>

        <div class="features-highlight">
          <h2>ğŸŒŸ ç‹¬ç‰¹ä¼˜åŠ¿</h2>
          <div class="feature-cards">
            <div class="feature-card">
              <div class="feature-icon">ğŸ”§</div>
              <h3>PDFç¼–è¾‘èƒ½åŠ›</h3>
              <p>å”¯ä¸€èƒ½åŸç”Ÿç¼–è¾‘ç°æœ‰PDFçš„çº¯JSåº“ï¼Œæ”¯æŒé¡µé¢æ“ä½œã€å†…å®¹ä¿®æ”¹ã€è¡¨å•å¡«å†™ç­‰</p>
            </div>
            <div class="feature-card">
              <div class="feature-icon">ğŸ”—</div>
              <h3>æ–‡æ¡£åˆå¹¶æ‹†åˆ†</h3>
              <p>è½»æ¾åˆå¹¶å¤šä¸ªPDFæˆ–æå–ç‰¹å®šé¡µé¢ï¼Œé€‚ç”¨äºæ–‡æ¡£ç®¡ç†ç³»ç»Ÿ</p>
            </div>
            <div class="feature-card">
              <div class="feature-icon">ğŸ“</div>
              <h3>è¡¨å•æ“ä½œ</h3>
              <p>æ”¯æŒåˆ›å»ºã€å¡«å†™ã€éªŒè¯PDFè¡¨å•ï¼Œé€‚åˆç”µå­ç­¾åå’Œå®¡æ‰¹æµç¨‹</p>
            </div>
            <div class="feature-card">
              <div class="feature-icon">ğŸ’¾</div>
              <h3>æ— ä¾èµ–è®¾è®¡</h3>
              <p>çº¯JavaScriptå®ç°ï¼Œä¸ä¾èµ–ä»»ä½•å¤–éƒ¨åº“ï¼Œæ›´å®‰å…¨å¯æ§</p>
            </div>
          </div>
        </div>

        <!-- ==================== åŸºç¡€ç¤ºä¾‹åŒºåŸŸ ==================== -->
        <div class="examples-section">
          <h3 class="section-title">ğŸ“˜ åˆ›å»ºä¸ç¼–è¾‘ç¤ºä¾‹</h3>

          <div class="example-tabs">
            <button
              v-for="(example, index) in examples"
              :key="index"
              :class="['tab-button', { active: currentExample === index }]"
              @click="currentExample = index"
            >
              {{ example.name }}
            </button>
          </div>

          <!-- ç¤ºä¾‹1: åˆ›å»ºç©ºç™½PDF -->
          <div v-if="currentExample === 0" class="example-content">
            <h4>1. åˆ›å»ºç©ºç™½PDF</h4>
            <p>ä½¿ç”¨PDFDocument.create()åˆ›å»ºç©ºç™½æ–‡æ¡£å¹¶æ·»åŠ é¡µé¢ã€‚</p>
            <div class="demo-box">
              <div class="config-controls">
                <label>
                  é¡µé¢å®½åº¦:
                  <input type="number" v-model="pageWidth" min="200" max="1000" />
                </label>
                <label>
                  é¡µé¢é«˜åº¦:
                  <input type="number" v-model="pageHeight" min="200" max="1200" />
                </label>
                <label>
                  é¡µæ•°:
                  <input type="number" v-model="pageCount" min="1" max="10" />
                </label>
              </div>
              <div class="preview-box">
                <div class="page-preview" :style="pagePreviewStyle">
                  <span>{{ pageWidth }} Ã— {{ pageHeight }}</span>
                </div>
                <p>å°†åˆ›å»º {{ pageCount }} é¡µç©ºç™½PDF</p>
              </div>
              <button @click="example1Generate" class="btn btn-primary">åˆ›å»ºç©ºç™½PDF</button>
            </div>
            <div class="code-display">
              <pre v-pre><code>import { PDFDocument } from 'pdf-lib';

const pdfDoc = await PDFDocument.create();

// æ·»åŠ é¡µé¢ï¼Œå‚æ•°ä¸º [å®½åº¦, é«˜åº¦]
const page = pdfDoc.addPage([600, 800]);

const pdfBytes = await pdfDoc.save();
download(pdfBytes, 'blank.pdf');</code></pre>
            </div>
          </div>

          <!-- ç¤ºä¾‹2: æ·»åŠ æ–‡æœ¬ -->
          <div v-if="currentExample === 1" class="example-content">
            <h4>2. æ·»åŠ æ–‡æœ¬</h4>
            <p>ä½¿ç”¨drawTextæ–¹æ³•åœ¨PDFä¸­ç»˜åˆ¶æ–‡æœ¬ã€‚</p>
            <div class="demo-box">
              <div class="config-controls">
                <label>
                  æ–‡æœ¬å†…å®¹:
                  <input type="text" v-model="textContent" placeholder="Hello PDF-LIB" />
                </label>
                <label>
                  å­—ä½“å¤§å°:
                  <input type="number" v-model="textSize" min="8" max="72" />
                </label>
                <label>
                  æ–‡æœ¬é¢œè‰²:
                  <input type="color" v-model="textColor" />
                </label>
              </div>
              <div
                class="preview-box text-preview"
                :style="{ color: textColor, fontSize: textSize + 'px' }"
              >
                {{ textContent || 'Hello PDF-LIB' }}
              </div>
              <button @click="example2Generate" class="btn btn-primary">ç”Ÿæˆæ–‡æœ¬PDF</button>
            </div>
            <div class="code-display">
              <pre v-pre><code>import { PDFDocument, rgb } from 'pdf-lib';

const pdfDoc = await PDFDocument.create();
const page = pdfDoc.addPage([600, 400]);

page.drawText('Hello PDF-LIB', {
  x: 50,
  y: 350,
  size: 30,
  color: rgb(0, 0.53, 0.71), // RGBå€¼èŒƒå›´0-1
});

const pdfBytes = await pdfDoc.save();</code></pre>
            </div>
          </div>

          <!-- ç¤ºä¾‹3: ç»˜åˆ¶å›¾å½¢ -->
          <div v-if="currentExample === 2" class="example-content">
            <h4>3. ç»˜åˆ¶å›¾å½¢</h4>
            <p>ç»˜åˆ¶çŸ©å½¢ã€åœ†å½¢ã€çº¿æ¡ç­‰åŸºæœ¬å›¾å½¢ã€‚</p>
            <div class="demo-box">
              <div class="config-controls">
                <label>
                  å›¾å½¢ç±»å‹:
                  <select v-model="shapeType">
                    <option value="rectangle">çŸ©å½¢</option>
                    <option value="circle">åœ†å½¢</option>
                    <option value="line">çº¿æ¡</option>
                  </select>
                </label>
                <label>
                  è¾¹æ¡†é¢œè‰²:
                  <input type="color" v-model="borderColor" />
                </label>
                <label>
                  å¡«å……é¢œè‰²:
                  <input type="color" v-model="fillColor" />
                </label>
              </div>
              <div class="preview-box shape-preview">
                <svg width="200" height="150" viewBox="0 0 200 150">
                  <rect
                    v-if="shapeType === 'rectangle'"
                    x="30"
                    y="25"
                    width="140"
                    height="100"
                    :stroke="borderColor"
                    :fill="fillColor"
                    stroke-width="2"
                  />
                  <circle
                    v-if="shapeType === 'circle'"
                    cx="100"
                    cy="75"
                    r="50"
                    :stroke="borderColor"
                    :fill="fillColor"
                    stroke-width="2"
                  />
                  <line
                    v-if="shapeType === 'line'"
                    x1="30"
                    y1="25"
                    x2="170"
                    y2="125"
                    :stroke="borderColor"
                    stroke-width="3"
                  />
                </svg>
              </div>
              <button @click="example3Generate" class="btn btn-primary">ç”Ÿæˆå›¾å½¢PDF</button>
            </div>
            <div class="code-display">
              <pre v-pre><code>import { PDFDocument, rgb } from 'pdf-lib';

const page = pdfDoc.addPage();

// ç»˜åˆ¶çŸ©å½¢
page.drawRectangle({
  x: 50, y: 500,
  width: 200, height: 100,
  borderColor: rgb(0, 0, 0),
  color: rgb(0.9, 0.9, 0.9),
  borderWidth: 2,
});

// ç»˜åˆ¶åœ†å½¢
page.drawCircle({
  x: 400, y: 550,
  size: 50,
  borderColor: rgb(0, 0.5, 0),
  borderWidth: 2,
});

// ç»˜åˆ¶çº¿æ¡
page.drawLine({
  start: { x: 50, y: 300 },
  end: { x: 550, y: 300 },
  thickness: 2,
  color: rgb(0, 0, 1),
});</code></pre>
            </div>
          </div>

          <!-- ç¤ºä¾‹4: ä½¿ç”¨æ ‡å‡†å­—ä½“ -->
          <div v-if="currentExample === 3" class="example-content">
            <h4>4. ä½¿ç”¨æ ‡å‡†å­—ä½“</h4>
            <p>PDF-LIBæ”¯æŒ14ç§PDFæ ‡å‡†å­—ä½“ï¼Œæ— éœ€é¢å¤–åµŒå…¥ã€‚</p>
            <div class="demo-box">
              <div class="config-controls">
                <label>
                  é€‰æ‹©å­—ä½“:
                  <select v-model="selectedFont">
                    <option v-for="font in standardFonts" :key="font" :value="font">
                      {{ font }}
                    </option>
                  </select>
                </label>
              </div>
              <div class="preview-box">
                <div class="font-list">
                  <div
                    v-for="font in standardFonts"
                    :key="font"
                    :class="['font-item', { active: selectedFont === font }]"
                  >
                    {{ font }}
                  </div>
                </div>
              </div>
              <button @click="example4Generate" class="btn btn-primary">ç”Ÿæˆå­—ä½“ç¤ºä¾‹PDF</button>
            </div>
            <div class="code-display">
              <pre v-pre><code>import { PDFDocument, StandardFonts } from 'pdf-lib';

const pdfDoc = await PDFDocument.create();

// åµŒå…¥æ ‡å‡†å­—ä½“
const helvetica = await pdfDoc.embedFont(StandardFonts.Helvetica);
const helveticaBold = await pdfDoc.embedFont(StandardFonts.HelveticaBold);
const timesRoman = await pdfDoc.embedFont(StandardFonts.TimesRoman);
const courier = await pdfDoc.embedFont(StandardFonts.Courier);

const page = pdfDoc.addPage();
page.drawText('Helvetica Font', {
  x: 50, y: 700,
  font: helvetica,
  size: 20,
});</code></pre>
            </div>
          </div>

          <!-- ç¤ºä¾‹5: é¡µé¢æ—‹è½¬ -->
          <div v-if="currentExample === 4" class="example-content">
            <h4>5. é¡µé¢æ—‹è½¬ä¸å°ºå¯¸</h4>
            <p>è·å–å’Œè®¾ç½®é¡µé¢æ—‹è½¬è§’åº¦å’Œå°ºå¯¸ã€‚</p>
            <div class="demo-box">
              <div class="config-controls">
                <label>
                  æ—‹è½¬è§’åº¦:
                  <select v-model="rotationAngle">
                    <option :value="0">0Â°</option>
                    <option :value="90">90Â°</option>
                    <option :value="180">180Â°</option>
                    <option :value="270">270Â°</option>
                  </select>
                </label>
              </div>
              <div class="preview-box">
                <div class="rotation-preview" :style="{ transform: `rotate(${rotationAngle}deg)` }">
                  <div class="page-indicator">
                    <span>â†‘ é¡¶éƒ¨</span>
                  </div>
                </div>
              </div>
              <button @click="example5Generate" class="btn btn-primary">ç”Ÿæˆæ—‹è½¬é¡µé¢PDF</button>
            </div>
            <div class="code-display">
              <pre v-pre><code>import { PDFDocument, degrees } from 'pdf-lib';

const pdfDoc = await PDFDocument.create();
const page = pdfDoc.addPage([600, 800]);

// è®¾ç½®é¡µé¢æ—‹è½¬
page.setRotation(degrees(90));

// è·å–é¡µé¢å°ºå¯¸
const { width, height } = page.getSize();
console.log(`Page size: ${width} x ${height}`);

// è®¾ç½®æ–°å°ºå¯¸
page.setSize(800, 600);</code></pre>
            </div>
          </div>

          <!-- ç¤ºä¾‹6: å…ƒæ•°æ®è®¾ç½® -->
          <div v-if="currentExample === 5" class="example-content">
            <h4>6. æ–‡æ¡£å…ƒæ•°æ®</h4>
            <p>è®¾ç½®PDFçš„æ ‡é¢˜ã€ä½œè€…ã€ä¸»é¢˜ç­‰å…ƒæ•°æ®ä¿¡æ¯ã€‚</p>
            <div class="demo-box">
              <div class="config-controls metadata-form">
                <label>
                  æ ‡é¢˜:
                  <input type="text" v-model="docTitle" placeholder="æ–‡æ¡£æ ‡é¢˜" />
                </label>
                <label>
                  ä½œè€…:
                  <input type="text" v-model="docAuthor" placeholder="ä½œè€…å" />
                </label>
                <label>
                  ä¸»é¢˜:
                  <input type="text" v-model="docSubject" placeholder="æ–‡æ¡£ä¸»é¢˜" />
                </label>
                <label>
                  å…³é”®è¯:
                  <input type="text" v-model="docKeywords" placeholder="å…³é”®è¯1, å…³é”®è¯2" />
                </label>
              </div>
              <div class="preview-box metadata-preview">
                <h5>æ–‡æ¡£å±æ€§é¢„è§ˆ</h5>
                <p><strong>æ ‡é¢˜:</strong> {{ docTitle || '(æœªè®¾ç½®)' }}</p>
                <p><strong>ä½œè€…:</strong> {{ docAuthor || '(æœªè®¾ç½®)' }}</p>
                <p><strong>ä¸»é¢˜:</strong> {{ docSubject || '(æœªè®¾ç½®)' }}</p>
                <p><strong>å…³é”®è¯:</strong> {{ docKeywords || '(æœªè®¾ç½®)' }}</p>
              </div>
              <button @click="example6Generate" class="btn btn-primary">ç”Ÿæˆå¸¦å…ƒæ•°æ®PDF</button>
            </div>
            <div class="code-display">
              <pre v-pre><code>const pdfDoc = await PDFDocument.create();

// è®¾ç½®å…ƒæ•°æ®
pdfDoc.setTitle('My Document Title');
pdfDoc.setAuthor('Author Name');
pdfDoc.setSubject('Document Subject');
pdfDoc.setKeywords(['pdf', 'lib', 'example']);
pdfDoc.setProducer('PDF-LIB Demo');
pdfDoc.setCreator('Vue.js Application');
pdfDoc.setCreationDate(new Date());
pdfDoc.setModificationDate(new Date());</code></pre>
            </div>
          </div>

          <!-- ç¤ºä¾‹7: EChartså›¾è¡¨ -->
          <div v-if="currentExample === 6" class="example-content">
            <h4>7. EChartså›¾è¡¨åµŒå…¥PDF</h4>
            <p class="framework-highlight">
              ğŸ“ <strong>PDF-LIBç‰¹ç‚¹ï¼š</strong>å”¯ä¸€å¯ç¼–è¾‘ç°æœ‰PDFçš„åº“ï¼Œæ”¯æŒæ’å…¥ã€åˆ é™¤ã€é‡æ’é¡µé¢<br />
              <span class="advantage">âœ… ä¼˜åŠ¿ï¼š</span
              >å¯åœ¨ç°æœ‰PDFæ’å…¥å›¾è¡¨ï¼›æ”¯æŒåˆå¹¶/æ‹†åˆ†PDFï¼›å¯ä¿®æ”¹å·²æœ‰æ–‡æ¡£<br />
              <span class="disadvantage">âŒ åŠ£åŠ¿ï¼š</span
              >ä½“ç§¯è¾ƒå¤§(200KB)ï¼›APIå¤æ‚åº¦é«˜ï¼›éœ€æ‰‹åŠ¨åæ ‡å®šä½ï¼›ä¸­æ–‡éœ€é¢å¤–å­—ä½“<br />
              <span class="comparison">ğŸ”„ å¯¹æ¯”jsPDFï¼š</span
              >jsPDFæ›´è½»é‡(120KB)ï¼ŒAPIæ›´ç®€å•ï¼Œé€‚åˆç”Ÿæˆæ–°PDF<br />
              <span class="comparison">ğŸ”„ å¯¹æ¯”pdfmakeï¼š</span
              >pdfmakeå£°æ˜å¼å¸ƒå±€æ›´ç®€å•ï¼Œè‡ªåŠ¨æ’ç‰ˆï¼Œé€‚åˆæŠ¥è¡¨ç”Ÿæˆ
            </p>

            <div class="demo-box">
              <div class="preview-box" style="padding: 20px; background: #fff">
                <div ref="pdflibChartRef" style="width: 100%; height: 300px"></div>
              </div>
              <button @click="example7Generate" class="btn btn-primary">å¯¼å‡ºå›¾è¡¨åˆ°PDF</button>
            </div>

            <div class="code-display">
              <pre v-pre><code>// 1. å°†EChartså¯¼å‡ºä¸ºå›¾ç‰‡
const chart = echarts.init(chartRef.value)
const imageDataUrl = chart.getDataURL({
  type: 'png',
  pixelRatio: 2,
  backgroundColor: '#fff'
})

// 2. åŠ è½½å›¾ç‰‡åˆ°PDF-LIB
const pdfDoc = await PDFDocument.create()
const page = pdfDoc.addPage([600, 400])
const pngImage = await pdfDoc.embedPng(imageDataUrl)

// 3. åœ¨PDFä¸­æ’å…¥å›¾ç‰‡
const { width, height } = pngImage.scale(0.5)
page.drawImage(pngImage, {
  x: 50,
  y: 50,
  width,
  height
})

// 4. ä¿å­˜PDF
const pdfBytes = await pdfDoc.save()
download(pdfBytes, 'chart.pdf', 'application/pdf')</code></pre>
            </div>
          </div>
        </div>

        <!-- ==================== é«˜çº§ç¤ºä¾‹åŒºåŸŸ ==================== -->
        <div class="advanced-section">
          <h3 class="section-title">ğŸ“• åˆå¹¶/è¡¨å•/æ°´å°ç¤ºä¾‹</h3>

          <div class="example-tabs">
            <button
              v-for="(example, index) in advancedExamples"
              :key="index"
              :class="['tab-button advanced', { active: currentAdvanced === index }]"
              @click="currentAdvanced = index"
            >
              {{ example.name }}
            </button>
          </div>

          <!-- é«˜çº§ç¤ºä¾‹1: PDFåˆå¹¶ -->
          <div v-if="currentAdvanced === 0" class="example-content">
            <h4>1. PDFåˆå¹¶</h4>
            <p>å°†å¤šä¸ªPDFæ–‡æ¡£åˆå¹¶ä¸ºä¸€ä¸ªã€‚</p>
            <div class="demo-box">
              <div class="merge-preview">
                <div class="pdf-thumb">PDF 1</div>
                <div class="merge-arrow">+</div>
                <div class="pdf-thumb">PDF 2</div>
                <div class="merge-arrow">+</div>
                <div class="pdf-thumb">PDF 3</div>
                <div class="merge-arrow">=</div>
                <div class="pdf-thumb merged">åˆå¹¶PDF</div>
              </div>
              <button @click="advanced1Generate" class="btn btn-advanced">æ‰§è¡Œåˆå¹¶</button>
            </div>
            <div class="code-display">
              <pre v-pre><code>import { PDFDocument } from 'pdf-lib';

const mergedPdf = await PDFDocument.create();

// åŠ è½½æºPDF
const pdf1 = await PDFDocument.load(pdf1Bytes);
const pdf2 = await PDFDocument.load(pdf2Bytes);

// å¤åˆ¶é¡µé¢åˆ°æ–°æ–‡æ¡£
const pages1 = await mergedPdf.copyPages(pdf1, pdf1.getPageIndices());
const pages2 = await mergedPdf.copyPages(pdf2, pdf2.getPageIndices());

// æ·»åŠ é¡µé¢
pages1.forEach(page =&gt; mergedPdf.addPage(page));
pages2.forEach(page =&gt; mergedPdf.addPage(page));

const mergedBytes = await mergedPdf.save();</code></pre>
            </div>
          </div>

          <!-- é«˜çº§ç¤ºä¾‹2: PDFæ‹†åˆ† -->
          <div v-if="currentAdvanced === 1" class="example-content">
            <h4>2. PDFæ‹†åˆ†</h4>
            <p>ä»PDFä¸­æå–æŒ‡å®šé¡µé¢ã€‚</p>
            <div class="demo-box">
              <div class="config-controls">
                <label>
                  èµ·å§‹é¡µ:
                  <input type="number" v-model="splitStart" min="1" max="5" />
                </label>
                <label>
                  ç»“æŸé¡µ:
                  <input type="number" v-model="splitEnd" min="1" max="5" />
                </label>
              </div>
              <div class="preview-box">
                <div class="page-range-preview">
                  <div
                    v-for="i in 5"
                    :key="i"
                    :class="['page-box', { selected: i >= splitStart && i <= splitEnd }]"
                  >
                    {{ i }}
                  </div>
                </div>
                <p>å°†æå–ç¬¬ {{ splitStart }} - {{ splitEnd }} é¡µ</p>
              </div>
              <button @click="advanced2Generate" class="btn btn-advanced">æ‹†åˆ†PDF</button>
            </div>
            <div class="code-display">
              <pre v-pre><code>// ä»æºPDFæå–æŒ‡å®šé¡µé¢
const sourcePdf = await PDFDocument.load(sourceBytes);
const newPdf = await PDFDocument.create();

// è·å–è¦æå–çš„é¡µé¢ç´¢å¼• (0-based)
const pageIndices = [0, 1, 2]; // æå–ç¬¬1-3é¡µ

// å¤åˆ¶æŒ‡å®šé¡µé¢
const copiedPages = await newPdf.copyPages(sourcePdf, pageIndices);

// æ·»åŠ åˆ°æ–°æ–‡æ¡£
copiedPages.forEach(page =&gt; newPdf.addPage(page));

const splitBytes = await newPdf.save();</code></pre>
            </div>
          </div>

          <!-- é«˜çº§ç¤ºä¾‹3: è¡¨å•åˆ›å»º -->
          <div v-if="currentAdvanced === 2" class="example-content">
            <h4>3. åˆ›å»ºè¡¨å•</h4>
            <p>åˆ›å»ºå¯å¡«å†™çš„PDFè¡¨å•å­—æ®µã€‚</p>
            <div class="demo-box">
              <div class="form-preview">
                <div class="form-field">
                  <label>å§“å:</label>
                  <input type="text" v-model="formName" placeholder="è¾“å…¥å§“å" />
                </div>
                <div class="form-field">
                  <label>é‚®ç®±:</label>
                  <input type="email" v-model="formEmail" placeholder="è¾“å…¥é‚®ç®±" />
                </div>
                <div class="form-field checkbox-field">
                  <input type="checkbox" v-model="formAgree" />
                  <label>åŒæ„æ¡æ¬¾</label>
                </div>
              </div>
              <button @click="advanced3Generate" class="btn btn-advanced">ç”Ÿæˆè¡¨å•PDF</button>
            </div>
            <div class="code-display">
              <pre v-pre><code>const pdfDoc = await PDFDocument.create();
const page = pdfDoc.addPage();
const form = pdfDoc.getForm();

// åˆ›å»ºæ–‡æœ¬å­—æ®µ
const nameField = form.createTextField('name');
nameField.setText('é»˜è®¤å€¼');
nameField.addToPage(page, { x: 100, y: 700, width: 200, height: 25 });

// åˆ›å»ºå¤é€‰æ¡†
const checkbox = form.createCheckBox('agree');
checkbox.addToPage(page, { x: 100, y: 650, width: 20, height: 20 });

// åˆ›å»ºä¸‹æ‹‰æ¡†
const dropdown = form.createDropdown('options');
dropdown.addOptions(['é€‰é¡¹1', 'é€‰é¡¹2', 'é€‰é¡¹3']);
dropdown.addToPage(page, { x: 100, y: 600, width: 150, height: 25 });</code></pre>
            </div>
          </div>

          <!-- é«˜çº§ç¤ºä¾‹4: æ·»åŠ æ°´å° -->
          <div v-if="currentAdvanced === 3" class="example-content">
            <h4>4. æ·»åŠ æ°´å°</h4>
            <p>åœ¨æ¯é¡µæ·»åŠ åŠé€æ˜æ–‡å­—æ°´å°ã€‚</p>
            <div class="demo-box">
              <div class="config-controls">
                <label>
                  æ°´å°æ–‡å­—:
                  <input type="text" v-model="watermarkText" placeholder="CONFIDENTIAL" />
                </label>
                <label>
                  é€æ˜åº¦:
                  <input type="number" v-model="watermarkOpacity" min="0.1" max="0.5" step="0.1" />
                </label>
                <label>
                  æ—‹è½¬è§’åº¦:
                  <input type="number" v-model="watermarkAngle" min="-90" max="0" />
                </label>
              </div>
              <div class="preview-box watermark-preview">
                <div
                  class="watermark-text"
                  :style="{ opacity: watermarkOpacity, transform: `rotate(${watermarkAngle}deg)` }"
                >
                  {{ watermarkText || 'CONFIDENTIAL' }}
                </div>
              </div>
              <button @click="advanced4Generate" class="btn btn-advanced">ç”Ÿæˆå¸¦æ°´å°PDF</button>
            </div>
            <div class="code-display">
              <pre v-pre><code>import { degrees } from 'pdf-lib';

const pages = pdfDoc.getPages();

pages.forEach(page =&gt; {
  const { width, height } = page.getSize();

  page.drawText('CONFIDENTIAL', {
    x: width / 2 - 100,
    y: height / 2,
    size: 60,
    color: rgb(0.9, 0.1, 0.1),
    opacity: 0.2,
    rotate: degrees(-45),
  });
});</code></pre>
            </div>
          </div>

          <!-- é«˜çº§ç¤ºä¾‹5: åµŒå…¥å›¾ç‰‡ -->
          <div v-if="currentAdvanced === 4" class="example-content">
            <h4>5. åµŒå…¥å›¾ç‰‡</h4>
            <p>åœ¨PDFä¸­åµŒå…¥PNGæˆ–JPGå›¾ç‰‡ã€‚</p>
            <div class="demo-box">
              <div class="config-controls">
                <label>
                  å›¾ç‰‡å®½åº¦:
                  <input type="number" v-model="imageWidth" min="50" max="500" />
                </label>
                <label>
                  å›¾ç‰‡é«˜åº¦:
                  <input type="number" v-model="imageHeight" min="50" max="500" />
                </label>
                <label>
                  é€æ˜åº¦:
                  <input type="number" v-model="imageOpacity" min="0.1" max="1" step="0.1" />
                </label>
              </div>
              <div class="preview-box">
                <div
                  class="image-placeholder"
                  :style="{
                    width: imageWidth + 'px',
                    height: imageHeight + 'px',
                    opacity: imageOpacity,
                  }"
                >
                  ç¤ºä¾‹å›¾ç‰‡
                </div>
              </div>
              <button @click="advanced5Generate" class="btn btn-advanced">ç”Ÿæˆå›¾ç‰‡PDF</button>
            </div>
            <div class="code-display">
              <pre v-pre><code>// åµŒå…¥PNG
const pngBytes = await fetch('image.png').then(r =&gt; r.arrayBuffer());
const pngImage = await pdfDoc.embedPng(pngBytes);

// åµŒå…¥JPG
const jpgBytes = await fetch('photo.jpg').then(r =&gt; r.arrayBuffer());
const jpgImage = await pdfDoc.embedJpg(jpgBytes);

// ç»˜åˆ¶å›¾ç‰‡
page.drawImage(pngImage, {
  x: 50,
  y: 500,
  width: 200,
  height: 150,
  opacity: 0.8,
});</code></pre>
            </div>
          </div>

          <!-- é«˜çº§ç¤ºä¾‹6: å¤åˆ¶é¡µé¢ -->
          <div v-if="currentAdvanced === 5" class="example-content">
            <h4>6. å¤åˆ¶ä¸æ’å…¥é¡µé¢</h4>
            <p>å¤åˆ¶é¡µé¢å¹¶æ’å…¥åˆ°æŒ‡å®šä½ç½®ã€‚</p>
            <div class="demo-box">
              <div class="config-controls">
                <label>
                  å¤åˆ¶æ¬¡æ•°:
                  <input type="number" v-model="copyCount" min="1" max="5" />
                </label>
                <label>
                  æ’å…¥ä½ç½®:
                  <select v-model="insertPosition">
                    <option value="start">å¼€å¤´</option>
                    <option value="end">æœ«å°¾</option>
                  </select>
                </label>
              </div>
              <div class="preview-box">
                <div class="copy-preview">
                  <div class="source-page">æºé¡µé¢</div>
                  <div class="arrow">â†’</div>
                  <div class="copies">
                    <div v-for="i in copyCount" :key="i" class="copy-page">å‰¯æœ¬ {{ i }}</div>
                  </div>
                </div>
              </div>
              <button @click="advanced6Generate" class="btn btn-advanced">æ‰§è¡Œå¤åˆ¶</button>
            </div>
            <div class="code-display">
              <pre v-pre><code>// å¤åˆ¶é¡µé¢
const [copiedPage] = await pdfDoc.copyPages(sourcePdf, [0]);

// åœ¨æŒ‡å®šä½ç½®æ’å…¥
pdfDoc.insertPage(0, copiedPage); // æ’å…¥åˆ°å¼€å¤´

// æˆ–æ·»åŠ åˆ°æœ«å°¾
pdfDoc.addPage(copiedPage);

// ç§»é™¤é¡µé¢
pdfDoc.removePage(2); // ç§»é™¤ç¬¬3é¡µ

// è·å–é¡µé¢æ•°é‡
const pageCount = pdfDoc.getPageCount();</code></pre>
            </div>
          </div>
        </div>
      </main>
    </div>
  </div>
</template>

<script setup lang="ts">
import { ref, computed, watch, nextTick } from 'vue'
import { PDFDocument, rgb, StandardFonts, degrees } from 'pdf-lib'
import * as echarts from 'echarts'
import type { ECharts } from 'echarts'

// ==================== åŸºç¡€ç¤ºä¾‹çŠ¶æ€ ====================
const currentExample = ref(0)
const examples = [
  { name: 'åˆ›å»ºç©ºç™½' },
  { name: 'æ·»åŠ æ–‡æœ¬' },
  { name: 'ç»˜åˆ¶å›¾å½¢' },
  { name: 'æ ‡å‡†å­—ä½“' },
  { name: 'é¡µé¢æ—‹è½¬' },
  { name: 'å…ƒæ•°æ®' },
  { name: 'EChartså›¾è¡¨' },
]

// ECharts refs
const pdflibChartRef = ref<HTMLDivElement>()
let pdflibChart: ECharts | null = null

// ç¤ºä¾‹1: åˆ›å»ºç©ºç™½PDF
const pageWidth = ref(600)
const pageHeight = ref(800)
const pageCount = ref(1)

// ç¤ºä¾‹2: æ·»åŠ æ–‡æœ¬
const textContent = ref('Hello PDF-LIB')
const textSize = ref(30)
const textColor = ref('#0087b5')

// ç¤ºä¾‹3: ç»˜åˆ¶å›¾å½¢
const shapeType = ref<'rectangle' | 'circle' | 'line'>('rectangle')
const borderColor = ref('#000000')
const fillColor = ref('#e6e6e6')

// ç¤ºä¾‹4: æ ‡å‡†å­—ä½“
const standardFonts = [
  'Helvetica',
  'HelveticaBold',
  'HelveticaOblique',
  'HelveticaBoldOblique',
  'TimesRoman',
  'TimesRomanBold',
  'TimesRomanItalic',
  'TimesRomanBoldItalic',
  'Courier',
  'CourierBold',
  'CourierOblique',
  'CourierBoldOblique',
  'Symbol',
  'ZapfDingbats',
]
const selectedFont = ref('Helvetica')

// ç¤ºä¾‹5: é¡µé¢æ—‹è½¬
const rotationAngle = ref(0)

// ç¤ºä¾‹6: å…ƒæ•°æ®
const docTitle = ref('My Document')
const docAuthor = ref('Author Name')
const docSubject = ref('Document Subject')
const docKeywords = ref('pdf, lib, example')

// ==================== é«˜çº§ç¤ºä¾‹çŠ¶æ€ ====================
const currentAdvanced = ref(0)
const advancedExamples = [
  { name: 'PDFåˆå¹¶' },
  { name: 'PDFæ‹†åˆ†' },
  { name: 'åˆ›å»ºè¡¨å•' },
  { name: 'æ·»åŠ æ°´å°' },
  { name: 'åµŒå…¥å›¾ç‰‡' },
  { name: 'å¤åˆ¶é¡µé¢' },
]

// é«˜çº§ç¤ºä¾‹2: PDFæ‹†åˆ†
const splitStart = ref(1)
const splitEnd = ref(3)

// é«˜çº§ç¤ºä¾‹3: è¡¨å•
const formName = ref('')
const formEmail = ref('')
const formAgree = ref(false)

// é«˜çº§ç¤ºä¾‹4: æ°´å°
const watermarkText = ref('CONFIDENTIAL')
const watermarkOpacity = ref(0.2)
const watermarkAngle = ref(-45)

// é«˜çº§ç¤ºä¾‹5: å›¾ç‰‡
const imageWidth = ref(200)
const imageHeight = ref(150)
const imageOpacity = ref(1)

// é«˜çº§ç¤ºä¾‹6: å¤åˆ¶é¡µé¢
const copyCount = ref(2)
const insertPosition = ref<'start' | 'end'>('end')

// è®¡ç®—å±æ€§
const pagePreviewStyle = computed(() => ({
  width: `${pageWidth.value * 0.15}px`,
  height: `${pageHeight.value * 0.15}px`,
}))

// è¾…åŠ©å‡½æ•°ï¼šä¸‹è½½PDF
const download = (pdfBytes: Uint8Array, fileName: string) => {
  const blob = new Blob([pdfBytes as unknown as ArrayBuffer], { type: 'application/pdf' })
  const url = URL.createObjectURL(blob)
  const link = document.createElement('a')
  link.href = url
  link.download = fileName
  link.click()
  URL.revokeObjectURL(url)
}

// åœ¨æ–°çª—å£/éšè— iframe ä¸­æ‰“å¼€ PDF å¹¶è§¦å‘æ‰“å°
const printPdfBytes = async (pdfBytes: Uint8Array) => {
  const blob = new Blob([pdfBytes as unknown as ArrayBuffer], { type: 'application/pdf' })
  const url = URL.createObjectURL(blob)
  const iframe = document.createElement('iframe')
  iframe.style.position = 'fixed'
  iframe.style.right = '0'
  iframe.style.bottom = '0'
  iframe.style.width = '0'
  iframe.style.height = '0'
  iframe.style.border = '0'
  iframe.src = url
  document.body.appendChild(iframe)

  await new Promise<void>((resolve) => {
    iframe.onload = () => {
      setTimeout(() => {
        try {
          iframe.contentWindow?.focus()
          iframe.contentWindow?.print()

          // ç›‘å¬æ‰“å°å®Œæˆäº‹ä»¶ï¼ˆæ‰“å°å¯¹è¯æ¡†å…³é—­åæ¸…ç†ï¼‰
          const cleanup = () => {
            setTimeout(() => {
              try {
                document.body.removeChild(iframe)
              } catch (e) {}
              URL.revokeObjectURL(url)
            }, 100)
          }

          // å°è¯•ç›‘å¬ afterprint äº‹ä»¶
          if (iframe.contentWindow) {
            iframe.contentWindow.addEventListener('afterprint', cleanup, { once: true })
            // å¤‡ç”¨ï¼šå¦‚æœ5åˆ†é’Ÿåè¿˜æ²¡æ¸…ç†ï¼Œå¼ºåˆ¶æ¸…ç†
            setTimeout(cleanup, 300000)
          } else {
            cleanup()
          }
        } catch (e) {
          window.open(url)
          setTimeout(() => URL.revokeObjectURL(url), 5000)
        }
        resolve()
      }, 200)
    }
  })
}

// è¾…åŠ©å‡½æ•°ï¼šé¢œè‰²è½¬æ¢
const hexToRgb = (hex: string) => {
  const result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex)
  return result
    ? {
        r: parseInt(result[1] ?? '0', 16) / 255,
        g: parseInt(result[2] ?? '0', 16) / 255,
        b: parseInt(result[3] ?? '0', 16) / 255,
      }
    : { r: 0, g: 0, b: 0 }
}

// ==================== åŸºç¡€ç¤ºä¾‹å‡½æ•° ====================
const example1Generate = async () => {
  const pdfDoc = await PDFDocument.create()

  for (let i = 0; i < pageCount.value; i++) {
    const page = pdfDoc.addPage([pageWidth.value, pageHeight.value])
    page.drawText(`Page ${i + 1}`, {
      x: 50,
      y: pageHeight.value - 50,
      size: 20,
    })
  }

  const pdfBytes = await pdfDoc.save()
  await printPdfBytes(pdfBytes)
}

const example2Generate = async () => {
  const pdfDoc = await PDFDocument.create()
  const page = pdfDoc.addPage([600, 400])
  const { r, g, b } = hexToRgb(textColor.value)

  page.drawText(textContent.value || 'Hello PDF-LIB', {
    x: 50,
    y: 350,
    size: textSize.value,
    color: rgb(r, g, b),
  })

  const pdfBytes = await pdfDoc.save()
  await printPdfBytes(pdfBytes)
}

const example3Generate = async () => {
  const pdfDoc = await PDFDocument.create()
  const page = pdfDoc.addPage([600, 400])
  const border = hexToRgb(borderColor.value)
  const fill = hexToRgb(fillColor.value)

  if (shapeType.value === 'rectangle') {
    page.drawRectangle({
      x: 100,
      y: 100,
      width: 400,
      height: 200,
      borderColor: rgb(border.r, border.g, border.b),
      color: rgb(fill.r, fill.g, fill.b),
      borderWidth: 2,
    })
  } else if (shapeType.value === 'circle') {
    page.drawCircle({
      x: 300,
      y: 200,
      size: 100,
      borderColor: rgb(border.r, border.g, border.b),
      color: rgb(fill.r, fill.g, fill.b),
      borderWidth: 2,
    })
  } else if (shapeType.value === 'line') {
    page.drawLine({
      start: { x: 50, y: 50 },
      end: { x: 550, y: 350 },
      thickness: 3,
      color: rgb(border.r, border.g, border.b),
    })
  }

  const pdfBytes = await pdfDoc.save()
  await printPdfBytes(pdfBytes)
}

const example4Generate = async () => {
  const pdfDoc = await PDFDocument.create()
  const page = pdfDoc.addPage([600, 800])

  let yPos = 750
  for (const fontName of standardFonts.slice(0, 8)) {
    const fontKey = fontName as keyof typeof StandardFonts
    const font = await pdfDoc.embedFont(StandardFonts[fontKey])
    page.drawText(`${fontName}: The quick brown fox`, {
      x: 50,
      y: yPos,
      size: 16,
      font,
    })
    yPos -= 40
  }

  const pdfBytes = await pdfDoc.save()
  await printPdfBytes(pdfBytes)
}

const example5Generate = async () => {
  const pdfDoc = await PDFDocument.create()
  const page = pdfDoc.addPage([600, 800])

  page.setRotation(degrees(rotationAngle.value))

  const font = await pdfDoc.embedFont(StandardFonts.Helvetica)
  page.drawText('This page is rotated!', {
    x: 200,
    y: 400,
    size: 24,
    font,
  })

  page.drawText(`Rotation: ${rotationAngle.value} degrees`, {
    x: 200,
    y: 360,
    size: 16,
    font,
  })

  const pdfBytes = await pdfDoc.save()
  await printPdfBytes(pdfBytes)
}

const example6Generate = async () => {
  const pdfDoc = await PDFDocument.create()
  const page = pdfDoc.addPage([600, 400])

  // è®¾ç½®å…ƒæ•°æ®
  pdfDoc.setTitle(docTitle.value || 'Untitled')
  pdfDoc.setAuthor(docAuthor.value || 'Unknown')
  pdfDoc.setSubject(docSubject.value || '')
  pdfDoc.setKeywords(docKeywords.value.split(',').map((k) => k.trim()))
  pdfDoc.setProducer('PDF-LIB Demo')
  pdfDoc.setCreator('Vue.js Application')
  pdfDoc.setCreationDate(new Date())
  pdfDoc.setModificationDate(new Date())

  const font = await pdfDoc.embedFont(StandardFonts.Helvetica)
  page.drawText('Document with Metadata', {
    x: 50,
    y: 350,
    size: 24,
    font,
  })
  page.drawText(`Title: ${docTitle.value}`, { x: 50, y: 300, size: 14, font })
  page.drawText(`Author: ${docAuthor.value}`, { x: 50, y: 275, size: 14, font })
  page.drawText(`Subject: ${docSubject.value}`, { x: 50, y: 250, size: 14, font })

  const pdfBytes = await pdfDoc.save()
  await printPdfBytes(pdfBytes)
}

// ç¤ºä¾‹7: EChartsç”ŸæˆPDF
const initPdflibChart = () => {
  if (pdflibChartRef.value && !pdflibChart) {
    pdflibChart = echarts.init(pdflibChartRef.value)
    pdflibChart.setOption({
      title: {
        text: 'æœˆåº¦é”€å”®è¶‹åŠ¿',
        left: 'center',
      },
      tooltip: {
        trigger: 'axis',
      },
      xAxis: {
        type: 'category',
        data: ['1æœˆ', '2æœˆ', '3æœˆ', '4æœˆ', '5æœˆ', '6æœˆ'],
      },
      yAxis: {
        type: 'value',
      },
      series: [
        {
          name: 'é”€å”®é¢',
          type: 'line',
          data: [120, 200, 150, 180, 220, 250],
          smooth: true,
          itemStyle: {
            color: '#5470c6',
          },
          areaStyle: {
            color: 'rgba(84, 112, 198, 0.3)',
          },
        },
      ],
    })
  }
}

const example7Generate = async () => {
  if (!pdflibChart) return

  try {
    // ç­‰å¾…å›¾è¡¨å®Œå…¨æ¸²æŸ“
    await new Promise((resolve) => setTimeout(resolve, 500))

    // 1. ä»EChartsè·å–å›¾ç‰‡æ•°æ®
    const imageDataUrl = pdflibChart.getDataURL({
      type: 'png',
      pixelRatio: 3,
      backgroundColor: '#fff',
    })

    // 2. åˆ›å»ºPDFï¼ˆA4å°ºå¯¸ 595 x 842ï¼‰
    const pdfDoc = await PDFDocument.create()
    const page = pdfDoc.addPage([595, 842])

    // 3. åµŒå…¥PNGå›¾ç‰‡
    const pngImage = await pdfDoc.embedPng(imageDataUrl)

    // 4. è®¡ç®—åˆé€‚çš„ç¼©æ”¾æ¯”ä¾‹ï¼Œä½¿å›¾è¡¨å æ»¡å¤§éƒ¨åˆ†é¡µé¢
    const maxWidth = 500
    const maxHeight = 400
    const imgDims = pngImage.scale(1)
    const scaleX = maxWidth / imgDims.width
    const scaleY = maxHeight / imgDims.height
    const scale = Math.min(scaleX, scaleY)
    const scaledDims = pngImage.scale(scale)

    // 5. åœ¨PDFä¸­ç»˜åˆ¶å›¾è¡¨ï¼ˆå±…ä¸­ï¼‰
    page.drawImage(pngImage, {
      x: (595 - scaledDims.width) / 2,
      y: (842 - scaledDims.height) / 2 + 100,
      width: scaledDims.width,
      height: scaledDims.height,
    })

    // 6. æ·»åŠ æ–‡å­—è¯´æ˜
    const font = await pdfDoc.embedFont(StandardFonts.Helvetica)
    page.drawText('ECharts Chart Export via PDF-LIB', {
      x: 50,
      y: 780,
      size: 20,
      font,
      color: rgb(0.2, 0.2, 0.2),
    })

    const pdfBytes = await pdfDoc.save()
    await printPdfBytes(pdfBytes)
  } catch (error) {
    console.error('ç”ŸæˆPDFå¤±è´¥:', error)
    alert('ç”ŸæˆPDFå¤±è´¥: ' + error)
  }
}

// Watch currentExample to initialize chart
watch(currentExample, async (newVal) => {
  if (newVal === 6) {
    await nextTick()
    initPdflibChart()
  }
})

// ==================== é«˜çº§ç¤ºä¾‹å‡½æ•° ====================
const advanced1Generate = async () => {
  // åˆ›å»ºä¸‰ä¸ªPDF
  const pdfs = []
  for (let i = 1; i <= 3; i++) {
    const doc = await PDFDocument.create()
    const page = doc.addPage([600, 400])
    const font = await doc.embedFont(StandardFonts.Helvetica)
    page.drawText(`PDF Document ${i}`, {
      x: 50,
      y: 350,
      size: 30,
      font,
      color: rgb(i * 0.2, 0.3, 0.7),
    })
    pdfs.push(await doc.save())
  }

  // åˆå¹¶
  const mergedPdf = await PDFDocument.create()
  for (const pdfBytes of pdfs) {
    const pdf = await PDFDocument.load(pdfBytes)
    const copiedPages = await mergedPdf.copyPages(pdf, pdf.getPageIndices())
    copiedPages.forEach((page) => mergedPdf.addPage(page))
  }

  const mergedBytes = await mergedPdf.save()
  await printPdfBytes(mergedBytes)
}

const advanced2Generate = async () => {
  // åˆ›å»ºä¸€ä¸ª5é¡µçš„PDF
  const sourcePdf = await PDFDocument.create()
  const font = await sourcePdf.embedFont(StandardFonts.Helvetica)

  for (let i = 1; i <= 5; i++) {
    const page = sourcePdf.addPage([600, 400])
    page.drawText(`Page ${i}`, { x: 250, y: 200, size: 48, font })
  }
  const sourceBytes = await sourcePdf.save()

  // æ‹†åˆ†
  const loadedPdf = await PDFDocument.load(sourceBytes)
  const newPdf = await PDFDocument.create()

  const startIdx = splitStart.value - 1
  const endIdx = splitEnd.value - 1
  const indices = []
  for (let i = startIdx; i <= endIdx && i < 5; i++) {
    indices.push(i)
  }

  const copiedPages = await newPdf.copyPages(loadedPdf, indices)
  copiedPages.forEach((page) => newPdf.addPage(page))

  const splitBytes = await newPdf.save()
  await printPdfBytes(splitBytes)
}

const advanced3Generate = async () => {
  const pdfDoc = await PDFDocument.create()
  const page = pdfDoc.addPage([600, 800])
  const form = pdfDoc.getForm()
  const font = await pdfDoc.embedFont(StandardFonts.Helvetica)

  page.drawText('User Information Form', {
    x: 180,
    y: 750,
    size: 24,
    font,
  })

  // å§“åå­—æ®µ
  page.drawText('Name:', { x: 50, y: 680, size: 14, font })
  const nameField = form.createTextField('name')
  nameField.setText(formName.value || '')
  nameField.addToPage(page, { x: 150, y: 670, width: 200, height: 25 })

  // é‚®ç®±å­—æ®µ
  page.drawText('Email:', { x: 50, y: 630, size: 14, font })
  const emailField = form.createTextField('email')
  emailField.setText(formEmail.value || '')
  emailField.addToPage(page, { x: 150, y: 620, width: 200, height: 25 })

  // å¤é€‰æ¡†
  const checkbox = form.createCheckBox('agree')
  checkbox.addToPage(page, { x: 50, y: 570, width: 20, height: 20 })
  if (formAgree.value) checkbox.check()
  page.drawText('I agree to terms', { x: 80, y: 575, size: 12, font })

  const pdfBytes = await pdfDoc.save()
  await printPdfBytes(pdfBytes)
}

const advanced4Generate = async () => {
  const pdfDoc = await PDFDocument.create()
  const font = await pdfDoc.embedFont(StandardFonts.Helvetica)

  // åˆ›å»ºä¸¤é¡µå†…å®¹
  for (let i = 1; i <= 2; i++) {
    const page = pdfDoc.addPage([600, 800])
    page.drawText(`Page ${i} Content`, { x: 50, y: 750, size: 20, font })
  }

  // æ·»åŠ æ°´å°
  const pages = pdfDoc.getPages()
  pages.forEach((page) => {
    const { width, height } = page.getSize()
    page.drawText(watermarkText.value || 'CONFIDENTIAL', {
      x: width / 2 - 100,
      y: height / 2,
      size: 60,
      font,
      color: rgb(0.9, 0.1, 0.1),
      opacity: watermarkOpacity.value,
      rotate: degrees(watermarkAngle.value),
    })
  })

  const pdfBytes = await pdfDoc.save()
  await printPdfBytes(pdfBytes)
}

const advanced5Generate = async () => {
  const pdfDoc = await PDFDocument.create()
  const page = pdfDoc.addPage([600, 800])
  const font = await pdfDoc.embedFont(StandardFonts.Helvetica)

  page.drawText('Image Embedding Example', { x: 50, y: 750, size: 24, font })

  // åˆ›å»ºç¤ºä¾‹PNG (1x1é€æ˜åƒç´ )
  const pngDataUrl =
    'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mNk+M9QDwADhgGAWjR9awAAAABJRU5ErkJggg=='
  const pngBytes = await fetch(pngDataUrl).then((res) => res.arrayBuffer())
  const pngImage = await pdfDoc.embedPng(pngBytes)

  // ç»˜åˆ¶å¤šä¸ªå›¾ç‰‡
  for (let i = 0; i < 3; i++) {
    page.drawImage(pngImage, {
      x: 50 + i * (imageWidth.value + 20),
      y: 500,
      width: imageWidth.value,
      height: imageHeight.value,
      opacity: imageOpacity.value - i * 0.2,
    })
  }

  page.drawText('(Images with different opacity)', { x: 50, y: 450, size: 12, font })

  const pdfBytes = await pdfDoc.save()
  await printPdfBytes(pdfBytes)
}

const advanced6Generate = async () => {
  // åˆ›å»ºæºPDF
  const sourcePdf = await PDFDocument.create()
  const sourceFont = await sourcePdf.embedFont(StandardFonts.Helvetica)
  const sourcePage = sourcePdf.addPage([600, 400])
  sourcePage.drawText('Original Page', { x: 200, y: 200, size: 30, font: sourceFont })
  const sourceBytes = await sourcePdf.save()

  // å¤åˆ¶é¡µé¢
  const pdfDoc = await PDFDocument.create()
  const loaded = await PDFDocument.load(sourceBytes)

  for (let i = 0; i < copyCount.value; i++) {
    const [copiedPage] = await pdfDoc.copyPages(loaded, [0])
    if (insertPosition.value === 'start') {
      pdfDoc.insertPage(i, copiedPage)
    } else {
      pdfDoc.addPage(copiedPage)
    }
  }

  const pdfBytes = await pdfDoc.save()
  await printPdfBytes(pdfBytes)
}

// ==================== åŸæœ‰å¿«æ·åŠŸèƒ½ ====================
const createBasicPDF = async () => {
  const pdfDoc = await PDFDocument.create()
  const page = pdfDoc.addPage([600, 400])

  const { width, height } = page.getSize()

  page.drawText('Hello, PDF-LIB!', {
    x: 50,
    y: height - 50,
    size: 30,
    color: rgb(0, 0.53, 0.71),
  })

  page.drawText('Created with PDF-LIB - Basic Document Example', {
    x: 50,
    y: height - 100,
    size: 16,
    color: rgb(0.2, 0.2, 0.2),
  })

  page.drawRectangle({
    x: 50,
    y: height - 250,
    width: 500,
    height: 100,
    borderColor: rgb(0, 0.53, 0.71),
    borderWidth: 2,
  })

  page.drawText('Text inside rectangle box', {
    x: 70,
    y: height - 190,
    size: 14,
    color: rgb(0, 0, 0),
  })

  const pdfBytes = await pdfDoc.save()
  await printPdfBytes(pdfBytes)
}

const modifyExistingPDF = async () => {
  const existingPdf = await PDFDocument.create()
  const page = existingPdf.addPage([600, 400])
  page.drawText('Original PDF Document', {
    x: 50,
    y: 350,
    size: 24,
    color: rgb(0, 0, 0),
  })
  const existingPdfBytes = await existingPdf.save()

  const pdfDoc = await PDFDocument.load(existingPdfBytes)
  const pages = pdfDoc.getPages()
  const firstPage = pages[0]

  if (firstPage) {
    firstPage.drawText('EDITED', {
      x: 50,
      y: 300,
      size: 20,
      color: rgb(0.95, 0.1, 0.1),
    })

    firstPage.drawText(`Edit time: ${new Date().toLocaleString('en-US')}`, {
      x: 50,
      y: 270,
      size: 12,
      color: rgb(0.5, 0.5, 0.5),
    })
  }

  const modifiedPdfBytes = await pdfDoc.save()
  await printPdfBytes(modifiedPdfBytes)
}

const mergePDFs = async () => {
  const pdf1 = await PDFDocument.create()
  const page1 = pdf1.addPage([600, 400])
  page1.drawText('First PDF Document', {
    x: 50,
    y: 350,
    size: 24,
    color: rgb(0.2, 0.4, 0.8),
  })
  const pdf1Bytes = await pdf1.save()

  const pdf2 = await PDFDocument.create()
  const page2 = pdf2.addPage([600, 400])
  page2.drawText('Second PDF Document', {
    x: 50,
    y: 350,
    size: 24,
    color: rgb(0.8, 0.2, 0.4),
  })
  const pdf2Bytes = await pdf2.save()

  const mergedPdf = await PDFDocument.create()

  const pdfA = await PDFDocument.load(pdf1Bytes)
  const pdfB = await PDFDocument.load(pdf2Bytes)

  const copiedPagesA = await mergedPdf.copyPages(pdfA, pdfA.getPageIndices())
  const copiedPagesB = await mergedPdf.copyPages(pdfB, pdfB.getPageIndices())

  copiedPagesA.forEach((page) => mergedPdf.addPage(page))
  copiedPagesB.forEach((page) => mergedPdf.addPage(page))

  const mergedPdfBytes = await mergedPdf.save()
  await printPdfBytes(mergedPdfBytes)
}

const embedImages = async () => {
  const pdfDoc = await PDFDocument.create()
  const page = pdfDoc.addPage([600, 800])

  const pngDataUrl =
    'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mNk+M9QDwADhgGAWjR9awAAAABJRU5ErkJggg=='
  const pngBytes = await fetch(pngDataUrl).then((res) => res.arrayBuffer())
  const pngImage = await pdfDoc.embedPng(pngBytes)

  const { height } = page.getSize()

  page.drawText('Image Embedding Example', {
    x: 50,
    y: height - 50,
    size: 24,
    color: rgb(0, 0, 0),
  })

  for (let i = 0; i < 3; i++) {
    page.drawImage(pngImage, {
      x: 50 + i * 150,
      y: height - 200,
      width: 100,
      height: 100,
      opacity: 0.3 + i * 0.3,
    })

    page.drawText(`Opacity: ${((0.3 + i * 0.3) * 100).toFixed(0)}%`, {
      x: 50 + i * 150,
      y: height - 220,
      size: 10,
      color: rgb(0, 0, 0),
    })
  }

  const pdfBytes = await pdfDoc.save()
  await printPdfBytes(pdfBytes)
}

const addWatermark = async () => {
  const pdfDoc = await PDFDocument.create()
  const page1 = pdfDoc.addPage([600, 800])
  const page2 = pdfDoc.addPage([600, 800])

  const font = await pdfDoc.embedFont(StandardFonts.Helvetica)

  page1.drawText('Page 1 Content', { x: 50, y: 750, size: 20, font })
  page2.drawText('Page 2 Content', { x: 50, y: 750, size: 20, font })

  const pages = pdfDoc.getPages()
  pages.forEach((page) => {
    const { width, height } = page.getSize()

    page.drawText('CONFIDENTIAL', {
      x: width / 2 - 80,
      y: height / 2,
      size: 80,
      font,
      color: rgb(0.95, 0.1, 0.1),
      opacity: 0.2,
      rotate: degrees(-45),
    })

    page.drawText('CONFIDENTIAL', {
      x: width / 2 - 100,
      y: height / 2 - 60,
      size: 40,
      font,
      color: rgb(0.95, 0.1, 0.1),
      opacity: 0.15,
      rotate: degrees(-45),
    })
  })

  const watermarkedPdf = await pdfDoc.save()
  await printPdfBytes(watermarkedPdf)
}

const fillForm = async () => {
  const pdfDoc = await PDFDocument.create()
  const page = pdfDoc.addPage([600, 800])
  const form = pdfDoc.getForm()

  const { height } = page.getSize()

  page.drawText('User Information Form', {
    x: 50,
    y: height - 50,
    size: 24,
    color: rgb(0, 0, 0),
  })

  const nameField = form.createTextField('name')
  nameField.setText('John Doe')
  nameField.addToPage(page, { x: 150, y: height - 120, width: 200, height: 25 })

  page.drawText('Name:', { x: 50, y: height - 110, size: 14 })

  const emailField = form.createTextField('email')
  emailField.setText('john@example.com')
  emailField.addToPage(page, { x: 150, y: height - 170, width: 200, height: 25 })

  page.drawText('Email:', { x: 50, y: height - 160, size: 14 })

  const agreeCheckBox = form.createCheckBox('agree')
  agreeCheckBox.check()
  agreeCheckBox.addToPage(page, { x: 50, y: height - 220, width: 20, height: 20 })

  page.drawText('I agree to terms and conditions', { x: 80, y: height - 215, size: 12 })

  page.drawText('(Form auto-filled)', {
    x: 50,
    y: height - 270,
    size: 10,
    color: rgb(0.5, 0.5, 0.5),
  })

  const filledPdfBytes = await pdfDoc.save()
  await printPdfBytes(filledPdfBytes)
}

const createComplexDoc = async () => {
  const pdfDoc = await PDFDocument.create()
  const timesRomanFont = await pdfDoc.embedFont(StandardFonts.TimesRoman)
  const helveticaBoldFont = await pdfDoc.embedFont(StandardFonts.HelveticaBold)

  const coverPage = pdfDoc.addPage([600, 800])
  const { width: coverWidth, height: coverHeight } = coverPage.getSize()

  // æ³¨: PDF-LIBä¸ç›´æ¥æ”¯æŒä¸­æ–‡ï¼Œæ˜¾ç¤ºæ‹¼éŸ³æ›¿ä»£
  coverPage.drawText('Frontend Printing Report', {
    x: 120,
    y: coverHeight / 2 + 100,
    size: 32,
    font: helveticaBoldFont,
    color: rgb(0, 0.25, 0.5),
  })

  coverPage.drawText('(Qian Duan Da Yin Ji Shu Bao Gao)', {
    x: 150,
    y: coverHeight / 2 + 60,
    size: 14,
    font: timesRomanFont,
    color: rgb(0.4, 0.4, 0.4),
  })

  coverPage.drawText('Modern Web Printing Solutions', {
    x: 130,
    y: coverHeight / 2 + 20,
    size: 20,
    font: timesRomanFont,
    color: rgb(0.2, 0.2, 0.2),
  })

  coverPage.drawText(`Date: ${new Date().toLocaleDateString('en-US')}`, {
    x: 220,
    y: 100,
    size: 14,
    font: timesRomanFont,
    color: rgb(0.5, 0.5, 0.5),
  })

  const contentPage = pdfDoc.addPage([600, 800])
  const { height: contentHeight } = contentPage.getSize()

  contentPage.drawText('Chapter 1: Technical Overview', {
    x: 30,
    y: contentHeight - 50,
    size: 22,
    font: helveticaBoldFont,
    color: rgb(0, 0, 0),
  })

  contentPage.drawText('(Di Yi Zhang: Ji Shu Gai Shu)', {
    x: 30,
    y: contentHeight - 75,
    size: 11,
    font: timesRomanFont,
    color: rgb(0.5, 0.5, 0.5),
  })

  const paragraphs = [
    'This report introduces modern frontend printing',
    'framework technology selection and implementation,',
    'including native browser APIs and third-party libs.',
    '',
    'PDF-LIB is a powerful modern PDF manipulation',
    'library supporting creation, editing, merging',
    'and form filling features.',
    '',
    'Key Features:',
    '- Pure JavaScript, no backend required',
    '- Modern ES6+ syntax support',
    '- Complete TypeScript type definitions',
    '- Can edit existing PDF documents',
  ]

  let yPosition = contentHeight - 110
  paragraphs.forEach((text) => {
    contentPage.drawText(text, {
      x: 30,
      y: yPosition,
      size: 12,
      font: timesRomanFont,
      color: rgb(0.2, 0.2, 0.2),
    })
    yPosition -= 20
  })

  const pdfBytes = await pdfDoc.save()
  await printPdfBytes(pdfBytes)
}
</script>

<style scoped>
/* å¤ç”¨ä¹‹å‰çš„æ ·å¼ */
.demo-page {
  min-height: 100vh;
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  padding: 20px;
}

.page-header {
  background: white;
  padding: 30px;
  border-radius: 12px;
  margin-bottom: 30px;
  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.page-header h1 {
  margin: 0;
  color: #2c3e50;
  font-size: 28px;
}

.back-link {
  padding: 10px 20px;
  background: #667eea;
  color: white;
  text-decoration: none;
  border-radius: 6px;
  transition: all 0.3s;
}

.back-link:hover {
  background: #764ba2;
  transform: translateY(-2px);
}

.content-grid {
  display: grid;
  grid-template-columns: 300px 1fr;
  gap: 30px;
}

.info-panel {
  background: white;
  border-radius: 12px;
  padding: 25px;
  height: fit-content;
  position: sticky;
  top: 20px;
  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
}

.info-panel h2 {
  margin-top: 0;
  color: #667eea;
  border-bottom: 2px solid #667eea;
  padding-bottom: 10px;
}

.info-section {
  margin-bottom: 20px;
}

.info-section h3 {
  color: #2c3e50;
  font-size: 14px;
  margin-bottom: 8px;
}

.info-section p {
  margin: 5px 0;
  font-size: 14px;
  color: #666;
}

.info-section ul {
  margin: 8px 0;
  padding-left: 20px;
}

.info-section li {
  margin: 5px 0;
  font-size: 13px;
  color: #666;
}

.browser-badges {
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
  margin-top: 10px;
}

.badge {
  padding: 4px 8px;
  border-radius: 4px;
  font-size: 12px;
  font-weight: 500;
}

.badge-success {
  background: #d4edda;
  color: #155724;
}

.badge-error {
  background: #f8d7da;
  color: #721c24;
}

.demo-content {
  background: white;
  border-radius: 12px;
  padding: 30px;
  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
}

.section {
  margin-bottom: 40px;
  padding-bottom: 30px;
  border-bottom: 1px solid #e0e0e0;
}

.section:last-child {
  border-bottom: none;
}

.section h2 {
  color: #2c3e50;
  margin-bottom: 20px;
  font-size: 22px;
}

.btn {
  padding: 12px 24px;
  border: none;
  border-radius: 6px;
  font-size: 16px;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.3s;
  margin-right: 10px;
  margin-bottom: 15px;
}

.btn-primary {
  background: #667eea;
  color: white;
}
.btn-primary:hover {
  background: #5568d3;
  transform: translateY(-2px);
  box-shadow: 0 4px 8px rgba(102, 126, 234, 0.4);
}

.btn-success {
  background: #48bb78;
  color: white;
}
.btn-success:hover {
  background: #38a169;
  transform: translateY(-2px);
  box-shadow: 0 4px 8px rgba(72, 187, 120, 0.4);
}

.btn-info {
  background: #4299e1;
  color: white;
}
.btn-info:hover {
  background: #3182ce;
  transform: translateY(-2px);
  box-shadow: 0 4px 8px rgba(66, 153, 225, 0.4);
}

.btn-warning {
  background: #ed8936;
  color: white;
}
.btn-warning:hover {
  background: #dd6b20;
  transform: translateY(-2px);
  box-shadow: 0 4px 8px rgba(237, 137, 54, 0.4);
}

.btn-secondary {
  background: #718096;
  color: white;
}
.btn-secondary:hover {
  background: #4a5568;
  transform: translateY(-2px);
  box-shadow: 0 4px 8px rgba(113, 128, 150, 0.4);
}

.btn-danger {
  background: #f56565;
  color: white;
}
.btn-danger:hover {
  background: #e53e3e;
  transform: translateY(-2px);
  box-shadow: 0 4px 8px rgba(245, 101, 101, 0.4);
}

.code-block {
  background: #f8f9fa;
  border-left: 4px solid #667eea;
  padding: 15px;
  margin: 15px 0;
  border-radius: 4px;
}

.code-block h4 {
  margin-top: 0;
  color: #667eea;
  font-size: 14px;
}

.code-block pre {
  margin: 10px 0 0 0;
  overflow-x: auto;
}

.code-block code {
  font-family: 'Courier New', Courier, monospace;
  font-size: 13px;
  line-height: 1.6;
  color: #2c3e50;
}

.comparison-section {
  margin: 40px 0;
}

.comparison-table {
  width: 100%;
  border-collapse: collapse;
  margin-top: 20px;
}

.comparison-table th,
.comparison-table td {
  padding: 12px;
  text-align: left;
  border: 1px solid #e0e0e0;
}

.comparison-table th {
  background: #f8f9fa;
  font-weight: 600;
  color: #2c3e50;
}

.comparison-table .success {
  color: #48bb78;
  font-weight: 500;
}

.comparison-table .warning {
  color: #ed8936;
  font-weight: 500;
}

.comparison-table .error {
  color: #f56565;
  font-weight: 500;
}

.best-practices {
  margin: 40px 0;
}

.best-practices h2 {
  color: #2c3e50;
  margin-bottom: 20px;
}

.practice-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
  gap: 20px;
  margin-top: 20px;
}

.practice-card {
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color: white;
  padding: 20px;
  border-radius: 8px;
  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
}

.practice-card h3 {
  margin-top: 0;
  font-size: 16px;
}

.practice-card p {
  margin: 10px 0 0 0;
  font-size: 14px;
  opacity: 0.95;
}

.features-highlight {
  margin: 40px 0;
}

.features-highlight h2 {
  color: #2c3e50;
  margin-bottom: 20px;
  text-align: center;
}

.feature-cards {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
  gap: 25px;
  margin-top: 30px;
}

.feature-card {
  background: white;
  border: 2px solid #e0e0e0;
  border-radius: 12px;
  padding: 25px;
  text-align: center;
  transition: all 0.3s;
}

.feature-card:hover {
  border-color: #667eea;
  transform: translateY(-5px);
  box-shadow: 0 8px 16px rgba(102, 126, 234, 0.2);
}

.feature-icon {
  font-size: 48px;
  margin-bottom: 15px;
}

.feature-card h3 {
  color: #2c3e50;
  font-size: 18px;
  margin: 10px 0;
}

.feature-card p {
  color: #666;
  font-size: 14px;
  line-height: 1.6;
  margin: 0;
}

/* ==================== åŸºç¡€ç¤ºä¾‹æ ·å¼ ==================== */
.examples-section {
  margin-top: 40px;
  padding: 25px;
  background: #f0fff4;
  border-radius: 12px;
  border: 1px solid #9ae6b4;
}

.section-title {
  color: #276749;
  font-size: 1.4rem;
  margin-bottom: 20px;
}

.example-tabs {
  display: flex;
  flex-wrap: wrap;
  gap: 10px;
  margin-bottom: 25px;
  padding-bottom: 15px;
  border-bottom: 1px solid #9ae6b4;
}

.tab-button {
  padding: 8px 16px;
  border: 1px solid #9ae6b4;
  background: white;
  border-radius: 6px;
  cursor: pointer;
  font-size: 14px;
  transition: all 0.3s ease;
}

.tab-button:hover {
  background: #c6f6d5;
}

.tab-button.active {
  background: #48bb78;
  color: white;
  border-color: #48bb78;
}

.tab-button.advanced {
  border-color: #feb2b2;
}

.tab-button.advanced:hover {
  background: #fed7d7;
}

.tab-button.advanced.active {
  background: #f56565;
  border-color: #f56565;
}

.example-content {
  padding: 20px;
  background: white;
  border-radius: 8px;
  border: 1px solid #e2e8f0;
}

.example-content h4 {
  color: #2c3e50;
  margin-bottom: 10px;
}

.example-content > p {
  color: #718096;
  margin-bottom: 15px;
}

.demo-box {
  margin: 15px 0;
  padding: 20px;
  background: #f8f9fa;
  border-radius: 8px;
  border: 1px dashed #cbd5e0;
}

.preview-box {
  background: white;
  padding: 20px;
  border-radius: 8px;
  border: 1px solid #e2e8f0;
  margin-bottom: 15px;
  text-align: center;
}

.config-controls {
  display: flex;
  flex-wrap: wrap;
  gap: 15px;
  margin-bottom: 15px;
}

.config-controls label {
  display: flex;
  flex-direction: column;
  gap: 5px;
  font-size: 14px;
  color: #4a5568;
}

.config-controls input,
.config-controls select {
  padding: 8px 12px;
  border: 1px solid #e2e8f0;
  border-radius: 4px;
  min-width: 120px;
}

.code-display {
  margin-top: 15px;
}

.code-display pre {
  background: #2d3748;
  color: #e2e8f0;
  padding: 15px;
  border-radius: 6px;
  overflow-x: auto;
  font-size: 13px;
  line-height: 1.5;
}

.btn-advanced {
  background: #f56565;
  color: white;
  padding: 10px 20px;
  border: none;
  border-radius: 6px;
  cursor: pointer;
  font-weight: 500;
  transition: all 0.3s ease;
}

.btn-advanced:hover {
  background: #e53e3e;
  transform: translateY(-2px);
}

/* ==================== é«˜çº§ç¤ºä¾‹æ ·å¼ ==================== */
.advanced-section {
  margin-top: 40px;
  padding: 25px;
  background: #fff5f5;
  border-radius: 12px;
  border: 1px solid #feb2b2;
}

.advanced-section .section-title {
  color: #c53030;
}

/* é¡µé¢é¢„è§ˆ */
.page-preview {
  background: #f7fafc;
  border: 2px solid #667eea;
  display: flex;
  align-items: center;
  justify-content: center;
  margin: 0 auto;
  font-size: 12px;
  color: #718096;
}

/* æ–‡æœ¬é¢„è§ˆ */
.text-preview {
  min-height: 60px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: 500;
}

/* å›¾å½¢é¢„è§ˆ */
.shape-preview {
  display: flex;
  justify-content: center;
  padding: 10px;
}

/* å­—ä½“åˆ—è¡¨ */
.font-list {
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
  justify-content: center;
}

.font-item {
  padding: 4px 10px;
  background: #f7fafc;
  border-radius: 4px;
  font-size: 12px;
}

.font-item.active {
  background: #667eea;
  color: white;
}

/* æ—‹è½¬é¢„è§ˆ */
.rotation-preview {
  width: 100px;
  height: 140px;
  background: #f7fafc;
  border: 2px solid #667eea;
  margin: 0 auto;
  display: flex;
  flex-direction: column;
  align-items: center;
  padding-top: 10px;
  transition: transform 0.3s ease;
}

.page-indicator span {
  font-size: 12px;
  color: #667eea;
}

/* å…ƒæ•°æ®è¡¨å• */
.metadata-form {
  flex-direction: column;
}

.metadata-form label {
  flex-direction: row;
  align-items: center;
  gap: 10px;
}

.metadata-form input {
  flex: 1;
}

.metadata-preview h5 {
  margin-bottom: 10px;
  color: #2c3e50;
}

.metadata-preview p {
  margin: 5px 0;
  font-size: 14px;
  text-align: left;
}

/* åˆå¹¶é¢„è§ˆ */
.merge-preview {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 10px;
  flex-wrap: wrap;
}

.pdf-thumb {
  width: 60px;
  height: 80px;
  background: #f7fafc;
  border: 2px solid #667eea;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 12px;
  border-radius: 4px;
}

.pdf-thumb.merged {
  width: 80px;
  background: #c6f6d5;
  border-color: #48bb78;
}

.merge-arrow {
  font-size: 20px;
  color: #718096;
}

/* é¡µé¢èŒƒå›´é¢„è§ˆ */
.page-range-preview {
  display: flex;
  gap: 10px;
  justify-content: center;
  margin-bottom: 10px;
}

.page-box {
  width: 40px;
  height: 50px;
  background: #f7fafc;
  border: 2px solid #e2e8f0;
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: 4px;
  font-weight: bold;
}

.page-box.selected {
  background: #c6f6d5;
  border-color: #48bb78;
}

/* è¡¨å•é¢„è§ˆ */
.form-preview {
  padding: 15px;
  background: #f7fafc;
  border-radius: 6px;
  margin-bottom: 15px;
}

.form-field {
  margin-bottom: 15px;
}

.form-field label {
  display: block;
  margin-bottom: 5px;
  font-weight: 500;
}

.form-field input[type='text'],
.form-field input[type='email'] {
  width: 100%;
  padding: 8px;
  border: 1px solid #e2e8f0;
  border-radius: 4px;
}

.checkbox-field {
  display: flex;
  align-items: center;
  gap: 10px;
}

.checkbox-field label {
  margin-bottom: 0;
}

/* æ°´å°é¢„è§ˆ */
.watermark-preview {
  position: relative;
  height: 150px;
  overflow: hidden;
}

.watermark-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%) rotate(-45deg);
  font-size: 32px;
  font-weight: bold;
  color: #f56565;
  white-space: nowrap;
}

/* å›¾ç‰‡å ä½ç¬¦ */
.image-placeholder {
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color: white;
  display: flex;
  align-items: center;
  justify-content: center;
  margin: 0 auto;
  border-radius: 4px;
  font-size: 14px;
}

/* å¤åˆ¶é¢„è§ˆ */
.copy-preview {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 15px;
}

.source-page {
  width: 60px;
  height: 80px;
  background: #667eea;
  color: white;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 11px;
  border-radius: 4px;
}

.copies {
  display: flex;
  gap: 10px;
}

.copy-page {
  width: 50px;
  height: 70px;
  background: #c6f6d5;
  border: 2px solid #48bb78;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 10px;
  border-radius: 4px;
}

.arrow {
  font-size: 24px;
  color: #718096;
}

@media (max-width: 1024px) {
  .content-grid {
    grid-template-columns: 1fr;
  }

  .info-panel {
    position: relative;
    top: 0;
  }
}

/* æ¡†æ¶ç‰¹ç‚¹è¯´æ˜æ ·å¼ */
.framework-highlight {
  background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
  color: #1a202c;
  padding: 1.2rem;
  border-radius: 8px;
  margin: 1rem 0;
  line-height: 2;
  border: 2px solid #4facfe;
}

.framework-highlight strong {
  font-weight: 700;
  color: #2d3748;
}

.framework-highlight .advantage {
  color: #22543d;
  font-weight: 700;
  background: rgba(154, 230, 180, 0.3);
  padding: 2px 6px;
  border-radius: 4px;
}

.framework-highlight .disadvantage {
  color: #742a2a;
  font-weight: 700;
  background: rgba(254, 178, 178, 0.3);
  padding: 2px 6px;
  border-radius: 4px;
}

.framework-highlight .comparison {
  color: #2c5282;
  font-weight: 600;
  background: rgba(190, 227, 248, 0.3);
  padding: 2px 6px;
  border-radius: 4px;
}
</style>
