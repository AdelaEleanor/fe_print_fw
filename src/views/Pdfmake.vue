<template>
  <div class="demo-page">
    <header class="page-header">
      <h1>ğŸ“‹ pdfmake - å£°æ˜å¼PDFç”Ÿæˆ</h1>
      <router-link to="/" class="back-link">â† è¿”å›é¦–é¡µ</router-link>
    </header>

    <div class="content-grid">
      <aside class="info-panel">
        <h2>æŠ€æœ¯è¯¦æƒ…</h2>
        <div class="info-section">
          <h3>ğŸ“¦ ä¾èµ–</h3>
          <p><strong>pdfmake</strong></p>
          <p>npm install pdfmake</p>
        </div>

        <div class="info-section">
          <h3>ğŸ¯ å…¼å®¹æ€§</h3>
          <ul>
            <li>âœ… Chrome 60+</li>
            <li>âœ… Firefox 55+</li>
            <li>âœ… Safari 11+</li>
            <li>âœ… Edge 79+</li>
            <li>âœ… Node.js</li>
          </ul>
          <p class="rating">è¯„åˆ†: â­â­â­â­ (85%)</p>
        </div>

        <div class="info-section">
          <h3>âš¡ æ€§èƒ½</h3>
          <ul>
            <li>âœ… å®¢æˆ·ç«¯/æœåŠ¡ç«¯</li>
            <li>âœ… é«˜æ•ˆæ¸²æŸ“</li>
            <li>âš ï¸ é¦–æ¬¡åŠ è½½è¾ƒæ…¢</li>
          </ul>
          <p class="rating">è¯„åˆ†: â­â­â­â­</p>
        </div>

        <div class="info-section">
          <h3>ğŸ“‘ åˆ†é¡µæ§åˆ¶</h3>
          <ul>
            <li>âœ… å®Œå…¨å¯æ§</li>
            <li>âœ… pageBreak</li>
            <li>âœ… è‡ªåŠ¨åˆ†é¡µ</li>
            <li>âœ… é¡µçœ‰é¡µè„š</li>
          </ul>
          <p class="rating">è¯„åˆ†: â­â­â­â­â­</p>
        </div>

        <div class="info-section">
          <h3>ğŸ“ æ–‡ä»¶å¤§å°</h3>
          <p class="highlight">~600 KB</p>
          <p>(åŒ…å«å­—ä½“)</p>
        </div>

        <div class="info-section">
          <h3>âœ¨ æ ¸å¿ƒåŠŸèƒ½</h3>
          <ul>
            <li>âœ… å£°æ˜å¼ API</li>
            <li>âœ… è¡¨æ ¼å¸ƒå±€</li>
            <li>âœ… åˆ—è¡¨æ ·å¼</li>
            <li>âœ… å›¾ç‰‡åµŒå…¥</li>
            <li>âœ… å¤šè¯­è¨€æ”¯æŒ</li>
            <li>âœ… æ°´å°èƒŒæ™¯</li>
          </ul>
        </div>

        <div class="info-section">
          <h3>âœ¨ ä¼˜åŠ¿</h3>
          <ul>
            <li>API éå¸¸å‹å¥½</li>
            <li>åŠŸèƒ½å¼ºå¤§å®Œæ•´</li>
            <li>æ–‡æ¡£è¯¦å°½</li>
            <li>ç¤¾åŒºæ´»è·ƒ</li>
          </ul>
        </div>

        <div class="info-section">
          <h3>âš ï¸ åŠ£åŠ¿</h3>
          <ul>
            <li>æ–‡ä»¶ä½“ç§¯è¾ƒå¤§</li>
            <li>é¦–æ¬¡åŠ è½½æ…¢</li>
            <li>ä¸­æ–‡å­—ä½“éœ€é…ç½®</li>
          </ul>
        </div>
      </aside>

      <main class="demo-panel">
        <!-- åŸºç¡€åŠŸèƒ½æ¼”ç¤º -->
        <div class="examples-section">
          <h2 class="section-title">ğŸ“š åŸºç¡€åŠŸèƒ½æ¼”ç¤º</h2>

          <div class="example-tabs">
            <button
              v-for="(example, index) in examples"
              :key="index"
              :class="['tab-button', { active: currentExample === index }]"
              @click="currentExample = index"
            >
              {{ example }}
            </button>
          </div>

          <div class="example-content">
            <!-- ç¤ºä¾‹1: åˆ›å»ºåŸºç¡€æ–‡æ¡£ -->
            <div v-if="currentExample === 0">
              <h3>ç¤ºä¾‹ 1: åˆ›å»ºåŸºç¡€æ–‡æ¡£</h3>
              <p>ä½¿ç”¨pdfmakeçš„å£°æ˜å¼APIåˆ›å»ºç®€å•çš„PDFæ–‡æ¡£ï¼ŒåŒ…å«æ–‡æœ¬å’ŒåŸºç¡€æ ·å¼ã€‚</p>

              <div class="controls">
                <button @click="example1Generate" class="btn btn-primary" :disabled="loading">
                  {{ loading ? 'â³ ç”Ÿæˆä¸­...' : 'ğŸ“„ ç”ŸæˆåŸºç¡€PDF' }}
                </button>
              </div>

              <div class="code-display">
                <h4>ä»£ç ç¤ºä¾‹:</h4>
                <pre v-pre><code>import pdfMake from 'pdfmake/build/pdfmake'

const docDefinition = {
  content: [
    'Hello World!',
    'è¿™æ˜¯ä½¿ç”¨ pdfmake ç”Ÿæˆçš„ PDF æ–‡æ¡£',
    'ç”Ÿæˆæ—¶é—´: ' + new Date().toLocaleDateString('zh-CN')
  ]
}

pdfMake.createPdf(docDefinition).download('basic.pdf')</code></pre>
              </div>

              <div class="demo-content">
                <div class="preview-box">
                  <p><strong>é¢„è§ˆå†…å®¹:</strong></p>
                  <p>Hello World!</p>
                  <p>è¿™æ˜¯ä½¿ç”¨ pdfmake ç”Ÿæˆçš„ PDF æ–‡æ¡£</p>
                  <p>ç”Ÿæˆæ—¶é—´: {{ currentDate }}</p>
                </div>
              </div>
            </div>

            <!-- ç¤ºä¾‹2: æ–‡æœ¬æ ·å¼ -->
            <div v-else-if="currentExample === 1">
              <h3>ç¤ºä¾‹ 2: æ–‡æœ¬æ ·å¼</h3>
              <p>ä½¿ç”¨styleså®šä¹‰å¯å¤ç”¨çš„æ ·å¼ï¼Œå¹¶åº”ç”¨åˆ°ä¸åŒçš„æ–‡æœ¬å…ƒç´ ä¸Šã€‚</p>

              <div class="controls">
                <button @click="example2Generate" class="btn btn-primary" :disabled="loading">
                  {{ loading ? 'â³ ç”Ÿæˆä¸­...' : 'ğŸ¨ ç”Ÿæˆæ ·å¼PDF' }}
                </button>
              </div>

              <div class="code-display">
                <h4>ä»£ç ç¤ºä¾‹:</h4>
                <pre v-pre><code>const docDefinition = {
  content: [
    { text: 'æ ‡é¢˜æ–‡æœ¬', style: 'header' },
    { text: 'å‰¯æ ‡é¢˜', style: 'subheader' },
    { text: 'æ™®é€šæ­£æ–‡å†…å®¹', fontSize: 12 },
    { text: 'åŠ ç²—æ–‡æœ¬', bold: true },
    { text: 'æ–œä½“æ–‡æœ¬', italics: true },
    { text: 'å½©è‰²æ–‡æœ¬', color: '#667eea' },
    { text: 'å¸¦èƒŒæ™¯è‰²çš„æ–‡æœ¬', background: '#fef3c7' }
  ],
  styles: {
    header: { fontSize: 22, bold: true, color: '#667eea' },
    subheader: { fontSize: 16, bold: true, margin: [0, 10, 0, 5] }
  }
}</code></pre>
              </div>

              <div class="demo-content">
                <div class="preview-box">
                  <p style="font-size: 1.5rem; font-weight: bold; color: #667eea">æ ‡é¢˜æ–‡æœ¬</p>
                  <p style="font-size: 1.2rem; font-weight: bold">å‰¯æ ‡é¢˜</p>
                  <p>æ™®é€šæ­£æ–‡å†…å®¹</p>
                  <p style="font-weight: bold">åŠ ç²—æ–‡æœ¬</p>
                  <p style="font-style: italic">æ–œä½“æ–‡æœ¬</p>
                  <p style="color: #667eea">å½©è‰²æ–‡æœ¬</p>
                  <p style="background: #fef3c7; display: inline-block; padding: 0.25rem">
                    å¸¦èƒŒæ™¯è‰²çš„æ–‡æœ¬
                  </p>
                </div>
              </div>
            </div>

            <!-- ç¤ºä¾‹3: åˆ—è¡¨ -->
            <div v-else-if="currentExample === 2">
              <h3>ç¤ºä¾‹ 3: åˆ—è¡¨</h3>
              <p>pdfmakeæ”¯æŒæœ‰åºåˆ—è¡¨(ol)å’Œæ— åºåˆ—è¡¨(ul)ï¼Œå¯ä»¥åµŒå¥—ä½¿ç”¨ã€‚</p>

              <div class="controls">
                <button @click="example3Generate" class="btn btn-primary" :disabled="loading">
                  {{ loading ? 'â³ ç”Ÿæˆä¸­...' : 'ğŸ“‹ ç”Ÿæˆåˆ—è¡¨PDF' }}
                </button>
              </div>

              <div class="code-display">
                <h4>ä»£ç ç¤ºä¾‹:</h4>
                <pre v-pre><code>const docDefinition = {
  content: [
    { text: 'æ— åºåˆ—è¡¨', style: 'header' },
    {
      ul: [
        'ç¬¬ä¸€é¡¹',
        'ç¬¬äºŒé¡¹',
        'ç¬¬ä¸‰é¡¹'
      ]
    },
    { text: 'æœ‰åºåˆ—è¡¨', style: 'header', margin: [0, 15, 0, 5] },
    {
      ol: [
        'æ­¥éª¤ä¸€',
        'æ­¥éª¤äºŒ',
        'æ­¥éª¤ä¸‰'
      ]
    }
  ]
}</code></pre>
              </div>

              <div class="demo-content">
                <div class="preview-box">
                  <p style="font-weight: bold; margin-bottom: 0.5rem">æ— åºåˆ—è¡¨</p>
                  <ul style="margin-left: 1.5rem">
                    <li>ç¬¬ä¸€é¡¹</li>
                    <li>ç¬¬äºŒé¡¹</li>
                    <li>ç¬¬ä¸‰é¡¹</li>
                  </ul>
                  <p style="font-weight: bold; margin: 1rem 0 0.5rem 0">æœ‰åºåˆ—è¡¨</p>
                  <ol style="margin-left: 1.5rem">
                    <li>æ­¥éª¤ä¸€</li>
                    <li>æ­¥éª¤äºŒ</li>
                    <li>æ­¥éª¤ä¸‰</li>
                  </ol>
                </div>
              </div>
            </div>

            <!-- ç¤ºä¾‹4: å¤šåˆ—å¸ƒå±€ -->
            <div v-else-if="currentExample === 3">
              <h3>ç¤ºä¾‹ 4: å¤šåˆ—å¸ƒå±€</h3>
              <p>ä½¿ç”¨columnsåˆ›å»ºå¤šåˆ—å¸ƒå±€ï¼Œæ”¯æŒçµæ´»çš„å®½åº¦è®¾ç½®ã€‚</p>

              <div class="controls">
                <button @click="example4Generate" class="btn btn-primary" :disabled="loading">
                  {{ loading ? 'â³ ç”Ÿæˆä¸­...' : 'ğŸ“ ç”Ÿæˆå¤šåˆ—PDF' }}
                </button>
              </div>

              <div class="code-display">
                <h4>ä»£ç ç¤ºä¾‹:</h4>
                <pre v-pre><code>const docDefinition = {
  content: [
    { text: 'ä¸¤åˆ—å¸ƒå±€', style: 'header' },
    {
      columns: [
        { width: '50%', text: 'å·¦ä¾§åˆ—å†…å®¹\nè¿™æ˜¯å·¦ä¾§çš„å†…å®¹åŒºåŸŸ' },
        { width: '50%', text: 'å³ä¾§åˆ—å†…å®¹\nè¿™æ˜¯å³ä¾§çš„å†…å®¹åŒºåŸŸ' }
      ]
    },
    { text: 'ä¸‰åˆ—å¸ƒå±€', style: 'header', margin: [0, 20, 0, 5] },
    {
      columns: [
        { width: '*', text: 'åˆ—1' },
        { width: '*', text: 'åˆ—2' },
        { width: '*', text: 'åˆ—3' }
      ],
      columnGap: 10
    }
  ]
}</code></pre>
              </div>

              <div class="demo-content">
                <div class="preview-box">
                  <p style="font-weight: bold; margin-bottom: 0.5rem">ä¸¤åˆ—å¸ƒå±€</p>
                  <div style="display: flex; gap: 1rem; margin-bottom: 1rem">
                    <div style="flex: 1; background: #f7fafc; padding: 0.75rem; border-radius: 4px">
                      <p>å·¦ä¾§åˆ—å†…å®¹</p>
                      <p>è¿™æ˜¯å·¦ä¾§çš„å†…å®¹åŒºåŸŸ</p>
                    </div>
                    <div style="flex: 1; background: #f7fafc; padding: 0.75rem; border-radius: 4px">
                      <p>å³ä¾§åˆ—å†…å®¹</p>
                      <p>è¿™æ˜¯å³ä¾§çš„å†…å®¹åŒºåŸŸ</p>
                    </div>
                  </div>
                  <p style="font-weight: bold; margin-bottom: 0.5rem">ä¸‰åˆ—å¸ƒå±€</p>
                  <div style="display: flex; gap: 0.5rem">
                    <div
                      style="
                        flex: 1;
                        background: #e2e8f0;
                        padding: 0.5rem;
                        text-align: center;
                        border-radius: 4px;
                      "
                    >
                      åˆ—1
                    </div>
                    <div
                      style="
                        flex: 1;
                        background: #e2e8f0;
                        padding: 0.5rem;
                        text-align: center;
                        border-radius: 4px;
                      "
                    >
                      åˆ—2
                    </div>
                    <div
                      style="
                        flex: 1;
                        background: #e2e8f0;
                        padding: 0.5rem;
                        text-align: center;
                        border-radius: 4px;
                      "
                    >
                      åˆ—3
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- ç¤ºä¾‹5: é¡µçœ‰é¡µè„š -->
            <div v-else-if="currentExample === 4">
              <h3>ç¤ºä¾‹ 5: é¡µçœ‰å’Œé¡µè„š</h3>
              <p>ä¸ºæ¯ä¸€é¡µæ·»åŠ é¡µçœ‰å’Œé¡µè„šï¼Œæ”¯æŒåŠ¨æ€é¡µç æ˜¾ç¤ºã€‚</p>

              <div class="controls">
                <button @click="example5Generate" class="btn btn-primary" :disabled="loading">
                  {{ loading ? 'â³ ç”Ÿæˆä¸­...' : 'ğŸ“„ ç”Ÿæˆå¸¦é¡µçœ‰é¡µè„šPDF' }}
                </button>
              </div>

              <div class="code-display">
                <h4>ä»£ç ç¤ºä¾‹:</h4>
                <pre v-pre><code>const docDefinition = {
  header: {
    text: 'å…¬å¸æœºå¯†æ–‡ä»¶',
    alignment: 'center',
    margin: [0, 10, 0, 0]
  },
  footer: (currentPage, pageCount) => ({
    text: `ç¬¬ ${currentPage} / ${pageCount} é¡µ`,
    alignment: 'center',
    margin: [0, 0, 0, 10]
  }),
  content: [
    { text: 'æ–‡æ¡£å†…å®¹', style: 'header' },
    { text: 'è¿™æ˜¯æ–‡æ¡£çš„ä¸»ä½“å†…å®¹...' }
  ]
}</code></pre>
              </div>

              <div class="demo-content">
                <div class="preview-box" style="position: relative">
                  <div style="border: 1px solid #e2e8f0; padding: 1rem">
                    <p
                      style="
                        text-align: center;
                        color: #718096;
                        font-size: 0.9rem;
                        border-bottom: 1px solid #e2e8f0;
                        padding-bottom: 0.5rem;
                      "
                    >
                      å…¬å¸æœºå¯†æ–‡ä»¶
                    </p>
                    <div style="min-height: 100px; padding: 1rem 0">
                      <p style="font-weight: bold">æ–‡æ¡£å†…å®¹</p>
                      <p>è¿™æ˜¯æ–‡æ¡£çš„ä¸»ä½“å†…å®¹...</p>
                    </div>
                    <p
                      style="
                        text-align: center;
                        color: #718096;
                        font-size: 0.9rem;
                        border-top: 1px solid #e2e8f0;
                        padding-top: 0.5rem;
                      "
                    >
                      ç¬¬ 1 / 1 é¡µ
                    </p>
                  </div>
                </div>
              </div>
            </div>

            <!-- ç¤ºä¾‹6: åˆ†é¡µæ§åˆ¶ -->
            <div v-else-if="currentExample === 5">
              <h3>ç¤ºä¾‹ 6: åˆ†é¡µæ§åˆ¶</h3>
              <p>ä½¿ç”¨pageBreakæ§åˆ¶å¼ºåˆ¶åˆ†é¡µï¼Œæˆ–pageBreakBeforeè¿›è¡Œæ¡ä»¶åˆ†é¡µã€‚</p>

              <div class="controls">
                <button @click="example6Generate" class="btn btn-primary" :disabled="loading">
                  {{ loading ? 'â³ ç”Ÿæˆä¸­...' : 'ğŸ“‘ ç”Ÿæˆå¤šé¡µPDF' }}
                </button>
              </div>

              <div class="code-display">
                <h4>ä»£ç ç¤ºä¾‹:</h4>
                <pre v-pre><code>const docDefinition = {
  content: [
    { text: 'ç¬¬ä¸€é¡µå†…å®¹', style: 'header' },
    { text: 'è¿™æ˜¯ç¬¬ä¸€é¡µçš„å†…å®¹...' },
    { text: 'ç¬¬äºŒé¡µå†…å®¹', style: 'header', pageBreak: 'before' },
    { text: 'è¿™æ˜¯ç¬¬äºŒé¡µçš„å†…å®¹...' },
    { text: 'ç¬¬ä¸‰é¡µå†…å®¹', style: 'header', pageBreak: 'before' },
    { text: 'è¿™æ˜¯ç¬¬ä¸‰é¡µçš„å†…å®¹...' }
  ]
}</code></pre>
              </div>

              <div class="demo-content">
                <div class="preview-box">
                  <div style="display: flex; gap: 0.5rem; flex-wrap: wrap">
                    <div
                      style="
                        width: 120px;
                        border: 1px solid #e2e8f0;
                        padding: 0.5rem;
                        border-radius: 4px;
                      "
                    >
                      <p style="font-size: 0.8rem; font-weight: bold">ç¬¬ä¸€é¡µ</p>
                      <p style="font-size: 0.75rem; color: #718096">ç¬¬ä¸€é¡µå†…å®¹...</p>
                    </div>
                    <div
                      style="
                        width: 120px;
                        border: 1px solid #e2e8f0;
                        padding: 0.5rem;
                        border-radius: 4px;
                      "
                    >
                      <p style="font-size: 0.8rem; font-weight: bold">ç¬¬äºŒé¡µ</p>
                      <p style="font-size: 0.75rem; color: #718096">ç¬¬äºŒé¡µå†…å®¹...</p>
                    </div>
                    <div
                      style="
                        width: 120px;
                        border: 1px solid #e2e8f0;
                        padding: 0.5rem;
                        border-radius: 4px;
                      "
                    >
                      <p style="font-size: 0.8rem; font-weight: bold">ç¬¬ä¸‰é¡µ</p>
                      <p style="font-size: 0.75rem; color: #718096">ç¬¬ä¸‰é¡µå†…å®¹...</p>
                    </div>
                  </div>
                  <p class="note">pageBreak: 'before' ä¼šåœ¨å…ƒç´ å‰å¼ºåˆ¶åˆ†é¡µ</p>
                </div>
              </div>
            </div>

            <!-- ç¤ºä¾‹7: EChartså›¾è¡¨ -->
            <div v-else-if="currentExample === 6">
              <h3>ç¤ºä¾‹ 7: EChartså›¾è¡¨é›†æˆ</h3>
              <p>
                <strong>âœ¨ pdfmakeä¼˜åŠ¿ï¼š</strong
                >åˆ©ç”¨<strong>å£°æ˜å¼å¸ƒå±€</strong>å’Œ<strong>columnsè‡ªåŠ¨å¯¹é½</strong>ï¼Œè½»æ¾å®ç°å›¾è¡¨çš„å“åº”å¼æ’ç‰ˆã€‚
              </p>

              <div class="controls">
                <button @click="example7Generate" class="btn btn-primary" :disabled="loading">
                  {{ loading ? 'â³ ç”Ÿæˆä¸­...' : 'ğŸ“Š ç”Ÿæˆå›¾è¡¨PDF' }}
                </button>
              </div>

              <div class="demo-content">
                <div
                  style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin: 15px 0"
                >
                  <div ref="pdfmakePieRef" style="height: 200px; border: 1px solid #e2e8f0"></div>
                  <div ref="pdfmakeBarRef" style="height: 200px; border: 1px solid #e2e8f0"></div>
                </div>
                <p class="note">pdfmakeç”¨columnsæ•°ç»„å®ç°å›¾è¡¨å¹¶æ’ï¼Œæ— éœ€æ‰‹åŠ¨è®¡ç®—åæ ‡</p>
              </div>
            </div>
          </div>
        </div>

        <!-- é«˜çº§åŠŸèƒ½æ¼”ç¤º -->
        <div class="advanced-section">
          <h2 class="section-title">ğŸš€ é«˜çº§åŠŸèƒ½æ¼”ç¤º</h2>

          <div class="example-tabs">
            <button
              v-for="(example, index) in advancedExamples"
              :key="index"
              :class="['tab-button', { active: currentAdvanced === index }]"
              @click="currentAdvanced = index"
            >
              {{ example }}
            </button>
          </div>

          <div class="example-content">
            <!-- é«˜çº§1: è¡¨æ ¼ -->
            <div v-if="currentAdvanced === 0">
              <h3>é«˜çº§ 1: è¡¨æ ¼ç”Ÿæˆ</h3>
              <p>pdfmakeçš„è¡¨æ ¼åŠŸèƒ½éå¸¸å¼ºå¤§ï¼Œæ”¯æŒè¡¨å¤´ã€åˆå¹¶å•å…ƒæ ¼ã€è¾¹æ¡†æ ·å¼ç­‰ã€‚</p>

              <div class="controls">
                <button @click="advanced1Generate" class="btn btn-primary" :disabled="loading">
                  {{ loading ? 'â³ ç”Ÿæˆä¸­...' : 'ğŸ“Š ç”Ÿæˆè¡¨æ ¼PDF' }}
                </button>
              </div>

              <div class="code-display">
                <h4>ä»£ç ç¤ºä¾‹:</h4>
                <pre v-pre><code>const docDefinition = {
  content: [
    {
      table: {
        headerRows: 1,
        widths: ['*', 'auto', 100, '*'],
        body: [
          [
            { text: 'å§“å', style: 'tableHeader' },
            { text: 'éƒ¨é—¨', style: 'tableHeader' },
            { text: 'èŒä½', style: 'tableHeader' },
            { text: 'å·¥èµ„', style: 'tableHeader' }
          ],
          ['å¼ ä¸‰', 'æŠ€æœ¯éƒ¨', 'å‰ç«¯å·¥ç¨‹å¸ˆ', 'Â¥15,000'],
          ['æå››', 'äº§å“éƒ¨', 'äº§å“ç»ç†', 'Â¥18,000']
        ]
      },
      layout: 'lightHorizontalLines'
    }
  ]
}</code></pre>
              </div>

              <div class="demo-content">
                <h4>ğŸ“‹ è¡¨æ ¼æ•°æ®é¢„è§ˆ:</h4>
                <table class="data-table">
                  <thead>
                    <tr>
                      <th>å§“å</th>
                      <th>éƒ¨é—¨</th>
                      <th>èŒä½</th>
                      <th>å·¥èµ„</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr v-for="i in 5" :key="i">
                      <td>å‘˜å·¥{{ i }}</td>
                      <td>{{ ['æŠ€æœ¯éƒ¨', 'äº§å“éƒ¨', 'è®¾è®¡éƒ¨', 'è¿è¥éƒ¨', 'å¸‚åœºéƒ¨'][i - 1] }}</td>
                      <td>{{ ['å·¥ç¨‹å¸ˆ', 'äº§å“ç»ç†', 'è®¾è®¡å¸ˆ', 'è¿è¥ä¸“å‘˜', 'å¸‚åœºä¸“å‘˜'][i - 1] }}</td>
                      <td>Â¥{{ (12000 + i * 1000).toLocaleString() }}</td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>

            <!-- é«˜çº§2: å›¾ç‰‡åµŒå…¥ -->
            <div v-else-if="currentAdvanced === 1">
              <h3>é«˜çº§ 2: å›¾ç‰‡åµŒå…¥</h3>
              <p>æ”¯æŒBase64å›¾ç‰‡ã€URLå›¾ç‰‡å’ŒSVGå›¾ç‰‡çš„åµŒå…¥ï¼Œå¯ä»¥æ§åˆ¶å°ºå¯¸å’Œå¯¹é½æ–¹å¼ã€‚</p>

              <div class="controls">
                <button @click="advanced2Generate" class="btn btn-primary" :disabled="loading">
                  {{ loading ? 'â³ ç”Ÿæˆä¸­...' : 'ğŸ–¼ï¸ ç”Ÿæˆå›¾ç‰‡PDF' }}
                </button>
              </div>

              <div class="code-display">
                <h4>ä»£ç ç¤ºä¾‹:</h4>
                <pre v-pre><code>const docDefinition = {
  content: [
    { text: 'PDFä¸­çš„å›¾ç‰‡', style: 'header' },
    {
      image: 'data:image/png;base64,...',
      width: 200,
      height: 150
    },
    // æˆ–è€…ä½¿ç”¨å›¾ç‰‡å¯¹é½
    {
      image: 'data:image/png;base64,...',
      width: 150,
      alignment: 'center'
    },
    // åœ†è§’å›¾ç‰‡æ•ˆæœ (ä½¿ç”¨SVG)
    {
      svg: '&lt;svg&gt;...&lt;/svg&gt;',
      width: 100
    }
  ]
}</code></pre>
              </div>

              <div class="demo-content">
                <div class="preview-box">
                  <p><strong>å›¾ç‰‡é¢„è§ˆ:</strong></p>
                  <div style="display: flex; gap: 1rem; flex-wrap: wrap; align-items: center">
                    <div
                      style="
                        width: 150px;
                        height: 100px;
                        background: linear-gradient(135deg, #667eea, #764ba2);
                        border-radius: 8px;
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        color: white;
                      "
                    >
                      ç¤ºä¾‹å›¾ç‰‡
                    </div>
                    <p class="note">å®é™…PDFä¸­ä¼šåµŒå…¥Base64æ ¼å¼çš„å›¾ç‰‡æ•°æ®</p>
                  </div>
                </div>
              </div>
            </div>

            <!-- é«˜çº§3: æ°´å°å’ŒèƒŒæ™¯ -->
            <div v-else-if="currentAdvanced === 2">
              <h3>é«˜çº§ 3: æ°´å°å’ŒèƒŒæ™¯</h3>
              <p>ä¸ºæ•´ä¸ªæ–‡æ¡£æ·»åŠ èƒŒæ™¯æ°´å°ï¼Œæ”¯æŒæ–‡å­—æ°´å°å’Œå›¾ç‰‡æ°´å°ã€‚</p>

              <div class="controls">
                <button @click="advanced3Generate" class="btn btn-primary" :disabled="loading">
                  {{ loading ? 'â³ ç”Ÿæˆä¸­...' : 'ğŸ’§ ç”Ÿæˆå¸¦æ°´å°PDF' }}
                </button>
              </div>

              <div class="code-display">
                <h4>ä»£ç ç¤ºä¾‹:</h4>
                <pre v-pre><code>const docDefinition = {
  background: (currentPage, pageSize) => ({
    text: 'æœºå¯†æ–‡ä»¶',
    color: '#cccccc',
    opacity: 0.3,
    bold: true,
    fontSize: 60,
    alignment: 'center',
    margin: [0, pageSize.height / 2 - 30]
  }),
  content: [
    { text: 'å¸¦æ°´å°çš„æ–‡æ¡£', style: 'header' },
    { text: 'è¿™æ˜¯æ–‡æ¡£å†…å®¹...' }
  ]
}</code></pre>
              </div>

              <div class="demo-content">
                <div class="preview-box" style="position: relative; min-height: 150px">
                  <div
                    style="
                      position: absolute;
                      top: 50%;
                      left: 50%;
                      transform: translate(-50%, -50%) rotate(-30deg);
                      font-size: 2.5rem;
                      color: rgba(200, 200, 200, 0.4);
                      pointer-events: none;
                      white-space: nowrap;
                    "
                  >
                    æœºå¯†æ–‡ä»¶
                  </div>
                  <p style="position: relative; z-index: 1"><strong>å¸¦æ°´å°çš„æ–‡æ¡£</strong></p>
                  <p style="position: relative; z-index: 1">è¿™æ˜¯æ–‡æ¡£å†…å®¹ï¼Œæ°´å°æ˜¾ç¤ºåœ¨èƒŒæ™¯ä¸­...</p>
                </div>
              </div>
            </div>

            <!-- é«˜çº§4: å¤æ‚è¡¨æ ¼ -->
            <div v-else-if="currentAdvanced === 3">
              <h3>é«˜çº§ 4: å¤æ‚è¡¨æ ¼å¸ƒå±€</h3>
              <p>æ”¯æŒå•å…ƒæ ¼åˆå¹¶ã€åµŒå¥—è¡¨æ ¼ã€è‡ªå®šä¹‰è¾¹æ¡†ç­‰é«˜çº§è¡¨æ ¼åŠŸèƒ½ã€‚</p>

              <div class="controls">
                <button @click="advanced4Generate" class="btn btn-primary" :disabled="loading">
                  {{ loading ? 'â³ ç”Ÿæˆä¸­...' : 'ğŸ“‹ ç”Ÿæˆå¤æ‚è¡¨æ ¼PDF' }}
                </button>
              </div>

              <div class="code-display">
                <h4>ä»£ç ç¤ºä¾‹:</h4>
                <pre v-pre><code>const docDefinition = {
  content: [
    {
      table: {
        body: [
          // åˆå¹¶åˆ—
          [{ text: 'åˆå¹¶ä¸¤åˆ—', colSpan: 2 }, {}, 'ç¬¬ä¸‰åˆ—'],
          // åˆå¹¶è¡Œ
          [{ text: 'åˆå¹¶ä¸¤è¡Œ', rowSpan: 2 }, 'B1', 'C1'],
          [{}, 'B2', 'C2']
        ]
      }
    }
  ]
}</code></pre>
              </div>

              <div class="demo-content">
                <div class="preview-box">
                  <table class="data-table" style="width: 100%">
                    <tr>
                      <td colspan="2" style="text-align: center; background: #f0f0f0">åˆå¹¶ä¸¤åˆ—</td>
                      <td>ç¬¬ä¸‰åˆ—</td>
                    </tr>
                    <tr>
                      <td rowspan="2" style="text-align: center; background: #f0f0f0">åˆå¹¶ä¸¤è¡Œ</td>
                      <td>B1</td>
                      <td>C1</td>
                    </tr>
                    <tr>
                      <td>B2</td>
                      <td>C2</td>
                    </tr>
                  </table>
                </div>
              </div>
            </div>

            <!-- é«˜çº§5: é“¾æ¥å’Œä¹¦ç­¾ -->
            <div v-else-if="currentAdvanced === 4">
              <h3>é«˜çº§ 5: é“¾æ¥å’Œç›®å½•</h3>
              <p>æ·»åŠ å¯ç‚¹å‡»çš„è¶…é“¾æ¥å’Œæ–‡æ¡£å†…éƒ¨è·³è½¬é“¾æ¥ï¼Œæ”¯æŒè‡ªåŠ¨ç”Ÿæˆç›®å½•ã€‚</p>

              <div class="controls">
                <button @click="advanced5Generate" class="btn btn-primary" :disabled="loading">
                  {{ loading ? 'â³ ç”Ÿæˆä¸­...' : 'ğŸ”— ç”Ÿæˆå¸¦é“¾æ¥PDF' }}
                </button>
              </div>

              <div class="code-display">
                <h4>ä»£ç ç¤ºä¾‹:</h4>
                <pre v-pre><code>const docDefinition = {
  content: [
    // å¤–éƒ¨é“¾æ¥
    {
      text: 'è®¿é—® pdfmake å®˜ç½‘',
      link: 'https://pdfmake.github.io/docs/',
      color: 'blue',
      decoration: 'underline'
    },
    // å†…éƒ¨é“¾æ¥ (è·³è½¬åˆ°é”šç‚¹)
    {
      text: 'è·³è½¬åˆ°ç¬¬äºŒç« ',
      linkToDestination: 'chapter2'
    },
    // å®šä¹‰é”šç‚¹
    { text: 'ç¬¬äºŒç« ', id: 'chapter2', pageBreak: 'before' }
  ]
}</code></pre>
              </div>

              <div class="demo-content">
                <div class="preview-box">
                  <p>
                    <a
                      href="https://pdfmake.github.io/docs/"
                      target="_blank"
                      rel="noopener noreferrer"
                      style="color: #667eea; text-decoration: underline"
                      >è®¿é—® pdfmake å®˜ç½‘</a
                    >
                    (å¤–éƒ¨é“¾æ¥)
                  </p>
                  <p>
                    <a href="#" style="color: #667eea; text-decoration: underline">è·³è½¬åˆ°ç¬¬äºŒç« </a>
                    (å†…éƒ¨é“¾æ¥)
                  </p>
                  <p class="note">PDFä¸­çš„é“¾æ¥å¯ä»¥ç‚¹å‡»è·³è½¬</p>
                </div>
              </div>
            </div>

            <!-- é«˜çº§6: å®Œæ•´æŠ¥å‘Š -->
            <div v-else-if="currentAdvanced === 5">
              <h3>é«˜çº§ 6: å®Œæ•´æŠ¥å‘Šç”Ÿæˆ</h3>
              <p>ç»¼åˆè¿ç”¨æ‰€æœ‰åŠŸèƒ½ï¼Œç”ŸæˆåŒ…å«å°é¢ã€ç›®å½•ã€æ­£æ–‡ã€è¡¨æ ¼çš„å®Œæ•´æŠ¥å‘Šã€‚</p>

              <div class="controls">
                <button @click="advanced6Generate" class="btn btn-primary" :disabled="loading">
                  {{ loading ? 'â³ ç”Ÿæˆä¸­...' : 'ğŸ“ˆ ç”Ÿæˆå®Œæ•´æŠ¥å‘Š' }}
                </button>
              </div>

              <div class="code-display">
                <h4>ä»£ç ç¤ºä¾‹:</h4>
                <pre v-pre><code>const docDefinition = {
  info: {
    title: 'å¹´åº¦æŠ¥å‘Š',
    author: 'å…¬å¸åç§°',
    subject: '2024å¹´åº¦å·¥ä½œæ€»ç»“'
  },
  header: (currentPage, pageCount) =&gt; ({...}),
  footer: (currentPage, pageCount) =&gt; ({...}),
  content: [
    // å°é¢
    { text: '2024å¹´åº¦æŠ¥å‘Š', style: 'title' },
    // ç›®å½•
    { toc: { title: { text: 'ç›®å½•', style: 'header' } } },
    // æ­£æ–‡ç« èŠ‚
    { text: 'ç¬¬ä¸€ç«  æ¦‚è¿°', style: 'header', tocItem: true },
    // æ•°æ®è¡¨æ ¼
    { table: {...} },
    // å›¾è¡¨åŒºåŸŸ
    { image: '...' }
  ]
}</code></pre>
              </div>

              <div class="demo-content">
                <div class="preview-box">
                  <p
                    style="font-size: 1.5rem; font-weight: bold; text-align: center; color: #667eea"
                  >
                    2024å¹´åº¦æŠ¥å‘Š
                  </p>
                  <div
                    style="margin-top: 1rem; padding: 1rem; background: #f7fafc; border-radius: 4px"
                  >
                    <p style="font-weight: bold">ç›®å½•</p>
                    <p>1. æ¦‚è¿° ................ 2</p>
                    <p>2. ä¸šç»©æ€»ç»“ ............ 3</p>
                    <p>3. æ•°æ®åˆ†æ ............ 5</p>
                    <p>4. æœªæ¥è§„åˆ’ ............ 8</p>
                  </div>
                  <p class="note">å®Œæ•´æŠ¥å‘ŠåŒ…å«ï¼šå°é¢ã€ç›®å½•ã€æ­£æ–‡ã€è¡¨æ ¼ã€å›¾è¡¨ç­‰</p>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- ä¿ç•™åŸæœ‰å¿«æ·æŒ‰é’® -->
        <div class="divider"></div>

        <div class="controls">
          <button @click="generateSimplePDF" class="btn btn-primary" :disabled="loading">
            {{ loading ? 'â³ ç”Ÿæˆä¸­...' : 'ğŸ“„ ç”Ÿæˆç®€å•PDF' }}
          </button>
          <button @click="generateTablePDF" class="btn btn-secondary" :disabled="loading">
            {{ loading ? 'â³ ç”Ÿæˆä¸­...' : 'ğŸ“Š ç”Ÿæˆè¡¨æ ¼PDF' }}
          </button>
          <button @click="generateComplexPDF" class="btn btn-info" :disabled="loading">
            {{ loading ? 'â³ ç”Ÿæˆä¸­...' : 'ğŸ“‘ ç”Ÿæˆå¤æ‚æ–‡æ¡£' }}
          </button>
          <button @click="generateReportPDF" class="btn btn-warning" :disabled="loading">
            {{ loading ? 'â³ ç”Ÿæˆä¸­...' : 'ğŸ“ˆ ç”Ÿæˆå®Œæ•´æŠ¥å‘Š' }}
          </button>
        </div>

        <div
          v-if="statusMessage"
          class="status-message"
          :class="{ error: statusMessage.includes('âŒ') }"
        >
          {{ statusMessage }}
        </div>

        <div class="preview-hint">
          <p>ğŸ’¡ ç‚¹å‡»æŒ‰é’®ç”Ÿæˆå¹¶ä¸‹è½½ä¸­æ–‡ PDF æ–‡æ¡£</p>
          <p v-if="!fontsReady" class="loading-fonts">â³ æ­£åœ¨åˆå§‹åŒ–ä¸­æ–‡å­—ä½“...</p>
          <p v-else class="fonts-ready">âœ… ä¸­æ–‡å­—ä½“å·²å°±ç»ª</p>
        </div>

        <div class="code-examples">
          <h3>ğŸ’» ä»£ç ç¤ºä¾‹</h3>

          <div class="code-block">
            <h4>1. å®‰è£…å’Œå¯¼å…¥</h4>
            <pre><code>npm install pdfmake

import pdfMake from 'pdfmake/build/pdfmake';
import pdfFonts from 'pdfmake/build/vfs_fonts';
pdfMake.vfs = pdfFonts.pdfMake.vfs;</code></pre>
          </div>

          <div class="code-block">
            <h4>2. åŸºç¡€æ–‡æ¡£</h4>
            <pre><code>const docDefinition = {
  content: [
    'First paragraph',
    'Second paragraph'
  ]
};

pdfMake.createPdf(docDefinition).download('document.pdf');
// æˆ–åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€
pdfMake.createPdf(docDefinition).open();</code></pre>
          </div>

          <div class="code-block">
            <h4>3. æ–‡æœ¬æ ·å¼</h4>
            <pre><code>const docDefinition = {
  content: [
    { text: 'æ ‡é¢˜', style: 'header' },
    { text: 'å‰¯æ ‡é¢˜', style: 'subheader' },
    { text: 'æ­£æ–‡å†…å®¹', fontSize: 12 },
    { text: 'åŠ ç²—æ–‡æœ¬', bold: true },
    { text: 'æ–œä½“æ–‡æœ¬', italics: true }
  ],
  styles: {
    header: {
      fontSize: 22,
      bold: true,
      margin: [0, 0, 0, 10]
    },
    subheader: {
      fontSize: 16,
      bold: true,
      margin: [0, 10, 0, 5]
    }
  }
};</code></pre>
          </div>

          <div class="code-block">
            <h4>4. è¡¨æ ¼ç”Ÿæˆ</h4>
            <pre><code>const docDefinition = {
  content: [
    {
      table: {
        headerRows: 1,
        widths: ['*', 'auto', 100, '*'],
        body: [
          ['Header 1', 'Header 2', 'Header 3', 'Header 4'],
          ['Row 1, Cell 1', 'Row 1, Cell 2', 'Row 1, Cell 3', 'Row 1, Cell 4'],
          ['Row 2, Cell 1', 'Row 2, Cell 2', 'Row 2, Cell 3', 'Row 2, Cell 4']
        ]
      }
    }
  ]
};</code></pre>
          </div>

          <div class="code-block">
            <h4>5. åˆ—è¡¨æ ·å¼</h4>
            <pre><code>const docDefinition = {
  content: [
    // æ— åºåˆ—è¡¨
    {
      ul: [
        'Item 1',
        'Item 2',
        'Item 3'
      ]
    },
    // æœ‰åºåˆ—è¡¨
    {
      ol: [
        'First item',
        'Second item',
        'Third item'
      ]
    }
  ]
};</code></pre>
          </div>

          <div class="code-block">
            <h4>6. åˆ†é¡µæ§åˆ¶</h4>
            <pre><code>const docDefinition = {
  content: [
    { text: 'Page 1 content' },
    { text: 'Page 2 content', pageBreak: 'before' },
    { text: 'This stays on page 2', pageBreakBefore: (currentNode) => {
      return currentNode.headlineLevel === 1;
    }}
  ]
};</code></pre>
          </div>

          <div class="code-block">
            <h4>7. é¡µçœ‰å’Œé¡µè„š</h4>
            <pre><code>const docDefinition = {
  header: 'Simple header text',
  footer: (currentPage, pageCount) => {
    return {
      text: \`Page \${currentPage} of \${pageCount}\`,
      alignment: 'center'
    };
  },
  content: [
    'Content goes here'
  ]
};</code></pre>
          </div>

          <div class="code-block">
            <h4>8. å›¾ç‰‡åµŒå…¥</h4>
            <pre><code>const docDefinition = {
  content: [
    {
      image: 'data:image/jpeg;base64,...',
      width: 150,
      height: 150
    }
  ]
};</code></pre>
          </div>

          <div class="code-block">
            <h4>9. å¤šåˆ—å¸ƒå±€</h4>
            <pre><code>const docDefinition = {
  content: [
    {
      columns: [
        {
          width: '50%',
          text: 'Left column content'
        },
        {
          width: '50%',
          text: 'Right column content'
        }
      ]
    }
  ]
};</code></pre>
          </div>

          <div class="code-block">
            <h4>10. èƒŒæ™¯å’Œæ°´å°</h4>
            <pre><code>const docDefinition = {
  background: {
    text: 'WATERMARK',
    color: 'blue',
    opacity: 0.3,
    bold: true,
    fontSize: 60
  },
  content: [
    'Your content here'
  ]
};</code></pre>
          </div>
        </div>
      </main>
    </div>
  </div>
</template>

<script setup lang="ts">
import { ref, onMounted, watch, nextTick } from 'vue'
import pdfMake from 'pdfmake/build/pdfmake'
import { configurePdfMakeChinese, getChinesePdfMakeStyles } from '@/utils/fontLoader'
import * as echarts from 'echarts'
import type { ECharts } from 'echarts'

const loading = ref(false)
const statusMessage = ref('')
const fontsReady = ref(false)
const currentExample = ref(0)
const currentDate = ref(new Date().toLocaleDateString('zh-CN'))

// ECharts refs
const pdfmakePieRef = ref<HTMLDivElement>()
const pdfmakeBarRef = ref<HTMLDivElement>()
let pdfmakePieChart: ECharts | null = null
let pdfmakeBarChart: ECharts | null = null

// ç¤ºä¾‹æ ‡ç­¾
const examples = ['åŸºç¡€æ–‡æ¡£', 'æ–‡æœ¬æ ·å¼', 'åˆ—è¡¨', 'å¤šåˆ—å¸ƒå±€', 'é¡µçœ‰é¡µè„š', 'åˆ†é¡µæ§åˆ¶', 'EChartså›¾è¡¨']

// åœ¨ç»„ä»¶æŒ‚è½½æ—¶é…ç½®ä¸­æ–‡å­—ä½“
onMounted(async () => {
  try {
    await configurePdfMakeChinese()
    fontsReady.value = true
    console.log('âœ… pdfmake ä¸­æ–‡å­—ä½“é…ç½®å®Œæˆ')

    // åŠ è½½logoå›¾ç‰‡
    const response = await fetch('/imgs/logo.jpg')
    const blob = await response.blob()
    const reader = new FileReader()
    reader.onloadend = () => {
      sampleImage.value = reader.result as string
    }
    reader.readAsDataURL(blob)

    // EChartså›¾è¡¨ä¼šåœ¨ç”¨æˆ·åˆ‡æ¢åˆ°å¯¹åº”æ ‡ç­¾æ—¶åˆå§‹åŒ–
  } catch (error) {
    console.error('âŒ pdfmake å­—ä½“æˆ–å›¾ç‰‡é…ç½®å¤±è´¥:', error)
  }
})

// ç›‘å¬ç¤ºä¾‹åˆ‡æ¢ï¼Œå½“åˆ‡æ¢åˆ°EChartsç¤ºä¾‹æ—¶åˆå§‹åŒ–å›¾è¡¨
watch(currentExample, async (newVal) => {
  if (newVal === 6) {
    await nextTick()
    initPdfmakeCharts()
  }
})

// åˆå§‹åŒ–pdfmakeçš„ECharts
const initPdfmakeCharts = () => {
  if (pdfmakePieRef.value) {
    // å¦‚æœå›¾è¡¨å·²å­˜åœ¨ï¼Œå…ˆé”€æ¯
    if (pdfmakePieChart) {
      pdfmakePieChart.dispose()
      pdfmakePieChart = null
    }

    pdfmakePieChart = echarts.init(pdfmakePieRef.value)
    pdfmakePieChart.setOption({
      title: { text: 'é”€å”®å æ¯”', left: 'center', textStyle: { fontSize: 14 } },
      series: [
        {
          type: 'pie',
          radius: '65%',
          data: [
            { value: 335, name: 'äº§å“A' },
            { value: 310, name: 'äº§å“B' },
            { value: 234, name: 'äº§å“C' },
          ],
        },
      ],
    })
  }

  if (pdfmakeBarRef.value) {
    // å¦‚æœå›¾è¡¨å·²å­˜åœ¨ï¼Œå…ˆé”€æ¯
    if (pdfmakeBarChart) {
      pdfmakeBarChart.dispose()
      pdfmakeBarChart = null
    }

    pdfmakeBarChart = echarts.init(pdfmakeBarRef.value)
    pdfmakeBarChart.setOption({
      title: { text: 'é”€é‡å¯¹æ¯”', left: 'center', textStyle: { fontSize: 14 } },
      xAxis: { type: 'category', data: ['äº§å“A', 'äº§å“B', 'äº§å“C'] },
      yAxis: { type: 'value' },
      series: [{ data: [820, 932, 901], type: 'bar', itemStyle: { color: '#48bb78' } }],
    })
  }
}

// å°†PDF Blobåœ¨æ–°çª—å£/iframeä¸­æ‰“å¼€å¹¶è§¦å‘æ‰“å°
const openBlobInPrintWindow = async (blob: Blob) => {
  try {
    const url = URL.createObjectURL(blob)
    const iframe = document.createElement('iframe')
    iframe.style.position = 'fixed'
    iframe.style.right = '0'
    iframe.style.bottom = '0'
    iframe.style.width = '0'
    iframe.style.height = '0'
    iframe.style.border = '0'
    iframe.src = url
    document.body.appendChild(iframe)

    await new Promise<void>((resolve) => {
      iframe.onload = () => {
        try {
          // æœ‰äº›æµè§ˆå™¨éœ€è¦ç¨å¾®å»¶è¿Ÿå†è°ƒç”¨print
          setTimeout(() => {
            try {
              iframe.contentWindow?.focus()
              iframe.contentWindow?.print()

              // ç›‘å¬æ‰“å°å®Œæˆäº‹ä»¶ï¼ˆæ‰“å°å¯¹è¯æ¡†å…³é—­åæ¸…ç†ï¼‰
              const cleanup = () => {
                setTimeout(() => {
                  try {
                    document.body.removeChild(iframe)
                  } catch (e) {}
                  URL.revokeObjectURL(url)
                }, 100)
              }

              // å°è¯•ç›‘å¬ afterprint äº‹ä»¶
              if (iframe.contentWindow) {
                iframe.contentWindow.addEventListener('afterprint', cleanup, { once: true })
                // å¤‡ç”¨ï¼šå¦‚æœ5åˆ†é’Ÿåè¿˜æ²¡æ¸…ç†ï¼Œå¼ºåˆ¶æ¸…ç†
                setTimeout(cleanup, 300000)
              } else {
                cleanup()
              }
            } catch (e) {
              console.warn('è§¦å‘æ‰“å°å¤±è´¥ï¼Œå°è¯•æ‰“å¼€æ–°æ ‡ç­¾é¡µæ‰“å°', e)
              window.open(url)
              setTimeout(() => URL.revokeObjectURL(url), 5000)
            }
            resolve()
          }, 200)
        } catch (e) {
          resolve()
        }
      }
    })
  } catch (err) {
    console.error('openBlobInPrintWindow é”™è¯¯:', err)
    throw err
  }
}

// ==================== åŸºç¡€åŠŸèƒ½ç¤ºä¾‹å‡½æ•° ====================

// ç¤ºä¾‹1: åˆ›å»ºåŸºç¡€æ–‡æ¡£
const example1Generate = async () => {
  loading.value = true
  statusMessage.value = 'æ­£åœ¨ç”ŸæˆPDF...'

  try {
    if (!fontsReady.value) {
      await configurePdfMakeChinese()
      fontsReady.value = true
    }

    const chineseStyles = getChinesePdfMakeStyles()

    const docDefinition: any = {
      content: [
        'Hello World!',
        'è¿™æ˜¯ä½¿ç”¨ pdfmake ç”Ÿæˆçš„ PDF æ–‡æ¡£',
        'ç”Ÿæˆæ—¶é—´: ' + currentDate.value,
      ],
      ...chineseStyles,
    }

    pdfMake.createPdf(docDefinition).getBlob((blob: Blob) => openBlobInPrintWindow(blob))
    statusMessage.value = 'âœ… PDFç”ŸæˆæˆåŠŸï¼'
  } catch (error) {
    console.error('PDFç”Ÿæˆé”™è¯¯:', error)
    statusMessage.value = 'âŒ PDFç”Ÿæˆå¤±è´¥: ' + error
  } finally {
    loading.value = false
  }
}

// ç¤ºä¾‹2: æ–‡æœ¬æ ·å¼
const example2Generate = async () => {
  loading.value = true
  statusMessage.value = 'æ­£åœ¨ç”ŸæˆPDF...'

  try {
    if (!fontsReady.value) {
      await configurePdfMakeChinese()
      fontsReady.value = true
    }

    const chineseStyles = getChinesePdfMakeStyles()

    const docDefinition: any = {
      content: [
        { text: 'æ ‡é¢˜æ–‡æœ¬', style: 'header' },
        { text: 'å‰¯æ ‡é¢˜', style: 'subheader' },
        { text: 'æ™®é€šæ­£æ–‡å†…å®¹', fontSize: 12, margin: [0, 5, 0, 5] },
        { text: 'åŠ ç²—æ–‡æœ¬', bold: true, margin: [0, 5, 0, 5] },
        { text: 'æ–œä½“æ–‡æœ¬', italics: true, margin: [0, 5, 0, 5] },
        { text: 'å½©è‰²æ–‡æœ¬', color: '#667eea', margin: [0, 5, 0, 5] },
        { text: 'å¸¦èƒŒæ™¯è‰²çš„æ–‡æœ¬', background: '#fef3c7', margin: [0, 5, 0, 5] },
        { text: 'å¤§å·æ–‡æœ¬', fontSize: 18, margin: [0, 5, 0, 5] },
        { text: 'å°å·æ–‡æœ¬', fontSize: 8, margin: [0, 5, 0, 5] },
      ],
      styles: {
        ...chineseStyles.styles,
        header: { fontSize: 22, bold: true, color: '#667eea', margin: [0, 0, 0, 10] },
        subheader: { fontSize: 16, bold: true, margin: [0, 10, 0, 5] },
      },
      defaultStyle: chineseStyles.defaultStyle,
    }

    pdfMake.createPdf(docDefinition).getBlob((blob: Blob) => openBlobInPrintWindow(blob))
    statusMessage.value = 'âœ… PDFç”ŸæˆæˆåŠŸï¼'
  } catch (error) {
    console.error('PDFç”Ÿæˆé”™è¯¯:', error)
    statusMessage.value = 'âŒ PDFç”Ÿæˆå¤±è´¥: ' + error
  } finally {
    loading.value = false
  }
}

// ç¤ºä¾‹3: åˆ—è¡¨
const example3Generate = async () => {
  loading.value = true
  statusMessage.value = 'æ­£åœ¨ç”ŸæˆPDF...'

  try {
    if (!fontsReady.value) {
      await configurePdfMakeChinese()
      fontsReady.value = true
    }

    const chineseStyles = getChinesePdfMakeStyles()

    const docDefinition: any = {
      content: [
        { text: 'åˆ—è¡¨æ¼”ç¤º', style: 'header' },
        { text: 'æ— åºåˆ—è¡¨:', style: 'subheader' },
        {
          ul: [
            'ç¬¬ä¸€é¡¹ - è¿™æ˜¯æ— åºåˆ—è¡¨çš„ç¬¬ä¸€é¡¹',
            'ç¬¬äºŒé¡¹ - è¿™æ˜¯æ— åºåˆ—è¡¨çš„ç¬¬äºŒé¡¹',
            'ç¬¬ä¸‰é¡¹ - è¿™æ˜¯æ— åºåˆ—è¡¨çš„ç¬¬ä¸‰é¡¹',
          ],
        },
        { text: 'æœ‰åºåˆ—è¡¨:', style: 'subheader', margin: [0, 15, 0, 5] },
        {
          ol: ['æ­¥éª¤ä¸€ - å‡†å¤‡å·¥ä½œ', 'æ­¥éª¤äºŒ - æ‰§è¡Œä»»åŠ¡', 'æ­¥éª¤ä¸‰ - éªŒæ”¶ç»“æœ'],
        },
        { text: 'åµŒå¥—åˆ—è¡¨:', style: 'subheader', margin: [0, 15, 0, 5] },
        {
          ul: [
            'ä¸»é¡¹ç›®ä¸€',
            {
              ul: ['å­é¡¹ç›® 1.1', 'å­é¡¹ç›® 1.2'],
            },
            'ä¸»é¡¹ç›®äºŒ',
            'ä¸»é¡¹ç›®ä¸‰',
          ],
        },
      ],
      styles: {
        ...chineseStyles.styles,
        header: { fontSize: 18, bold: true, margin: [0, 0, 0, 10] },
        subheader: { fontSize: 14, bold: true, margin: [0, 10, 0, 5] },
      },
      defaultStyle: chineseStyles.defaultStyle,
    }

    pdfMake.createPdf(docDefinition).getBlob((blob: Blob) => openBlobInPrintWindow(blob))
    statusMessage.value = 'âœ… PDFç”ŸæˆæˆåŠŸï¼'
  } catch (error) {
    console.error('PDFç”Ÿæˆé”™è¯¯:', error)
    statusMessage.value = 'âŒ PDFç”Ÿæˆå¤±è´¥: ' + error
  } finally {
    loading.value = false
  }
}

// ç¤ºä¾‹4: å¤šåˆ—å¸ƒå±€
const example4Generate = async () => {
  loading.value = true
  statusMessage.value = 'æ­£åœ¨ç”ŸæˆPDF...'

  try {
    if (!fontsReady.value) {
      await configurePdfMakeChinese()
      fontsReady.value = true
    }

    const chineseStyles = getChinesePdfMakeStyles()

    const docDefinition: any = {
      content: [
        { text: 'å¤šåˆ—å¸ƒå±€æ¼”ç¤º', style: 'header' },
        { text: 'ä¸¤åˆ—å¸ƒå±€:', style: 'subheader' },
        {
          columns: [
            {
              width: '50%',
              text: 'å·¦ä¾§åˆ—å†…å®¹\n\nè¿™æ˜¯å·¦ä¾§åˆ—çš„è¯¦ç»†å†…å®¹ï¼Œå¯ä»¥åŒ…å«å¤šè¡Œæ–‡æœ¬ã€‚pdfmakeçš„å¤šåˆ—å¸ƒå±€éå¸¸çµæ´»ã€‚',
            },
            {
              width: '50%',
              text: 'å³ä¾§åˆ—å†…å®¹\n\nè¿™æ˜¯å³ä¾§åˆ—çš„è¯¦ç»†å†…å®¹ï¼Œä¸å·¦ä¾§åˆ—å¹¶æ’æ˜¾ç¤ºã€‚',
            },
          ],
          columnGap: 20,
        },
        { text: 'ä¸‰åˆ—å¸ƒå±€:', style: 'subheader', margin: [0, 20, 0, 5] },
        {
          columns: [
            { width: '*', text: 'ç¬¬ä¸€åˆ—\nè‡ªé€‚åº”å®½åº¦', fillColor: '#f0f0f0' },
            { width: '*', text: 'ç¬¬äºŒåˆ—\nè‡ªé€‚åº”å®½åº¦', fillColor: '#e0e0e0' },
            { width: '*', text: 'ç¬¬ä¸‰åˆ—\nè‡ªé€‚åº”å®½åº¦', fillColor: '#d0d0d0' },
          ],
          columnGap: 10,
        },
        { text: 'æ··åˆå®½åº¦:', style: 'subheader', margin: [0, 20, 0, 5] },
        {
          columns: [
            { width: 100, text: 'å›ºå®š100px' },
            { width: '*', text: 'è‡ªé€‚åº”å®½åº¦' },
            { width: 'auto', text: 'è‡ªåŠ¨' },
          ],
          columnGap: 10,
        },
      ],
      styles: {
        ...chineseStyles.styles,
        header: { fontSize: 18, bold: true, margin: [0, 0, 0, 10] },
        subheader: { fontSize: 14, bold: true, margin: [0, 10, 0, 5] },
      },
      defaultStyle: chineseStyles.defaultStyle,
    }

    pdfMake.createPdf(docDefinition).getBlob((blob: Blob) => openBlobInPrintWindow(blob))
    statusMessage.value = 'âœ… PDFç”ŸæˆæˆåŠŸï¼'
  } catch (error) {
    console.error('PDFç”Ÿæˆé”™è¯¯:', error)
    statusMessage.value = 'âŒ PDFç”Ÿæˆå¤±è´¥: ' + error
  } finally {
    loading.value = false
  }
}

// ç¤ºä¾‹5: é¡µçœ‰é¡µè„š
const example5Generate = async () => {
  loading.value = true
  statusMessage.value = 'æ­£åœ¨ç”ŸæˆPDF...'

  try {
    if (!fontsReady.value) {
      await configurePdfMakeChinese()
      fontsReady.value = true
    }

    const chineseStyles = getChinesePdfMakeStyles()

    const docDefinition: any = {
      header: {
        text: 'å…¬å¸æœºå¯†æ–‡ä»¶',
        alignment: 'center',
        margin: [0, 10, 0, 0],
        fontSize: 10,
        color: '#718096',
      },
      footer: (currentPage: number, pageCount: number) => ({
        text: `ç¬¬ ${currentPage} / ${pageCount} é¡µ | ç”Ÿæˆæ—¥æœŸ: ${currentDate.value}`,
        alignment: 'center',
        margin: [0, 0, 0, 10],
        fontSize: 9,
        color: '#718096',
      }),
      content: [
        { text: 'å¸¦é¡µçœ‰é¡µè„šçš„æ–‡æ¡£', style: 'header' },
        { text: 'è¿™æ˜¯æ–‡æ¡£çš„ä¸»ä½“å†…å®¹ã€‚é¡µçœ‰å’Œé¡µè„šä¼šè‡ªåŠ¨å‡ºç°åœ¨æ¯ä¸€é¡µä¸Šã€‚' },
        { text: '\n' },
        { text: 'é¡µçœ‰é€šå¸¸ç”¨äºæ˜¾ç¤ºæ–‡æ¡£æ ‡é¢˜ã€å…¬å¸åç§°æˆ–æœºå¯†æ ‡è¯†ã€‚' },
        { text: '\n' },
        { text: 'é¡µè„šé€šå¸¸ç”¨äºæ˜¾ç¤ºé¡µç ã€æ—¥æœŸæˆ–ç‰ˆæƒä¿¡æ¯ã€‚' },
      ],
      styles: {
        ...chineseStyles.styles,
        header: { fontSize: 18, bold: true, margin: [0, 0, 0, 15] },
      },
      defaultStyle: chineseStyles.defaultStyle,
    }

    pdfMake.createPdf(docDefinition).getBlob((blob: Blob) => openBlobInPrintWindow(blob))
    statusMessage.value = 'âœ… PDFç”ŸæˆæˆåŠŸï¼'
  } catch (error) {
    console.error('PDFç”Ÿæˆé”™è¯¯:', error)
    statusMessage.value = 'âŒ PDFç”Ÿæˆå¤±è´¥: ' + error
  } finally {
    loading.value = false
  }
}

// ç¤ºä¾‹6: åˆ†é¡µæ§åˆ¶
const example6Generate = async () => {
  loading.value = true
  statusMessage.value = 'æ­£åœ¨ç”ŸæˆPDF...'

  try {
    if (!fontsReady.value) {
      await configurePdfMakeChinese()
      fontsReady.value = true
    }

    const chineseStyles = getChinesePdfMakeStyles()

    const docDefinition: any = {
      content: [
        { text: 'ç¬¬ä¸€é¡µå†…å®¹', style: 'header' },
        { text: 'è¿™æ˜¯ç¬¬ä¸€é¡µçš„å†…å®¹ã€‚' },
        { text: 'å¯ä»¥æ·»åŠ æ›´å¤šå†…å®¹...' },
        { text: '\n\n' },
        { text: 'ç¬¬ä¸€é¡µçš„ç»“æŸã€‚' },
        { text: 'ç¬¬äºŒé¡µå†…å®¹', style: 'header', pageBreak: 'before' },
        { text: 'è¿™æ˜¯ç¬¬äºŒé¡µçš„å†…å®¹ã€‚é€šè¿‡ pageBreak: "before" å¼ºåˆ¶åœ¨æ­¤å…ƒç´ å‰åˆ†é¡µã€‚' },
        { text: '\n\n' },
        { text: 'ç¬¬äºŒé¡µç»§ç»­...' },
        { text: 'ç¬¬ä¸‰é¡µå†…å®¹', style: 'header', pageBreak: 'before' },
        { text: 'è¿™æ˜¯ç¬¬ä¸‰é¡µçš„å†…å®¹ã€‚' },
        { text: '\n' },
        { text: 'åˆ†é¡µæ§åˆ¶è¯´æ˜:', bold: true, margin: [0, 10, 0, 5] },
        {
          ul: [
            'pageBreak: "before" - åœ¨å…ƒç´ å‰åˆ†é¡µ',
            'pageBreak: "after" - åœ¨å…ƒç´ ååˆ†é¡µ',
            'è‡ªåŠ¨åˆ†é¡µ - å†…å®¹è¶…å‡ºé¡µé¢æ—¶è‡ªåŠ¨åˆ†é¡µ',
          ],
        },
      ],
      footer: (currentPage: number, pageCount: number) => ({
        text: `ç¬¬ ${currentPage} / ${pageCount} é¡µ`,
        alignment: 'center',
        margin: [0, 0, 0, 10],
      }),
      styles: {
        ...chineseStyles.styles,
        header: { fontSize: 18, bold: true, margin: [0, 0, 0, 10], color: '#667eea' },
      },
      defaultStyle: chineseStyles.defaultStyle,
    }

    pdfMake.createPdf(docDefinition).getBlob((blob: Blob) => openBlobInPrintWindow(blob))
    statusMessage.value = 'âœ… PDFç”ŸæˆæˆåŠŸï¼'
  } catch (error) {
    console.error('PDFç”Ÿæˆé”™è¯¯:', error)
    statusMessage.value = 'âŒ PDFç”Ÿæˆå¤±è´¥: ' + error
  } finally {
    loading.value = false
  }
}

// ç¤ºä¾‹7: EChartså›¾è¡¨
const example7Generate = async () => {
  loading.value = true
  statusMessage.value = 'æ­£åœ¨ç”Ÿæˆå›¾è¡¨PDF...'

  try {
    if (!fontsReady.value) {
      await configurePdfMakeChinese()
      fontsReady.value = true
    }

    // è·å–å›¾è¡¨å›¾ç‰‡
    const pieImage = pdfmakePieChart?.getDataURL({
      type: 'png',
      pixelRatio: 2,
      backgroundColor: '#fff',
    })
    const barImage = pdfmakeBarChart?.getDataURL({
      type: 'png',
      pixelRatio: 2,
      backgroundColor: '#fff',
    })

    const docDefinition: any = {
      content: [
        { text: 'æ•°æ®åˆ†ææŠ¥å‘Š', style: 'title', alignment: 'center' },
        { text: '\n' },
        {
          columns: [
            { image: pieImage, width: 250 },
            { image: barImage, width: 250 },
          ],
          columnGap: 10,
        },
        { text: '\n' },
        { text: 'âœ¨ pdfmakeä¼˜åŠ¿ï¼šä½¿ç”¨columnsè½»æ¾å®ç°å›¾è¡¨å¹¶æ’ï¼Œæ— éœ€æ‰‹åŠ¨è®¡ç®—åæ ‡ï¼', style: 'note' },
      ],
      styles: {
        title: { fontSize: 20, bold: true, color: '#48bb78' },
        note: { fontSize: 10, color: '#718096', italics: true },
      },
      defaultStyle: { font: 'NotoSansSC' },
    }

    pdfMake.createPdf(docDefinition).getBlob((blob: Blob) => openBlobInPrintWindow(blob))
    statusMessage.value = 'âœ… å›¾è¡¨PDFç”ŸæˆæˆåŠŸï¼'
  } catch (error) {
    console.error('PDFç”Ÿæˆé”™è¯¯:', error)
    statusMessage.value = 'âŒ PDFç”Ÿæˆå¤±è´¥: ' + error
  } finally {
    loading.value = false
  }
}

// ==================== é«˜çº§åŠŸèƒ½ç¤ºä¾‹ ====================

const currentAdvanced = ref(0)
const advancedExamples = ['è¡¨æ ¼', 'å›¾ç‰‡åµŒå…¥', 'æ°´å°èƒŒæ™¯', 'å¤æ‚è¡¨æ ¼', 'é“¾æ¥ç›®å½•', 'å®Œæ•´æŠ¥å‘Š']

// ç¤ºä¾‹å›¾ç‰‡
const sampleImage = ref('')

// é«˜çº§1: è¡¨æ ¼ç”Ÿæˆ
const advanced1Generate = async () => {
  loading.value = true
  statusMessage.value = 'æ­£åœ¨ç”Ÿæˆè¡¨æ ¼PDF...'

  try {
    if (!fontsReady.value) {
      await configurePdfMakeChinese()
      fontsReady.value = true
    }

    const chineseStyles = getChinesePdfMakeStyles()

    const docDefinition: any = {
      content: [
        { text: 'å‘˜å·¥ä¿¡æ¯è¡¨', style: 'header' },
        { text: 'ä½¿ç”¨pdfmakeç”Ÿæˆçš„ä¸“ä¸šè¡¨æ ¼', style: 'subheader' },
        {
          table: {
            headerRows: 1,
            widths: ['*', 'auto', 'auto', 'auto'],
            body: [
              [
                { text: 'å§“å', style: 'tableHeader', fillColor: '#667eea', color: 'white' },
                { text: 'éƒ¨é—¨', style: 'tableHeader', fillColor: '#667eea', color: 'white' },
                { text: 'èŒä½', style: 'tableHeader', fillColor: '#667eea', color: 'white' },
                { text: 'å·¥èµ„', style: 'tableHeader', fillColor: '#667eea', color: 'white' },
              ],
              ['å¼ ä¸‰', 'æŠ€æœ¯éƒ¨', 'å‰ç«¯å·¥ç¨‹å¸ˆ', 'Â¥15,000'],
              ['æå››', 'äº§å“éƒ¨', 'äº§å“ç»ç†', 'Â¥18,000'],
              ['ç‹äº”', 'è®¾è®¡éƒ¨', 'UIè®¾è®¡å¸ˆ', 'Â¥14,000'],
              ['èµµå…­', 'è¿è¥éƒ¨', 'è¿è¥ä¸“å‘˜', 'Â¥13,000'],
              ['å­™ä¸ƒ', 'å¸‚åœºéƒ¨', 'å¸‚åœºä¸“å‘˜', 'Â¥13,500'],
            ],
          },
          layout: {
            hLineWidth: () => 1,
            vLineWidth: () => 1,
            hLineColor: () => '#e2e8f0',
            vLineColor: () => '#e2e8f0',
          },
        },
      ],
      styles: {
        ...chineseStyles.styles,
        header: { fontSize: 18, bold: true, margin: [0, 0, 0, 10] },
        subheader: { fontSize: 12, margin: [0, 0, 0, 15], color: '#718096' },
        tableHeader: { bold: true, fontSize: 11 },
      },
      defaultStyle: chineseStyles.defaultStyle,
    }

    pdfMake.createPdf(docDefinition).getBlob((blob: Blob) => openBlobInPrintWindow(blob))
    statusMessage.value = 'âœ… è¡¨æ ¼PDFç”ŸæˆæˆåŠŸï¼'
  } catch (error) {
    console.error('PDFç”Ÿæˆé”™è¯¯:', error)
    statusMessage.value = 'âŒ PDFç”Ÿæˆå¤±è´¥: ' + error
  } finally {
    loading.value = false
  }
}

// é«˜çº§2: å›¾ç‰‡åµŒå…¥
const advanced2Generate = async () => {
  loading.value = true
  statusMessage.value = 'æ­£åœ¨ç”Ÿæˆå›¾ç‰‡PDF...'

  try {
    if (!fontsReady.value) {
      await configurePdfMakeChinese()
      fontsReady.value = true
    }

    const chineseStyles = getChinesePdfMakeStyles()

    const docDefinition: any = {
      content: [
        { text: 'PDFä¸­çš„å›¾ç‰‡', style: 'header' },
        { text: 'æ”¯æŒå¤šç§å›¾ç‰‡æ ¼å¼å’Œå¯¹é½æ–¹å¼', style: 'subheader' },
        { text: 'å›¾ç‰‡å±…å·¦:', margin: [0, 10, 0, 5] },
        {
          image:
            sampleImage.value ||
            'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mNk+M9QDwADhgGAWjR9awAAAABJRU5ErkJggg==',
          width: 150,
          alignment: 'left',
        },
        { text: 'å›¾ç‰‡å±…ä¸­:', margin: [0, 20, 0, 5] },
        {
          image:
            sampleImage.value ||
            'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mNk+M9QDwADhgGAWjR9awAAAABJRU5ErkJggg==',
          width: 150,
          alignment: 'center',
        },
        { text: 'å›¾ç‰‡å±…å³:', margin: [0, 20, 0, 5] },
        {
          image:
            sampleImage.value ||
            'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mNk+M9QDwADhgGAWjR9awAAAABJRU5ErkJggg==',
          width: 150,
          alignment: 'right',
        },
        { text: '\nè¯´æ˜:', bold: true, margin: [0, 20, 0, 5] },
        {
          ul: [
            'æ”¯æŒ PNGã€JPEGã€SVG ç­‰æ ¼å¼',
            'ä½¿ç”¨ Base64 ç¼–ç åµŒå…¥å›¾ç‰‡',
            'å¯ä»¥è®¾ç½®å®½åº¦ã€é«˜åº¦ã€å¯¹é½æ–¹å¼',
            'æ”¯æŒå›¾ç‰‡é“¾æ¥åŠŸèƒ½',
          ],
        },
      ],
      styles: {
        ...chineseStyles.styles,
        header: { fontSize: 18, bold: true, margin: [0, 0, 0, 10] },
        subheader: { fontSize: 12, margin: [0, 0, 0, 15], color: '#718096' },
      },
      defaultStyle: chineseStyles.defaultStyle,
    }

    pdfMake.createPdf(docDefinition).getBlob((blob: Blob) => openBlobInPrintWindow(blob))
    statusMessage.value = 'âœ… å›¾ç‰‡PDFç”ŸæˆæˆåŠŸï¼'
  } catch (error) {
    console.error('PDFç”Ÿæˆé”™è¯¯:', error)
    statusMessage.value = 'âŒ PDFç”Ÿæˆå¤±è´¥: ' + error
  } finally {
    loading.value = false
  }
}

// é«˜çº§3: æ°´å°å’ŒèƒŒæ™¯
const advanced3Generate = async () => {
  loading.value = true
  statusMessage.value = 'æ­£åœ¨ç”Ÿæˆå¸¦æ°´å°PDF...'

  try {
    if (!fontsReady.value) {
      await configurePdfMakeChinese()
      fontsReady.value = true
    }

    const chineseStyles = getChinesePdfMakeStyles()

    const docDefinition: any = {
      background: (currentPage: number, pageSize: { width: number; height: number }) => [
        {
          text: 'æœºå¯†æ–‡ä»¶',
          color: '#cccccc',
          opacity: 0.2,
          bold: true,
          fontSize: 50,
          absolutePosition: { x: pageSize.width / 2 - 100, y: pageSize.height / 2 - 25 },
          angle: -30,
        },
      ],
      content: [
        { text: 'å¸¦æ°´å°çš„æœºå¯†æ–‡æ¡£', style: 'header' },
        { text: 'æ­¤æ–‡æ¡£åŒ…å«èƒŒæ™¯æ°´å°ï¼Œç”¨äºæ ‡è¯†æ–‡æ¡£çš„æœºå¯†æ€§ã€‚', margin: [0, 0, 0, 15] },
        { text: 'æ°´å°çš„ç”¨é€”:', bold: true, margin: [0, 10, 0, 5] },
        {
          ul: [
            'æ ‡è¯†æ–‡æ¡£çš„æœºå¯†çº§åˆ«',
            'é˜²æ­¢æœªç»æˆæƒçš„å¤åˆ¶å’Œåˆ†å‘',
            'æ ‡è®°æ–‡æ¡£çŠ¶æ€ï¼ˆå¦‚ï¼šè‰ç¨¿ã€å®¡æ ¸ä¸­ç­‰ï¼‰',
            'å¢å¼ºå“ç‰Œè¯†åˆ«åº¦',
          ],
        },
        { text: '\n' },
        { text: 'æ°´å°é…ç½®é€‰é¡¹:', bold: true, margin: [0, 10, 0, 5] },
        {
          ul: [
            'text: æ°´å°æ–‡å­—å†…å®¹',
            'color: æ°´å°é¢œè‰²',
            'opacity: é€æ˜åº¦ (0-1)',
            'fontSize: å­—ä½“å¤§å°',
            'angle: æ—‹è½¬è§’åº¦',
          ],
        },
      ],
      styles: {
        ...chineseStyles.styles,
        header: { fontSize: 18, bold: true, margin: [0, 0, 0, 10] },
      },
      defaultStyle: chineseStyles.defaultStyle,
    }

    pdfMake.createPdf(docDefinition).getBlob((blob: Blob) => openBlobInPrintWindow(blob))
    statusMessage.value = 'âœ… æ°´å°PDFç”ŸæˆæˆåŠŸï¼'
  } catch (error) {
    console.error('PDFç”Ÿæˆé”™è¯¯:', error)
    statusMessage.value = 'âŒ PDFç”Ÿæˆå¤±è´¥: ' + error
  } finally {
    loading.value = false
  }
}

// é«˜çº§4: å¤æ‚è¡¨æ ¼å¸ƒå±€
const advanced4Generate = async () => {
  loading.value = true
  statusMessage.value = 'æ­£åœ¨ç”Ÿæˆå¤æ‚è¡¨æ ¼PDF...'

  try {
    if (!fontsReady.value) {
      await configurePdfMakeChinese()
      fontsReady.value = true
    }

    const chineseStyles = getChinesePdfMakeStyles()

    const docDefinition: any = {
      content: [
        { text: 'å¤æ‚è¡¨æ ¼å¸ƒå±€æ¼”ç¤º', style: 'header' },
        { text: 'å•å…ƒæ ¼åˆå¹¶ç¤ºä¾‹:', bold: true, margin: [0, 15, 0, 10] },
        {
          table: {
            widths: ['*', '*', '*'],
            body: [
              [
                {
                  text: 'åˆå¹¶ä¸¤åˆ— (colSpan: 2)',
                  colSpan: 2,
                  fillColor: '#e2e8f0',
                  alignment: 'center',
                },
                {},
                { text: 'ç¬¬ä¸‰åˆ—' },
              ],
              [
                {
                  text: 'åˆå¹¶ä¸¤è¡Œ\n(rowSpan: 2)',
                  rowSpan: 2,
                  fillColor: '#e2e8f0',
                  alignment: 'center',
                },
                { text: 'B1' },
                { text: 'C1' },
              ],
              [{}, { text: 'B2' }, { text: 'C2' }],
            ],
          },
        },
        { text: 'åµŒå¥—å†…å®¹:', bold: true, margin: [0, 20, 0, 10] },
        {
          table: {
            widths: ['auto', '*'],
            body: [
              [
                { text: 'é¡¹ç›®', bold: true, fillColor: '#667eea', color: 'white' },
                { text: 'è¯¦æƒ…', bold: true, fillColor: '#667eea', color: 'white' },
              ],
              [
                'åˆ—è¡¨é¡¹',
                {
                  ul: ['å­é¡¹ç›® 1', 'å­é¡¹ç›® 2', 'å­é¡¹ç›® 3'],
                },
              ],
              [
                'åµŒå¥—è¡¨æ ¼',
                {
                  table: {
                    body: [
                      ['A', 'B'],
                      ['C', 'D'],
                    ],
                  },
                },
              ],
            ],
          },
        },
      ],
      styles: {
        ...chineseStyles.styles,
        header: { fontSize: 18, bold: true, margin: [0, 0, 0, 10] },
      },
      defaultStyle: chineseStyles.defaultStyle,
    }

    pdfMake.createPdf(docDefinition).getBlob((blob: Blob) => openBlobInPrintWindow(blob))
    statusMessage.value = 'âœ… å¤æ‚è¡¨æ ¼PDFç”ŸæˆæˆåŠŸï¼'
  } catch (error) {
    console.error('PDFç”Ÿæˆé”™è¯¯:', error)
    statusMessage.value = 'âŒ PDFç”Ÿæˆå¤±è´¥: ' + error
  } finally {
    loading.value = false
  }
}

// é«˜çº§5: é“¾æ¥å’Œç›®å½•
const advanced5Generate = async () => {
  loading.value = true
  statusMessage.value = 'æ­£åœ¨ç”Ÿæˆå¸¦é“¾æ¥PDF...'

  try {
    if (!fontsReady.value) {
      await configurePdfMakeChinese()
      fontsReady.value = true
    }

    const chineseStyles = getChinesePdfMakeStyles()

    const docDefinition: any = {
      content: [
        { text: 'PDFé“¾æ¥æ¼”ç¤º', style: 'header' },
        { text: 'å¤–éƒ¨é“¾æ¥:', bold: true, margin: [0, 15, 0, 5] },
        {
          text: 'è®¿é—® pdfmake å®˜æ–¹æ–‡æ¡£',
          link: 'https://pdfmake.github.io/docs/',
          color: '#667eea',
          decoration: 'underline',
          margin: [0, 0, 0, 10],
        },
        {
          text: 'è®¿é—® GitHub ä»“åº“',
          link: 'https://github.com/bpampuch/pdfmake',
          color: '#667eea',
          decoration: 'underline',
          margin: [0, 0, 0, 15],
        },
        { text: 'å†…éƒ¨é“¾æ¥:', bold: true, margin: [0, 10, 0, 5] },
        {
          text: 'è·³è½¬åˆ°ç¬¬äºŒç« ',
          linkToDestination: 'chapter2',
          color: '#667eea',
          decoration: 'underline',
          margin: [0, 0, 0, 20],
        },
        { text: 'ç¬¬ä¸€ç«  - æ¦‚è¿°', style: 'chapter' },
        {
          text: 'è¿™æ˜¯ç¬¬ä¸€ç« çš„å†…å®¹ã€‚pdfmake æ”¯æŒåˆ›å»ºåŒ…å«é“¾æ¥çš„ PDF æ–‡æ¡£ï¼Œå¯ä»¥é“¾æ¥åˆ°å¤–éƒ¨ç½‘å€æˆ–æ–‡æ¡£å†…éƒ¨çš„å…¶ä»–ä½ç½®ã€‚',
        },
        { text: 'ç¬¬äºŒç«  - è¯¦ç»†è¯´æ˜', style: 'chapter', id: 'chapter2', pageBreak: 'before' },
        { text: 'è¿™æ˜¯ç¬¬äºŒç« çš„å†…å®¹ã€‚æ‚¨å¯ä»¥é€šè¿‡ç‚¹å‡»ç¬¬ä¸€é¡µçš„é“¾æ¥è·³è½¬åˆ°è¿™é‡Œã€‚' },
        { text: '\n' },
        { text: 'é“¾æ¥ç±»å‹:', bold: true, margin: [0, 10, 0, 5] },
        {
          ul: [
            'link: å¤–éƒ¨ URL é“¾æ¥',
            'linkToDestination: å†…éƒ¨é”šç‚¹é“¾æ¥',
            'linkToPage: è·³è½¬åˆ°æŒ‡å®šé¡µç ',
          ],
        },
      ],
      styles: {
        ...chineseStyles.styles,
        header: { fontSize: 18, bold: true, margin: [0, 0, 0, 10] },
        chapter: { fontSize: 16, bold: true, margin: [0, 20, 0, 10], color: '#2d3748' },
      },
      defaultStyle: chineseStyles.defaultStyle,
    }

    pdfMake.createPdf(docDefinition).getBlob((blob: Blob) => openBlobInPrintWindow(blob))
    statusMessage.value = 'âœ… å¸¦é“¾æ¥PDFç”ŸæˆæˆåŠŸï¼'
  } catch (error) {
    console.error('PDFç”Ÿæˆé”™è¯¯:', error)
    statusMessage.value = 'âŒ PDFç”Ÿæˆå¤±è´¥: ' + error
  } finally {
    loading.value = false
  }
}

// é«˜çº§6: å®Œæ•´æŠ¥å‘Šç”Ÿæˆ
const advanced6Generate = async () => {
  loading.value = true
  statusMessage.value = 'æ­£åœ¨ç”Ÿæˆå®Œæ•´æŠ¥å‘Š...'

  try {
    if (!fontsReady.value) {
      await configurePdfMakeChinese()
      fontsReady.value = true
    }

    const chineseStyles = getChinesePdfMakeStyles()

    const docDefinition: any = {
      info: {
        title: '2024å¹´åº¦å·¥ä½œæŠ¥å‘Š',
        author: 'ç¤ºä¾‹å…¬å¸',
        subject: 'å¹´åº¦å·¥ä½œæ€»ç»“ä¸è§„åˆ’',
      },
      header: (currentPage: number, pageCount: number) => {
        if (currentPage === 1) return null
        return {
          text: '2024å¹´åº¦å·¥ä½œæŠ¥å‘Š',
          alignment: 'center',
          margin: [40, 20, 40, 0],
          fontSize: 9,
          color: '#718096',
        }
      },
      footer: (currentPage: number, pageCount: number) => ({
        text: `ç¬¬ ${currentPage} / ${pageCount} é¡µ`,
        alignment: 'center',
        margin: [0, 10, 0, 0],
        fontSize: 9,
        color: '#718096',
      }),
      content: [
        // å°é¢
        { text: '\n\n\n\n\n' },
        { text: '2024å¹´åº¦å·¥ä½œæŠ¥å‘Š', style: 'title', alignment: 'center' },
        { text: '\n' },
        { text: 'ç¤ºä¾‹å…¬å¸', style: 'subtitle', alignment: 'center' },
        { text: currentDate.value, alignment: 'center', margin: [0, 20, 0, 0], color: '#718096' },
        // ç›®å½•é¡µ
        { text: 'ç›®å½•', style: 'tocTitle', pageBreak: 'before' },
        {
          toc: {
            numberStyle: { bold: true },
          },
        },
        // ç¬¬ä¸€ç« 
        { text: 'ç¬¬ä¸€ç«  å¹´åº¦æ¦‚è¿°', style: 'chapter', tocItem: true, pageBreak: 'before' },
        {
          text: '2024å¹´æ˜¯å…¬å¸å‘å±•çš„é‡è¦ä¸€å¹´ã€‚åœ¨å…¨ä½“å‘˜å·¥çš„å…±åŒåŠªåŠ›ä¸‹ï¼Œæˆ‘ä»¬å–å¾—äº†æ˜¾è‘—çš„æˆç»©ã€‚',
          margin: [0, 10, 0, 10],
        },
        // ç¬¬äºŒç« 
        { text: 'ç¬¬äºŒç«  ä¸šç»©æ•°æ®', style: 'chapter', tocItem: true, pageBreak: 'before' },
        { text: 'å­£åº¦ä¸šç»©è¡¨:', bold: true, margin: [0, 10, 0, 10] },
        {
          table: {
            headerRows: 1,
            widths: ['*', 'auto', 'auto', 'auto'],
            body: [
              [
                { text: 'å­£åº¦', fillColor: '#667eea', color: 'white', bold: true },
                { text: 'æ”¶å…¥', fillColor: '#667eea', color: 'white', bold: true },
                { text: 'æ”¯å‡º', fillColor: '#667eea', color: 'white', bold: true },
                { text: 'åˆ©æ¶¦', fillColor: '#667eea', color: 'white', bold: true },
              ],
              ['Q1', 'Â¥120ä¸‡', 'Â¥80ä¸‡', 'Â¥40ä¸‡'],
              ['Q2', 'Â¥150ä¸‡', 'Â¥90ä¸‡', 'Â¥60ä¸‡'],
              ['Q3', 'Â¥180ä¸‡', 'Â¥100ä¸‡', 'Â¥80ä¸‡'],
              ['Q4', 'Â¥200ä¸‡', 'Â¥110ä¸‡', 'Â¥90ä¸‡'],
              [
                { text: 'åˆè®¡', bold: true },
                { text: 'Â¥650ä¸‡', bold: true },
                { text: 'Â¥380ä¸‡', bold: true },
                { text: 'Â¥270ä¸‡', bold: true },
              ],
            ],
          },
        },
        // ç¬¬ä¸‰ç« 
        { text: 'ç¬¬ä¸‰ç«  æœªæ¥è§„åˆ’', style: 'chapter', tocItem: true, pageBreak: 'before' },
        { text: '2025å¹´é‡ç‚¹å·¥ä½œ:', bold: true, margin: [0, 10, 0, 10] },
        {
          ol: ['æŒç»­ä¼˜åŒ–äº§å“è´¨é‡', 'æ‹“å±•æµ·å¤–å¸‚åœº', 'åŠ å¼ºå›¢é˜Ÿå»ºè®¾', 'æ¨è¿›æ•°å­—åŒ–è½¬å‹'],
        },
      ],
      styles: {
        ...chineseStyles.styles,
        title: { fontSize: 28, bold: true, color: '#667eea' },
        subtitle: { fontSize: 16, color: '#4a5568' },
        tocTitle: { fontSize: 18, bold: true, margin: [0, 0, 0, 20] },
        chapter: { fontSize: 18, bold: true, margin: [0, 20, 0, 10], color: '#2d3748' },
      },
      defaultStyle: chineseStyles.defaultStyle,
    }

    pdfMake.createPdf(docDefinition).getBlob((blob: Blob) => openBlobInPrintWindow(blob))
    statusMessage.value = 'âœ… å®Œæ•´æŠ¥å‘Šç”ŸæˆæˆåŠŸï¼'
  } catch (error) {
    console.error('PDFç”Ÿæˆé”™è¯¯:', error)
    statusMessage.value = 'âŒ PDFç”Ÿæˆå¤±è´¥: ' + error
  } finally {
    loading.value = false
  }
}

// ==================== åŸæœ‰å¿«æ·åŠŸèƒ½ ====================

const generateSimplePDF = async () => {
  if (!fontsReady.value) {
    statusMessage.value = 'â³ æ­£åœ¨åˆå§‹åŒ–ä¸­æ–‡å­—ä½“...'
    await configurePdfMakeChinese()
    fontsReady.value = true
  }

  loading.value = true
  statusMessage.value = 'æ­£åœ¨ç”Ÿæˆ PDF...'

  try {
    const chineseStyles = getChinesePdfMakeStyles()

    const docDefinition: any = {
      content: [
        { text: 'pdfmake ä¸­æ–‡ç¤ºä¾‹æ–‡æ¡£', style: 'header' },
        { text: 'å£°æ˜å¼ PDF ç”Ÿæˆæ¼”ç¤º', style: 'subheader' },
        {
          text: 'è¿™æ˜¯ä¸€ä¸ªä½¿ç”¨ pdfmake ç”Ÿæˆçš„ä¸­æ–‡ PDF æ–‡æ¡£ã€‚pdfmake æä¾›äº†éå¸¸å‹å¥½çš„å£°æ˜å¼ APIï¼Œå¯ä»¥è½»æ¾åˆ›å»ºç»“æ„åŒ–çš„ PDF æ–‡æ¡£ã€‚',
          margin: [0, 10, 0, 10],
        },
        { text: 'ä¸»è¦ç‰¹ç‚¹ï¼š', style: 'subheader' },
        {
          ul: [
            'API ç®€å•æ˜“ç”¨ï¼Œæ”¯æŒä¸­æ–‡',
            'æ”¯æŒå¤æ‚çš„æ–‡æ¡£å¸ƒå±€',
            'è‡ªåŠ¨åˆ†é¡µå¤„ç†',
            'ä¸°å¯Œçš„æ ·å¼é€‰é¡¹',
            'å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯é€šç”¨',
          ],
        },
      ],
      ...chineseStyles,
    }

    pdfMake.createPdf(docDefinition).getBlob((blob: Blob) => openBlobInPrintWindow(blob))

    statusMessage.value = 'âœ… PDF ç”ŸæˆæˆåŠŸï¼'
    setTimeout(() => {
      statusMessage.value = ''
    }, 3000)
  } catch (error) {
    console.error('PDF ç”Ÿæˆå¤±è´¥:', error)
    statusMessage.value = 'âŒ PDF ç”Ÿæˆå¤±è´¥'
  } finally {
    loading.value = false
  }
}

const generateTablePDF = async () => {
  if (!fontsReady.value) {
    await configurePdfMakeChinese()
    fontsReady.value = true
  }

  loading.value = true
  statusMessage.value = 'æ­£åœ¨ç”Ÿæˆè¡¨æ ¼ PDF...'

  try {
    const chineseStyles = getChinesePdfMakeStyles()

    const docDefinition: any = {
      content: [
        { text: 'å‰ç«¯æ‰“å°æ¡†æ¶å¯¹æ¯”è¡¨', style: 'header' },
        {
          table: {
            headerRows: 1,
            widths: ['*', 'auto', 'auto', 100],
            body: [
              [
                { text: 'Framework', style: 'tableHeader' },
                { text: 'Size', style: 'tableHeader' },
                { text: 'Performance', style: 'tableHeader' },
                { text: 'Rating', style: 'tableHeader' },
              ],
              ['window.print()', '0 KB', 'Excellent', 'â˜…â˜…â˜…â˜…â˜…'],
              ['Print.js', '10 KB', 'Good', 'â˜…â˜…â˜…â˜…'],
              ['jsPDF', '150 KB', 'Good', 'â˜…â˜…â˜…â˜…'],
              ['pdfmake', '600 KB', 'Good', 'â˜…â˜…â˜…â˜…â˜…'],
              ['html2canvas', '180 KB', 'Medium', 'â˜…â˜…â˜…'],
            ],
          },
          layout: {
            fillColor: (rowIndex: number) => {
              return rowIndex === 0 ? '#667eea' : rowIndex % 2 === 0 ? '#f7fafc' : null
            },
            hLineColor: () => '#e2e8f0',
            vLineColor: () => '#e2e8f0',
          },
        },
      ],
      ...chineseStyles,
    }

    pdfMake.createPdf(docDefinition).getBlob((blob: Blob) => openBlobInPrintWindow(blob))

    statusMessage.value = 'âœ… è¡¨æ ¼ PDF ç”ŸæˆæˆåŠŸï¼'
    setTimeout(() => {
      statusMessage.value = ''
    }, 3000)
  } catch (error) {
    console.error('è¡¨æ ¼ PDF ç”Ÿæˆå¤±è´¥:', error)
    statusMessage.value = 'âŒ è¡¨æ ¼ PDF ç”Ÿæˆå¤±è´¥'
  } finally {
    loading.value = false
  }
}

const generateComplexPDF = async () => {
  if (!fontsReady.value) {
    await configurePdfMakeChinese()
    fontsReady.value = true
  }

  loading.value = true
  statusMessage.value = 'æ­£åœ¨ç”Ÿæˆå¤æ‚ PDF...'

  try {
    const chineseStyles = getChinesePdfMakeStyles()

    const docDefinition: any = {
      pageSize: 'A4',
      pageMargins: [40, 60, 40, 60],
      header: (currentPage: number, pageCount: number) => {
        return {
          text: 'pdfmake å¤æ‚æ–‡æ¡£ç¤ºä¾‹',
          alignment: 'center',
          margin: [0, 20, 0, 0],
          fontSize: 10,
          color: '#718096',
        }
      },
      footer: (currentPage: number, pageCount: number) => {
        return {
          text: `ç¬¬ ${currentPage} é¡µ / å…± ${pageCount} é¡µ`,
          alignment: 'center',
          margin: [0, 0, 0, 20],
          fontSize: 9,
          color: '#a0aec0',
        }
      },
      content: [
        { text: 'æŠ€æœ¯è°ƒç ”æŠ¥å‘Š', style: 'title' },
        { text: 'å‰ç«¯æ‰“å°æ–¹æ¡ˆé€‰å‹åˆ†æ', style: 'subtitle' },
        { text: `ç”Ÿæˆæ—¥æœŸï¼š${new Date().toLocaleDateString('zh-CN')}`, style: 'date' },

        { text: 'ä¸€ã€èƒŒæ™¯', style: 'sectionHeader' },
        {
          text: 'éšç€ Web åº”ç”¨çš„æ™®åŠï¼Œå‰ç«¯æ‰“å°éœ€æ±‚æ—¥ç›Šå¢é•¿ã€‚æœ¬æŠ¥å‘Šå¯¹ä¸»æµå‰ç«¯æ‰“å°æ–¹æ¡ˆè¿›è¡Œå…¨é¢è°ƒç ”å’Œå¯¹æ¯”åˆ†æã€‚',
          margin: [0, 0, 0, 10],
        },

        { text: 'äºŒã€æ–¹æ¡ˆå¯¹æ¯”', style: 'sectionHeader' },
        {
          columns: [
            {
              width: '50%',
              stack: [
                { text: 'è½»é‡çº§æ–¹æ¡ˆ', style: 'columnHeader' },
                { ul: ['window.print()', 'Print.js', 'vue3-print-nb'] },
              ],
            },
            {
              width: '50%',
              stack: [
                { text: 'PDF ç”Ÿæˆæ–¹æ¡ˆ', style: 'columnHeader' },
                { ul: ['jsPDF', 'pdfmake', 'pdf-lib'] },
              ],
            },
          ],
          columnGap: 20,
          margin: [0, 0, 0, 15],
        },

        { text: 'ä¸‰ã€æ€§èƒ½æ•°æ®', style: 'sectionHeader', pageBreak: 'before' },
        {
          table: {
            headerRows: 1,
            widths: ['*', 80, 80, 80],
            body: [
              ['æ–¹æ¡ˆ', 'åˆå§‹åŒ–', 'æ¸²æŸ“', 'æ€»æ—¶é—´'],
              ['window.print()', '0ms', '45ms', '45ms'],
              ['Print.js', '35ms', '68ms', '103ms'],
              ['jsPDF', '125ms', '234ms', '359ms'],
            ],
          },
        },

        { text: 'å››ã€ç»“è®º', style: 'sectionHeader', margin: [0, 20, 0, 10] },
        {
          text: 'æ ¹æ®é¡¹ç›®éœ€æ±‚é€‰æ‹©åˆé€‚çš„æ‰“å°æ–¹æ¡ˆï¼Œå¹³è¡¡æ€§èƒ½ã€åŠŸèƒ½å’Œæ˜“ç”¨æ€§ã€‚',
        },
      ],
      styles: {
        title: {
          fontSize: 28,
          bold: true,
          alignment: 'center',
          margin: [0, 0, 0, 10],
        },
        subtitle: {
          fontSize: 18,
          alignment: 'center',
          margin: [0, 0, 0, 5],
        },
        date: {
          fontSize: 10,
          alignment: 'center',
          color: '#718096',
          margin: [0, 0, 0, 30],
        },
        sectionHeader: {
          fontSize: 16,
          bold: true,
          margin: [0, 15, 0, 10],
          color: '#667eea',
        },
        columnHeader: {
          fontSize: 13,
          bold: true,
          margin: [0, 0, 0, 5],
        },
        ...chineseStyles.styles,
      },
    }

    pdfMake.createPdf(docDefinition).getBlob((blob: Blob) => openBlobInPrintWindow(blob))

    statusMessage.value = 'âœ… å¤æ‚ PDF ç”ŸæˆæˆåŠŸï¼'
    setTimeout(() => {
      statusMessage.value = ''
    }, 3000)
  } catch (error) {
    console.error('å¤æ‚ PDF ç”Ÿæˆå¤±è´¥:', error)
    statusMessage.value = 'âŒ å¤æ‚ PDF ç”Ÿæˆå¤±è´¥'
  } finally {
    loading.value = false
  }
}

const generateReportPDF = async () => {
  if (!fontsReady.value) {
    await configurePdfMakeChinese()
    fontsReady.value = true
  }

  loading.value = true
  statusMessage.value = 'æ­£åœ¨ç”Ÿæˆå®Œæ•´æŠ¥å‘Š...'

  try {
    const chineseStyles = getChinesePdfMakeStyles()

    const docDefinition: any = {
      pageSize: 'A4',
      pageOrientation: 'portrait',
      pageMargins: [40, 80, 40, 60],
      header: (currentPage: number) => {
        return {
          columns: [
            { text: 'å‰ç«¯æ‰“å°æŠ€æœ¯è°ƒç ”æŠ¥å‘Š', fontSize: 10, margin: [40, 30, 0, 0] },
            {
              text: new Date().toLocaleDateString(),
              fontSize: 10,
              alignment: 'right',
              margin: [0, 30, 40, 0],
            },
          ],
          margin: [0, 20, 0, 20],
        }
      },
      footer: (currentPage: number, pageCount: number) => {
        return {
          columns: [
            { text: 'Confidential', fontSize: 8, margin: [40, 0, 0, 0], color: '#a0aec0' },
            {
              text: `ç¬¬ ${currentPage} é¡µ / å…± ${pageCount} é¡µ`,
              alignment: 'right',
              fontSize: 8,
              margin: [0, 0, 40, 0],
              color: '#a0aec0',
            },
          ],
        }
      },
      background: (currentPage: number) => {
        return {
          canvas: [
            {
              type: 'rect',
              x: 0,
              y: 0,
              w: 595.28,
              h: 60,
              color: '#667eea',
            },
          ],
        }
      },
      content: [
        { text: 'å‰ç«¯æ‰“å°æŠ€æœ¯', style: 'title', color: 'white', margin: [0, -60, 0, 10] },
        { text: 'å…¨é¢è°ƒç ”æŠ¥å‘Š', style: 'subtitle', color: 'white', margin: [0, 0, 0, 40] },

        { text: 'ç›®å½•', style: 'tocHeader' },
        {
          toc: {
            title: { text: '', style: 'tocTitle' },
          },
          ul: ['ç¬¬ä¸€ç« ï¼šæ¦‚è¿°', 'ç¬¬äºŒç« ï¼šæ–¹æ¡ˆå¯¹æ¯”', 'ç¬¬ä¸‰ç« ï¼šæ€§èƒ½åˆ†æ', 'ç¬¬å››ç« ï¼šé€‰å‹å»ºè®®'],
          margin: [0, 0, 0, 30],
        },

        { text: 'ç¬¬ä¸€ç« ï¼šæ¦‚è¿°', style: 'chapter', tocItem: true, pageBreak: 'before' },
        {
          text: 'æœ¬æŠ¥å‘Šæ—¨åœ¨å…¨é¢è°ƒç ”å’Œå¯¹æ¯”å½“å‰ä¸»æµçš„å‰ç«¯æ‰“å°æŠ€æœ¯æ–¹æ¡ˆï¼Œä¸ºé¡¹ç›®é€‰å‹æä¾›ç§‘å­¦ä¾æ®ã€‚',
          margin: [0, 0, 0, 20],
        },

        { text: 'ç¬¬äºŒç« ï¼šæ–¹æ¡ˆå¯¹æ¯”', style: 'chapter', tocItem: true, pageBreak: 'before' },
        {
          table: {
            headerRows: 1,
            widths: [120, '*', 80, 80],
            body: [
              [
                { text: 'æ–¹æ¡ˆåç§°', style: 'tableHeader' },
                { text: 'æ ¸å¿ƒç‰¹ç‚¹', style: 'tableHeader' },
                { text: 'æ–‡ä»¶å¤§å°', style: 'tableHeader' },
                { text: 'è¯„åˆ†', style: 'tableHeader' },
              ],
              ['window.print()', 'æµè§ˆå™¨åŸç”Ÿï¼Œé›¶ä¾èµ–', '0 KB', 'â˜…â˜…â˜…â˜…â˜…'],
              ['Print.js', 'è½»é‡çº§ï¼Œæ˜“ç”¨', '10 KB', 'â˜…â˜…â˜…â˜…'],
              ['jsPDF', 'å¼ºå¤§ï¼ŒçŸ¢é‡å›¾å½¢', '150 KB', 'â˜…â˜…â˜…â˜…'],
              ['pdfmake', 'å£°æ˜å¼ï¼ŒåŠŸèƒ½å®Œæ•´', '600 KB', 'â˜…â˜…â˜…â˜…â˜…'],
            ],
          },
          layout: {
            fillColor: (rowIndex: number) => {
              return rowIndex === 0 ? '#667eea' : rowIndex % 2 === 0 ? '#f7fafc' : null
            },
          },
        },

        { text: 'ç¬¬ä¸‰ç« ï¼šæ€§èƒ½åˆ†æ', style: 'chapter', tocItem: true, pageBreak: 'before' },
        { text: '3.1 æµ‹è¯•æ–¹æ³•', style: 'section' },
        {
          text: 'é‡‡ç”¨ç»Ÿä¸€çš„æµ‹è¯•ç¯å¢ƒå’Œæ•°æ®é›†ï¼Œå¯¹å„æ–¹æ¡ˆè¿›è¡ŒåŸºå‡†æµ‹è¯•ã€‚',
          margin: [0, 0, 0, 15],
        },
        { text: '3.2 æµ‹è¯•ç»“æœ', style: 'section' },
        {
          ul: [
            'window.print() æ€§èƒ½æœ€ä¼˜ï¼Œé€‚åˆç®€å•åœºæ™¯',
            'Print.js æ€§èƒ½è‰¯å¥½ï¼Œä½“ç§¯å°',
            'jsPDF å’Œ pdfmake åŠŸèƒ½å¼ºå¤§ï¼Œæ€§èƒ½å¯æ¥å—',
          ],
        },

        { text: 'ç¬¬å››ç« ï¼šé€‰å‹å»ºè®®', style: 'chapter', tocItem: true, pageBreak: 'before' },
        {
          text: 'æ ¹æ®ä¸åŒåœºæ™¯é€‰æ‹©åˆé€‚çš„æ–¹æ¡ˆï¼š',
          margin: [0, 0, 0, 10],
        },
        {
          ol: [
            { text: 'ç®€å•æ–‡æ¡£æ‰“å°ï¼šwindow.print() + CSS', bold: true },
            { text: 'ä¸­ç­‰å¤æ‚åº¦ï¼šPrint.js æˆ– jsPDF', bold: true },
            { text: 'å¤æ‚æ–‡æ¡£ç”Ÿæˆï¼špdfmake', bold: true },
            { text: 'æ‰€è§å³æ‰€å¾—ï¼šhtml2canvas + jsPDF', bold: true },
          ],
        },
      ],
      styles: {
        title: {
          fontSize: 32,
          bold: true,
          alignment: 'center',
        },
        subtitle: {
          fontSize: 18,
          alignment: 'center',
        },
        tocHeader: {
          fontSize: 20,
          bold: true,
          margin: [0, 0, 0, 15],
        },
        chapter: {
          fontSize: 20,
          bold: true,
          margin: [0, 0, 0, 15],
          color: '#667eea',
        },
        section: {
          fontSize: 14,
          bold: true,
          margin: [0, 10, 0, 8],
        },
        ...chineseStyles.styles,
      },
    }

    pdfMake.createPdf(docDefinition).getBlob((blob: Blob) => openBlobInPrintWindow(blob))

    statusMessage.value = 'âœ… å®Œæ•´æŠ¥å‘Šç”ŸæˆæˆåŠŸï¼'
    setTimeout(() => {
      statusMessage.value = ''
    }, 3000)
  } catch (error) {
    console.error('æŠ¥å‘Šç”Ÿæˆå¤±è´¥:', error)
    statusMessage.value = 'âŒ æŠ¥å‘Šç”Ÿæˆå¤±è´¥'
  } finally {
    loading.value = false
  }
}
</script>

<style scoped>
.demo-page {
  max-width: 1600px;
  margin: 0 auto;
  padding: 2rem;
}

.page-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 2rem;
  padding-bottom: 1rem;
  border-bottom: 2px solid #e2e8f0;
}

.page-header h1 {
  color: #2d3748;
}

.back-link {
  color: #667eea;
  text-decoration: none;
  font-weight: 500;
}

.back-link:hover {
  text-decoration: underline;
}

.content-grid {
  display: grid;
  grid-template-columns: 350px 1fr;
  gap: 2rem;
}

.info-panel {
  background: white;
  border: 1px solid #e2e8f0;
  border-radius: 8px;
  padding: 1.5rem;
  height: fit-content;
  position: sticky;
  top: 2rem;
}

.info-panel h2 {
  color: #667eea;
  margin-bottom: 1.5rem;
}

.info-section {
  margin-bottom: 1.5rem;
  padding-bottom: 1.5rem;
  border-bottom: 1px solid #e2e8f0;
}

.info-section:last-child {
  border-bottom: none;
  margin-bottom: 0;
  padding-bottom: 0;
}

.info-section h3 {
  color: #2d3748;
  font-size: 1rem;
  margin-bottom: 0.75rem;
}

.info-section ul {
  list-style: none;
  padding: 0;
}

.info-section li {
  padding: 0.25rem 0;
  font-size: 0.9rem;
}

.info-section p {
  margin: 0.5rem 0;
  font-size: 0.9rem;
}

.rating {
  color: #667eea;
  font-weight: 600;
}

.highlight {
  font-size: 1.5rem;
  font-weight: 700;
  color: #ed8936;
}

.demo-panel {
  background: white;
  border: 1px solid #e2e8f0;
  border-radius: 8px;
  padding: 1.5rem;
}

.controls {
  display: flex;
  gap: 1rem;
  margin-bottom: 2rem;
  flex-wrap: wrap;
}

.btn {
  padding: 0.75rem 1.5rem;
  border: none;
  border-radius: 6px;
  font-size: 1rem;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.3s ease;
}

.btn-primary {
  background: #667eea;
  color: white;
}

.btn-primary:hover {
  background: #5568d3;
}

.btn:disabled {
  opacity: 0.6;
  cursor: not-allowed;
}

.status-message {
  padding: 1rem;
  margin-bottom: 1.5rem;
  border-radius: 6px;
  background: #e6f4ea;
  color: #1e7e34;
  font-weight: 500;
  text-align: center;
}

.status-message.error {
  background: #fce8e6;
  color: #c5221f;
}

.loading-fonts {
  color: #ed8936;
  font-weight: 500;
  margin-top: 0.5rem;
}

.fonts-ready {
  color: #48bb78;
  font-weight: 500;
  margin-top: 0.5rem;
}

.btn-secondary {
  background: #48bb78;
  color: white;
}

.btn-secondary:hover {
  background: #38a169;
}

.btn-info {
  background: #4299e1;
  color: white;
}

.btn-info:hover {
  background: #3182ce;
}

.btn-warning {
  background: #ed8936;
  color: white;
}

.btn-warning:hover {
  background: #dd6b20;
}

.preview-hint {
  background: #edf2f7;
  border-left: 4px solid #667eea;
  padding: 1rem 1.5rem;
  margin-bottom: 2rem;
  border-radius: 4px;
}

.preview-hint p {
  margin: 0;
  color: #4a5568;
}

.code-examples {
  background: #f7fafc;
  border: 1px solid #e2e8f0;
  border-radius: 8px;
  padding: 1.5rem;
}

.code-examples h3 {
  color: #2d3748;
  margin-bottom: 1rem;
}

.code-block {
  margin-bottom: 1.5rem;
}

.code-block h4 {
  color: #4a5568;
  margin-bottom: 0.5rem;
}

.code-block pre {
  background: #2d3748;
  color: #e2e8f0;
  padding: 1rem;
  border-radius: 4px;
  overflow-x: auto;
  margin: 0;
}

.code-block code {
  font-family: 'Courier New', monospace;
  font-size: 0.9rem;
  line-height: 1.6;
}

/* ç¤ºä¾‹å±•ç¤ºåŒºåŸŸæ ·å¼ */
.examples-section {
  background: white;
  border: 1px solid #e2e8f0;
  border-radius: 8px;
  padding: 2rem;
  margin-bottom: 2rem;
}

.section-title {
  color: #667eea;
  margin-bottom: 1.5rem;
  padding-bottom: 0.5rem;
  border-bottom: 2px solid #667eea;
}

.example-tabs {
  display: flex;
  flex-wrap: wrap;
  gap: 0.5rem;
  margin-bottom: 1.5rem;
}

.tab-button {
  padding: 0.5rem 1rem;
  border: 1px solid #e2e8f0;
  border-radius: 6px;
  background: white;
  cursor: pointer;
  transition: all 0.2s;
  font-size: 0.9rem;
}

.tab-button:hover {
  background: #f7fafc;
  border-color: #667eea;
}

.tab-button.active {
  background: #667eea;
  color: white;
  border-color: #667eea;
}

.example-content {
  background: #f7fafc;
  border-radius: 8px;
  padding: 1.5rem;
}

.example-content h3 {
  color: #2d3748;
  margin-bottom: 0.75rem;
}

.example-content p {
  color: #4a5568;
  margin-bottom: 1rem;
}

.code-display {
  background: white;
  border: 1px solid #e2e8f0;
  border-radius: 6px;
  padding: 1rem;
  margin: 1rem 0;
}

.code-display h4 {
  color: #4a5568;
  margin-bottom: 0.5rem;
  font-size: 0.9rem;
}

.code-display pre {
  background: #2d3748;
  color: #e2e8f0;
  padding: 1rem;
  border-radius: 4px;
  overflow-x: auto;
  margin: 0;
  font-size: 0.85rem;
  line-height: 1.5;
}

.demo-content {
  margin-top: 1rem;
}

.demo-content h4 {
  color: #4a5568;
  margin-bottom: 0.5rem;
  font-size: 0.9rem;
}

.preview-box {
  background: white;
  border: 1px solid #e2e8f0;
  border-radius: 6px;
  padding: 1.5rem;
}

.preview-box p {
  margin: 0.5rem 0;
}

.preview-box .note {
  color: #718096;
  font-size: 0.9rem;
  font-style: italic;
  margin-top: 1rem;
}

.divider {
  height: 1px;
  background: linear-gradient(to right, transparent, #e2e8f0, transparent);
  margin: 2rem 0;
}

/* é«˜çº§åŠŸèƒ½åŒºåŸŸæ ·å¼ */
.advanced-section {
  background: white;
  border: 1px solid #e2e8f0;
  border-radius: 8px;
  padding: 2rem;
  margin-bottom: 2rem;
}

.data-table {
  width: 100%;
  border-collapse: collapse;
  margin-top: 1rem;
}

.data-table th,
.data-table td {
  border: 1px solid #e2e8f0;
  padding: 0.75rem;
  text-align: center;
}

.data-table th {
  background: #667eea;
  color: white;
  font-weight: 600;
}

.data-table tr:nth-child(even) {
  background: #f7fafc;
}
</style>
